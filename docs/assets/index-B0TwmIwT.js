(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();class Ys{constructor(e,n=2048){this.isAnalyzing=!1,this.loudnessHistory=[],this.startTime=0,this.animationFrameId=null,this.analyzerNode=e.createAnalyser(),this.analyzerNode.fftSize=n,this.analyzerNode.smoothingTimeConstant=.3,this.dataArray=new Uint8Array(this.analyzerNode.frequencyBinCount)}getAnalyzerNode(){return this.analyzerNode}start(){this.isAnalyzing=!0,this.startTime=Date.now(),this.loudnessHistory=[],this.analyze()}stop(){this.isAnalyzing=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}reset(){this.stop(),this.loudnessHistory=[]}analyze(){if(!this.isAnalyzing)return;this.analyzerNode.getByteFrequencyData(this.dataArray);let e=0;for(let i=0;i<this.dataArray.length;i++){const s=this.dataArray[i]/255;e+=s*s}const n=Math.sqrt(e/this.dataArray.length),r=Date.now()-this.startTime;this.loudnessHistory.push({timestamp:r,loudness:n}),this.animationFrameId=requestAnimationFrame(()=>this.analyze())}getLoudnessHistory(){return[...this.loudnessHistory]}getCurrentLoudness(){return this.loudnessHistory.length===0?0:this.loudnessHistory[this.loudnessHistory.length-1].loudness}static calculateLoudnessFromBuffer(e,n=1024){const r=e.getChannelData(0),i=e.sampleRate,s=n/2,o=[];for(let a=0;a<r.length-n;a+=s){let u=0;for(let l=0;l<n;l++){const f=r[a+l];u+=f*f}const c=Math.sqrt(u/n),d=a/i*1e3;o.push({timestamp:d,loudness:c})}return o}}class Xs{constructor(e,n){this._value=n?.initial||!1,document.getElementById(e)?.addEventListener("click",this.changeValue.bind(this))}value(){return this._value}changeValue(e){this._value=e.target.checked}}function Xr(t,e){const n=new Xs(t,e);return n.value.bind(n)}class Js{constructor(e,n){this._value=0,this.valueInput=null,this.minusButton=null,this.plusButton=null,this.minValue=0,this.maxValue=0,this._value=n.initial,this.minValue=n.min,this.maxValue=n.max,this.valueInput=document.getElementById(`${e}-val`),this.minusButton=document.getElementById(`${e}-minus`),this.plusButton=document.getElementById(`${e}-plus`),this.valueInput?.addEventListener("change",this.setVal.bind(this)),this.minusButton?.addEventListener("click",this.minusVal.bind(this)),this.plusButton?.addEventListener("click",this.plusVal.bind(this)),this.valueInput?.addEventListener("keydown",r=>{r.key==="ArrowUp"?(r.preventDefault(),this.plusVal()):r.key==="ArrowDown"&&(r.preventDefault(),this.minusVal())}),this.updateValueInputs()}value(){return this._value}setVal(e){const n=this.parseValue(e.target);this._value=n!==null?n:this._value,this.updateValueInputs()}minusVal(){this._value--,this.updateValueInputs()}plusVal(){this._value++,this.updateValueInputs()}updateValueInputs(){this._value=Math.max(this.minValue,Math.min(this.maxValue,this._value)),this.valueInput&&(this.valueInput.value=this._value.toString())}parseValue(e){if(!(e instanceof HTMLInputElement))return console.error("Invalid target for input."),null;const n=parseInt(e.value.trim(),10);return isNaN(n)?(console.error("Value must be a valid integer."),null):n}}function Ot(t,e){const n=new Js(t,e);return n.value.bind(n)}class Zs{constructor(e,n){this._value=0,this.min=0,this.max=10,this.step=.5,this.slideInput=null,this.minusButton=null,this.plusButton=null,this._value=n.initial,this.min=n.min,this.max=n.max,this.step=n.step,this.slideInput=document.getElementById(e),this.minusButton=document.getElementById(`${e}-minus`),this.plusButton=document.getElementById(`${e}-plus`),this.slideInput?.addEventListener("change",this.setVal.bind(this)),this.minusButton?.addEventListener("click",this.minusVal.bind(this)),this.plusButton?.addEventListener("click",this.plusVal.bind(this)),this.updateSlideInput()}value(){return this._value}setVal(e){const n=this.parseValue(e.target);this._value=n!==null?n:this._value,this.updateSlideInput()}minusVal(){this._value-=this.step,this.updateSlideInput()}plusVal(){this._value+=this.step,this.updateSlideInput()}updateSlideInput(){this._value=Math.max(this.min,Math.min(this.max,this._value)),this.slideInput&&(this.slideInput.value=this._value.toString())}parseValue(e){if(!(e instanceof HTMLInputElement))return console.error("Invalid target for input."),null;const n=parseFloat(e.value.trim());return isNaN(n)?(console.error("Value must be a valid float."),null):n}}function Qs(t,e){const n=new Zs(t,e);return n.value.bind(n)}class ar{constructor(e,n){this.clickHz=1e3,this.offbeatHz=750,this.oscillatorType="square",this.nextClickTime=0,this.nextClickSubdivision=0,this.isPlaying=!1,this.tempo=60,this.countOffTempo=60,this._subdivisions=1,this._countOffs=1,this._countOffSubs=1,this.scheduleLookahead=25,this.scheduleInterval=25,this.countOffAllowance=100,this.countOff=Ot("rec-count-off",{initial:0,min:0,max:8}),this.countOffSub=Ot("rec-count-off-sub",{initial:1,min:1,max:32}),this.latency=Ot("play-latency",{initial:-75,min:-500,max:500}),this.scheduler=()=>{for(;this.nextClickTime<this.audioContext.currentTime+this.scheduleLookahead/1e3;)this._countOffs>=0&&this.nextClickSubdivision%this._countOffSubs===0?(this._countOffs-=1,this.createClickSound(this.nextClickTime,this.clickHz),this.createClickSound(this.nextClickTime,this.clickHz)):this._countOffs<0&&this.nextClickSubdivision%this._subdivisions===0?(this.createClickSound(this.nextClickTime,this.clickHz),this.createClickSound(this.nextClickTime,this.clickHz)):this.createClickSound(this.nextClickTime,this.offbeatHz),this._countOffs<0?this.nextClickTime+=this.tempo:this.nextClickTime+=this.countOffTempo,this.nextClickSubdivision++;this.isPlaying&&setTimeout(this.scheduler,this.scheduleInterval)},this.enabled=Xr(`${e}-metronome-enabled`,{initial:!0}),this.bpm=Ot(`${e}-bpm`,{initial:60,min:15,max:300}),this.subdivisions=Ot(`${e}-subdivisions`,{initial:1,min:1,max:32}),this.countOffSub=Ot(`${e}-count-off-sub`,{initial:1,min:1,max:32}),this.volume=Qs(`${e}-volume`,{initial:1,min:0,max:5,step:.25}),this.audioContext=n}getPlaybackStartTime(e,n=1){const r=this.latency()/n;let i=e-r/1e3;return this.countOff()>0&&(i+=this.countOffAllowance/n/1e3),i}countOffMs(){return!this.enabled()||this.countOff()<=0?0:this.countOff()/this.bpm()*60*1e3-this.countOffAllowance}createClickSound(e,n){const r=this.volume();if(r<=0)return;const i=this.audioContext.createOscillator(),s=this.audioContext.createGain();i.type=this.oscillatorType,i.frequency.setValueAtTime(n,e),s.gain.setValueAtTime(0,e),s.gain.linearRampToValueAtTime(r,e+.001),s.gain.exponentialRampToValueAtTime(.001,e+.05),i.connect(s),s.connect(this.audioContext.destination),i.start(e),i.stop(e+.05)}start(e,n,r){const i=this.isPlaying?this.tempo:0;this.isPlaying&&this.stop(),this._countOffs=r?this.countOff():0,this._subdivisions=this.subdivisions(),this._countOffSubs=this.countOffSub(),this.tempo=60/(this.bpm()*this._subdivisions*n),this.countOffTempo=60/(this.bpm()*this.countOffSub()*n),setTimeout(()=>{this.isPlaying=!0,this.nextClickTime=e,this.nextClickSubdivision=0,this.scheduler()},i)}stop(){this.isPlaying=!1}}var A=(t=>(t.UNKNOWN="unknown",t.RECORDING="recording",t.STOPPED="stopped",t.PLAYING="playing",t))(A||{});class to{constructor(){this.recordIcon=document.getElementById("record"),this.recordingIcon=document.getElementById("recording"),this.playIcon=document.getElementById("play"),this.playingIcon=document.getElementById("playing"),this.state=A.STOPPED,this.nextState=A.RECORDING,this.showControls([this.recordIcon])}initializeEventListeners(e){this.recordIcon?.addEventListener("click",e.record.bind(this)),this.recordingIcon?.addEventListener("click",e.stopRecording.bind(this)),this.playIcon?.addEventListener("click",e.play.bind(this)),this.playingIcon?.addEventListener("click",e.stopPlaying.bind(this)),document.addEventListener("keydown",n=>{if(n.key===" ")n.preventDefault(),this.state===A.RECORDING?e.stopRecording():this.state===A.PLAYING?e.stopPlaying():this.state===A.STOPPED&&(this.nextState===A.RECORDING?e.record():this.nextState===A.PLAYING&&e.play());else if(n.key==="Enter"){const r=document.activeElement;r.role==="switch"?r.click():r.blur()}})}markRecording(){this.setState(A.RECORDING)}markPlaying(){this.setState(A.PLAYING)}markStopped(){this.setState(A.STOPPED)}setState(e){e===A.RECORDING?(this.showControls([this.recordingIcon]),this.state=A.RECORDING,this.nextState=A.STOPPED):e===A.STOPPED?(this.nextState=this.state===A.RECORDING?A.PLAYING:A.RECORDING,this.showControls([this.playIcon,this.recordIcon]),this.state=A.STOPPED):e===A.PLAYING&&(this.showControls([this.playingIcon]),this.state=A.PLAYING,this.nextState=A.STOPPED)}showControls(e){[this.recordIcon,this.recordingIcon,this.playIcon,this.playingIcon].forEach(n=>{n&&(n.style.display=e.includes(n)?"inline-block":"none")})}}class eo{constructor(e){this.sourceNode=null,this.isPlaying=!1,this.playbackRate=1,this.onEndedCallback=null,this.startTime=0,this.audioContext=e,this.gainNode=e.createGain(),this.gainNode.connect(e.destination)}play(e,n=1,r){this.stop(),this.sourceNode=this.audioContext.createBufferSource(),this.sourceNode.buffer=e,this.sourceNode.playbackRate.value=n,this.sourceNode.connect(this.gainNode),this.playbackRate=n,this.onEndedCallback=r||null,this.sourceNode.onended=()=>{this.isPlaying=!1,this.onEndedCallback&&this.onEndedCallback()};const i=this.audioContext.currentTime;return this.startTime=i,this.sourceNode.start(i),this.isPlaying=!0,i}stop(){this.sourceNode&&this.isPlaying&&(this.sourceNode.stop(),this.sourceNode.disconnect(),this.sourceNode=null,this.isPlaying=!1)}}function no(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var on,cr;function ro(){if(cr)return on;cr=1,on=t;function t(o,a){a=a||{};var u=o.numberOfChannels,c=o.sampleRate,d=a.float32?3:1,l=d===3?32:16,f;return u===2?f=n(o.getChannelData(0),o.getChannelData(1)):f=o.getChannelData(0),e(f,d,c,u,l)}function e(o,a,u,c,d){var l=d/8,f=c*l,p=new ArrayBuffer(44+o.length*l),h=new DataView(p);return s(h,0,"RIFF"),h.setUint32(4,36+o.length*l,!0),s(h,8,"WAVE"),s(h,12,"fmt "),h.setUint32(16,16,!0),h.setUint16(20,a,!0),h.setUint16(22,c,!0),h.setUint32(24,u,!0),h.setUint32(28,u*f,!0),h.setUint16(32,f,!0),h.setUint16(34,d,!0),s(h,36,"data"),h.setUint32(40,o.length*l,!0),a===1?i(h,44,o):r(h,44,o),p}function n(o,a){for(var u=o.length+a.length,c=new Float32Array(u),d=0,l=0;d<u;)c[d++]=o[l],c[d++]=a[l],l++;return c}function r(o,a,u){for(var c=0;c<u.length;c++,a+=4)o.setFloat32(a,u[c],!0)}function i(o,a,u){for(var c=0;c<u.length;c++,a+=2){var d=Math.max(-1,Math.min(1,u[c]));o.setInt16(a,d<0?d*32768:d*32767,!0)}}function s(o,a,u){for(var c=0;c<u.length;c++)o.setUint8(a+c,u.charCodeAt(c))}return on}var io=ro();const so=no(io);class oo{constructor(e){this.stream=null,this.sourceNode=null,this.recordingNode=null,this.state=A.UNKNOWN,this.recordedBuffer=null,this.recordingData=[],this.sampleRate=44100,this.maxRecordingLength=300,this.audioContext=e,this.sampleRate=e.sampleRate,document.getElementById("download").addEventListener("click",this.download.bind(this))}async initialize(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,sampleRate:this.sampleRate}}),this.sourceNode=this.audioContext.createMediaStreamSource(this.stream);try{await this.audioContext.audioWorklet.addModule(this.getRecorderWorkletCode()),this.recordingNode=new AudioWorkletNode(this.audioContext,"recorder-worklet"),this.setupWorkletRecording()}catch{console.warn("AudioWorklet not supported, falling back to ScriptProcessorNode"),this.setupScriptProcessorRecording()}this.state=A.STOPPED}catch(e){throw console.error("Error initializing Web Audio recorder:",e),e}}getRecorderWorkletCode(){const e=`
      class RecorderWorklet extends AudioWorkletProcessor {
        constructor() {
          super();
          this.isRecording = false;
          this.port.onmessage = (event) => {
            if (event.data.command === "start") {
              this.isRecording = true;
            } else if (event.data.command === "stop") {
              this.isRecording = false;
            }
          };
        }

        process(inputs, outputs) {
          if (this.isRecording && inputs[0] && inputs[0][0]) {
            // Send audio data to main thread
            this.port.postMessage({
              type: "audiodata",
              audioData: inputs[0][0].slice() // Copy the audio data
            });
          }
          return true;
        }
      }
      registerProcessor("recorder-worklet", RecorderWorklet);
    `,n=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(n)}setupWorkletRecording(){this.recordingNode&&(this.recordingNode.port.onmessage=e=>{e.data.type==="audiodata"&&(this.recordingData.push(new Float32Array(e.data.audioData)),this.recordingData.length>this.maxRecordingLength*this.sampleRate/128&&(console.warn("Maximum recording length reached"),this.stop()))})}setupScriptProcessorRecording(){const n=this.audioContext.createScriptProcessor(4096,1,1);n.onaudioprocess=r=>{if(this.state===A.RECORDING){const i=r.inputBuffer.getChannelData(0);this.recordingData.push(new Float32Array(i)),this.recordingData.length>this.maxRecordingLength*this.sampleRate/4096&&(console.warn("Maximum recording length reached"),this.stop())}},this.recordingNode=n}start(){if(this.state!==A.STOPPED){console.error("Recorder is not in a stopped state, cannot start recording");return}try{this.recordingData=[],this.sourceNode&&this.recordingNode&&(this.sourceNode.connect(this.recordingNode),this.recordingNode instanceof ScriptProcessorNode&&this.recordingNode.connect(this.audioContext.destination)),this.state=A.RECORDING,this.recordingNode instanceof AudioWorkletNode&&this.recordingNode.port.postMessage({command:"start"})}catch(e){console.error("Error starting recording:",e)}}stop(){if(this.state!==A.RECORDING){console.error("Recorder is not in a recording state, cannot stop recording");return}try{this.state=A.STOPPED,this.recordingNode instanceof AudioWorkletNode&&this.recordingNode.port.postMessage({command:"stop"}),this.sourceNode&&this.recordingNode&&(this.sourceNode.disconnect(this.recordingNode),this.recordingNode instanceof ScriptProcessorNode&&this.recordingNode.disconnect()),this.processRecordedData()}catch(e){console.error("Error stopping recording:",e)}}processRecordedData(){if(this.recordingData.length===0){console.warn("No audio data recorded");return}const e=this.recordingData.reduce((i,s)=>i+s.length,0);this.recordedBuffer=this.audioContext.createBuffer(1,e,this.sampleRate);const n=this.recordedBuffer.getChannelData(0);let r=0;for(const i of this.recordingData)n.set(i,r),r+=i.length}getAudioBuffer(){return this.recordedBuffer}download(){if(!this.recordedBuffer){console.error("No recorded buffer available for download");return}const e=so(this.recordedBuffer),n=new Blob([e],{type:"audio/wav"}),r=URL.createObjectURL(n),i=document.createElement("a");i.href=r,i.download=`recording-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.wav`,i.click(),setTimeout(()=>{URL.revokeObjectURL(r)},1e3)}reset(){if(this.state===A.RECORDING&&this.stop(),this.stream&&this.sourceNode)try{this.sourceNode=this.audioContext.createMediaStreamSource(this.stream),this.recordingNode instanceof AudioWorkletNode?(this.recordingNode=new AudioWorkletNode(this.audioContext,"recorder-worklet"),this.setupWorkletRecording()):this.setupScriptProcessorRecording(),this.state=A.STOPPED}catch(e){console.error("Error resetting recorder:",e)}}}class ao{constructor(e,n={}){this.loudnessData=[],this.metronomeSettings=null,this.playbackStartTime=0,this.playbackRate=1,this.isPlaybackActive=!1,this.animationFrameId=null,this.enabled=Xr("visualization-enabled",{initial:!0}),this.statsDiv=document.getElementById("visualization-stats"),this.canvas=e;const r=e.getContext("2d");if(!r)throw new Error("Could not get 2D context from canvas");this.ctx=r,this.options={width:n.width||800,height:n.height||200,backgroundColor:n.backgroundColor||"#f8f9fa",waveformColor:n.waveformColor||"#a55dfc",gridColor:n.gridColor||"#babcbf",showGrid:n.showGrid!==void 0?n.showGrid:!0,maxTime:n.maxTime||3e4},this.setupCanvas()}setupCanvas(){this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.canvas.style.width="100%",this.canvas.style.height="200px",this.canvas.style.border="1px solid #dee2e6",this.canvas.style.borderRadius="8px"}setLoudnessData(e){this.loudnessData=[...e],this.draw()}setMetronomeSettings(e){this.metronomeSettings=e,this.draw()}startPlayback(e=1){this.playbackStartTime=Date.now(),this.playbackRate=e,this.isPlaybackActive=!0,this.animatePlayback()}stopPlayback(){this.isPlaybackActive=!1,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.draw()}clear(){this.loudnessData=[],this.metronomeSettings=null,this.stopPlayback(),this.draw()}setStats(e){if(e===void 0)this.statsDiv.innerText="";else{let n=(e*1e3).toFixed(0);this.statsDiv.innerText=`Max Vol: ${n}`}}draw(){const{width:e,height:n,backgroundColor:r,waveformColor:i,gridColor:s,showGrid:o,maxTime:a}=this.options;if(this.ctx.fillStyle=r,this.ctx.fillRect(0,0,e,n),o&&this.drawGrid(),this.loudnessData.length===0){this.drawEmptyState();return}const u=this.loudnessData.length>0?this.loudnessData[this.loudnessData.length-1].timestamp:a;this.drawWaveform(this.loudnessData,u),this.metronomeSettings&&this.drawMetronomeBeats(u),this.isPlaybackActive&&this.drawPlaybackPosition(u)}drawGrid(){const{width:e,height:n,gridColor:r}=this.options;this.ctx.strokeStyle=r,this.ctx.lineWidth=.5;const i=n/2;this.ctx.lineWidth=1,this.ctx.beginPath(),this.ctx.moveTo(0,i),this.ctx.lineTo(e,i),this.ctx.stroke();const s=50,o=Math.max(...this.loudnessData.map(d=>d.loudness))*1e3,a=n*.4,u=s*a/o;if(u<=0)return;this.ctx.lineWidth=.5;let c=0;for(;c<n/2;)this.ctx.beginPath(),this.ctx.moveTo(0,i-c),this.ctx.lineTo(e,i-c),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(0,i+c),this.ctx.lineTo(e,i+c),this.ctx.stroke(),c+=u}drawWaveform(e,n){if(e.length<2)return;const{width:r,height:i,waveformColor:s}=this.options,o=Math.max(...e.map(d=>d.loudness));if(o===0)return;this.setStats(o);const a=i/2,u=i*.4;this.ctx.strokeStyle=s,this.ctx.lineWidth=1,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.beginPath();let c=!0;for(const d of e){const l=d.timestamp/n*r,p=d.loudness/o*u,h=a-p;c?(this.ctx.moveTo(Math.max(0,l),h),c=!1):this.ctx.lineTo(Math.max(0,l),h)}this.ctx.stroke(),this.ctx.beginPath(),c=!0;for(const d of e){const l=d.timestamp/n*r,p=d.loudness/o*u,h=a+p;c?(this.ctx.moveTo(Math.max(0,l),h),c=!1):this.ctx.lineTo(Math.max(0,l),h)}this.ctx.stroke(),this.ctx.fillStyle=s+"20",this.ctx.beginPath(),c=!0;for(const d of e){const l=d.timestamp/n*r,p=d.loudness/o*u,h=a-p;c?(this.ctx.moveTo(Math.max(0,l),h),c=!1):this.ctx.lineTo(Math.max(0,l),h)}for(let d=e.length-1;d>=0;d--){const l=e[d],f=l.timestamp/n*r,h=l.loudness/o*u,m=a+h;this.ctx.lineTo(Math.max(0,f),m)}this.ctx.closePath(),this.ctx.fill()}drawMetronomeBeats(e){if(!this.metronomeSettings)return;const{width:n,height:r}=this.options,{bpm:i,subdivisions:s}=this.metronomeSettings,a=60/i*1e3/s;let u=0;const c="#000000",d="#2905f5";this.ctx.lineWidth=1;let l=175;for(;l<=e;){const f=l/e*n;f>=0&&f<=n&&(this.ctx.strokeStyle=u%s===0?d:c,this.ctx.beginPath(),this.ctx.moveTo(f,0),this.ctx.lineTo(f,r),this.ctx.stroke()),l+=a,u+=1}}drawPlaybackPosition(e){const{width:n,height:r}=this.options,s=(Date.now()-this.playbackStartTime)*this.playbackRate;if(s>e){this.stopPlayback();return}const o=s/e*n;this.ctx.strokeStyle="#FF0000",this.ctx.lineWidth=2,this.ctx.beginPath(),this.ctx.moveTo(o,0),this.ctx.lineTo(o,r),this.ctx.stroke()}animatePlayback(){this.isPlaybackActive&&(this.draw(),this.animationFrameId=requestAnimationFrame(()=>this.animatePlayback()))}drawEmptyState(){const{width:e,height:n}=this.options;this.ctx.fillStyle="#6c757d",this.ctx.font="16px system-ui, -apple-system, sans-serif",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.setStats()}updateOptions(e){Object.assign(this.options,e),this.setupCanvas(),this.draw()}destroy(){this.stopPlayback()}}class co{constructor(e,n){this.numerator=1,this.denominator=4,this._value=this.numerator/this.denominator,this.numerValueInput=null,this.denomValueInput=null,this.minusButtom=null,this.plusButton=null,this.numerator=n.initNum,this.denominator=n.initDen,this.numerValueInput=document.getElementById(`${e}-numer`),this.denomValueInput=document.getElementById(`${e}-denom`),this.minusButtom=document.getElementById(`${e}-minus`),this.plusButton=document.getElementById(`${e}-plus`),this.numerValueInput?.addEventListener("change",this.setNumerator.bind(this)),this.denomValueInput?.addEventListener("change",this.setDenominator.bind(this)),this.minusButtom?.addEventListener("click",this.minus.bind(this)),this.plusButton?.addEventListener("click",this.plus.bind(this)),n.arrowKeys&&document.addEventListener("keydown",r=>{const i=document.activeElement;(i.tagName!=="INPUT"||i.role==="switch")&&(r.key==="ArrowRight"?(r.preventDefault(),this.plus()):r.key==="ArrowLeft"&&(r.preventDefault(),this.minus()))}),this.updateValueInput()}value(){return this._value}updateValueInput(){this.numerValueInput&&(this.numerValueInput.value=this.numerator.toString()),this.denomValueInput&&(this.denomValueInput.value=this.denominator.toString()),this._value=this.numerator/this.denominator}setNumerator(e){this.numerator=this.parseValue(e.target)||this.numerator,this.updateValueInput()}setDenominator(e){this.denominator=this.parseValue(e.target)||this.denominator,this.updateValueInput()}parseValue(e){if(!(e instanceof HTMLInputElement))return 0;const n=parseInt(e.value.trim(),10);return isNaN(n)||n<=0?0:n}minus(){this.numerator===1?this.denominator++:this.numerator--,this.updateValueInput()}plus(){this.denominator===1?this.numerator++:this.denominator--,this.updateValueInput()}}function uo(t,e){const n=new co(t,e);return n.value.bind(n)}const Fe={log:"log",debug:"debug",info:"info",warn:"warn",error:"error"},ot=console,Dt={};Object.keys(Fe).forEach(t=>{Dt[t]=ot[t]});const Zt="Datadog Browser SDK:",w={debug:Dt.debug.bind(ot,Zt),log:Dt.log.bind(ot,Zt),info:Dt.info.bind(ot,Zt),warn:Dt.warn.bind(ot,Zt),error:Dt.error.bind(ot,Zt)},Be="https://docs.datadoghq.com",lo=`${Be}/real_user_monitoring/browser/troubleshooting`,Vn="More details:";function Jr(t,e){return(...n)=>{try{return t(...n)}catch(r){w.error(e,r)}}}function ct(t){return t!==0&&Math.random()*100<=t}function ie(t,e){return+t.toFixed(e)}function fo(t){return he(t)&&t>=0&&t<=100}function he(t){return typeof t=="number"}const z=1e3,j=60*z,Zr=60*j,ho=24*Zr,Qr=365*ho;function ze(t){return{relative:t,timeStamp:mo(t)}}function po(t){return{relative:Fn(t),timeStamp:t}}function mo(t){const e=tt()-performance.now();return e>pe()?Math.round(Kt(e,t)):_o(t)}function go(){return Math.round(tt()-Kt(pe(),performance.now()))}function v(t){return he(t)?ie(t*1e6,0):t}function tt(){return new Date().getTime()}function V(){return tt()}function Y(){return performance.now()}function F(){return{relative:Y(),timeStamp:V()}}function ti(){return{relative:0,timeStamp:pe()}}function N(t,e){return e-t}function Kt(t,e){return t+e}function Fn(t){return t-pe()}function _o(t){return Math.round(Kt(pe(),t))}function bo(t){return t<Qr}let an;function pe(){return an===void 0&&(an=performance.timing.navigationStart),an}const ce=1024,ei=1024*ce,yo=/[^\u0000-\u007F]/;function ni(t){return yo.test(t)?window.TextEncoder!==void 0?new TextEncoder().encode(t).length:new Blob([t]).size:t.length}function vo(t){const e=t.reduce((i,s)=>i+s.length,0),n=new Uint8Array(e);let r=0;for(const i of t)n.set(i,r),r+=i.length;return n}function ue(t){return{...t}}function Pe(t,e){return Object.keys(t).some(n=>t[n]===e)}function At(t){return Object.keys(t).length===0}function ri(t,e){const n={};for(const r of Object.keys(t))n[r]=e(t[r]);return n}function et(){if(typeof globalThis=="object")return globalThis;Object.defineProperty(Object.prototype,"_dd_temp_",{get(){return this},configurable:!0});let t=_dd_temp_;return delete Object.prototype._dd_temp_,typeof t!="object"&&(typeof self=="object"?t=self:typeof window=="object"?t=window:t={}),t}function pt(t,e){const n=et();let r;return n.Zone&&typeof n.Zone.__symbol__=="function"&&(r=t[n.Zone.__symbol__(e)]),r||(r=t[e]),r}let xn,ii=!1;function Eo(t){xn=t}function So(t){ii=t}function y(t){return function(){return Tt(t,this,arguments)}}function Tt(t,e,n){try{return t.apply(e,n)}catch(r){$t(r)}}function $t(t){if(kn(t),xn)try{xn(t)}catch(e){kn(e)}}function kn(...t){ii&&w.error("[MONITOR]",...t)}function B(t,e){return pt(et(),"setTimeout")(y(t),e)}function Q(t){pt(et(),"clearTimeout")(t)}function jt(t,e){return pt(et(),"setInterval")(y(t),e)}function $e(t){pt(et(),"clearInterval")(t)}function ur(t){const e=window.queueMicrotask;typeof e=="function"?e(y(t)):Promise.resolve().then(y(t))}class T{constructor(e){this.onFirstSubscribe=e,this.observers=[]}subscribe(e){return this.addObserver(e),{unsubscribe:()=>this.removeObserver(e)}}notify(e){this.observers.forEach(n=>n(e))}addObserver(e){this.observers.push(e),this.observers.length===1&&this.onFirstSubscribe&&(this.onLastUnsubscribe=this.onFirstSubscribe(this)||void 0)}removeObserver(e){this.observers=this.observers.filter(n=>e!==n),!this.observers.length&&this.onLastUnsubscribe&&this.onLastUnsubscribe()}}function si(...t){return new T(e=>{const n=t.map(r=>r.subscribe(i=>e.notify(i)));return()=>n.forEach(r=>r.unsubscribe())})}class oi extends T{constructor(e){super(),this.maxBufferSize=e,this.buffer=[]}notify(e){this.buffer.push(e),this.buffer.length>this.maxBufferSize&&this.buffer.shift(),super.notify(e)}subscribe(e){let n=!1;const r={unsubscribe:()=>{n=!0,this.removeObserver(e)}};return ur(()=>{for(const i of this.buffer){if(n)return;e(i)}n||this.addObserver(e)}),r}unbuffer(){ur(()=>{this.maxBufferSize=this.buffer.length=0})}}function Ge(t,e,n){const r=n&&n.leading!==void 0?n.leading:!0,i=n&&n.trailing!==void 0?n.trailing:!0;let s=!1,o,a;return{throttled:(...u)=>{if(s){o=u;return}r?t(...u):o=u,s=!0,a=B(()=>{i&&o&&t(...o),s=!1,o=void 0},e)},cancel:()=>{Q(a),s=!1,o=void 0}}}function x(){}function $(t){return t?(parseInt(t,10)^Math.random()*16>>parseInt(t,10)/4).toString(16):`10000000-1000-4000-8000-${1e11}`.replace(/[018]/g,$)}const De=/([\w-]+)\s*=\s*([^;]+)/g;function le(t,e){for(De.lastIndex=0;;){const n=De.exec(t);if(n){if(n[1]===e)return n[2]}else break}}function wo(t){const e=new Map;for(De.lastIndex=0;;){const n=De.exec(t);if(n)e.set(n[1],n[2]);else break}return e}function ai(t,e,n=""){const r=t.charCodeAt(e-1),s=r>=55296&&r<=56319?e+1:e;return t.length<=s?t:`${t.slice(0,s)}${n}`}function To(){return ci()===0}function gp(){return ci()===1}let Ie;function ci(){return Ie??(Ie=Io())}function Io(t=window){var e;const n=t.navigator.userAgent;return t.chrome||/HeadlessChrome/.test(n)?0:((e=t.navigator.vendor)===null||e===void 0?void 0:e.indexOf("Apple"))===0||/safari/i.test(n)&&!/chrome|android/i.test(n)?1:2}function He(t,e,n=0,r){const i=new Date;i.setTime(i.getTime()+n);const s=`expires=${i.toUTCString()}`,o=r&&r.crossSite?"none":"strict",a=r&&r.domain?`;domain=${r.domain}`:"",u=r&&r.secure?";secure":"",c=r&&r.partitioned?";partitioned":"";document.cookie=`${t}=${e};${s};path=/;samesite=${o}${a}${u}${c}`}function Bn(t){return le(document.cookie,t)}let cn;function ht(t){return cn||(cn=wo(document.cookie)),cn.get(t)}function ui(t,e){He(t,"",0,e)}function Ao(t){if(document.cookie===void 0||document.cookie===null)return!1;try{const e=`dd_cookie_test_${$()}`,n="test";He(e,n,j,t);const r=Bn(e)===n;return ui(e,t),r}catch(e){return w.error(e),!1}}let un;function li(){if(un===void 0){const t=`dd_site_test_${$()}`,e="test",n=window.location.hostname.split(".");let r=n.pop();for(;n.length&&!Bn(t);)r=`${n.pop()}.${r}`,He(t,e,z,{domain:r});ui(t,{domain:r}),un=r}return un}const me="_dd_s";function Co(t,e){for(let n=t.length-1;n>=0;n-=1){const r=t[n];if(e(r,n,t))return r}}function di(t){return Object.values(t)}function zn(t){return Object.entries(t)}const Ct=4*Zr,fi=15*j,Ro=Qr,hi="0",de={COOKIE:"cookie",LOCAL_STORAGE:"local-storage"},pi=/^([a-zA-Z]+)=([a-z0-9-]+)$/,$n="&";function xo(t){return!!t&&(t.indexOf($n)!==-1||pi.test(t))}const ko="1";function vt(t,e){const n={isExpired:ko};return e.trackAnonymousUser&&(t?.anonymousId?n.anonymousId=t?.anonymousId:n.anonymousId=$()),n}function ke(t){return At(t)}function mi(t){return!ke(t)}function se(t){return t.isExpired!==void 0||!Oo(t)}function Oo(t){return(t.created===void 0||tt()-Number(t.created)<Ct)&&(t.expire===void 0||tt()<Number(t.expire))}function gi(t){t.expire=String(tt()+fi)}function _i(t){return zn(t).map(([e,n])=>e==="anonymousId"?`aid=${n}`:`${e}=${n}`).join($n)}function bi(t){const e={};return xo(t)&&t.split($n).forEach(n=>{const r=pi.exec(n);if(r!==null){const[,i,s]=r;i==="aid"?e.anonymousId=s:e[i]=s}}),e}const No="_dd",Lo="_dd_r",Mo="_dd_l",Po="rum",Do="logs";function Uo(t){if(!ht(me)){const n=ht(No),r=ht(Lo),i=ht(Mo),s={};n&&(s.id=n),i&&/^[01]$/.test(i)&&(s[Do]=i),r&&/^[012]$/.test(r)&&(s[Po]=r),mi(s)&&(gi(s),t.persistSession(s))}}function lr(t){const e=Fo(t);return Ao(e)?{type:de.COOKIE,cookieOptions:e}:void 0}function Vo(t,e){const n={isLockEnabled:To(),persistSession:r=>dr(e,t,r,fi),retrieveSession:yi,expireSession:r=>dr(e,t,vt(r,t),Ct)};return Uo(n),n}function dr(t,e,n,r){He(me,_i(n),e.trackAnonymousUser?Ro:r,t)}function yi(){const t=Bn(me);return bi(t)}function Fo(t){const e={};return e.secure=!!t.useSecureSessionCookie||!!t.usePartitionedCrossSiteSessionCookie,e.crossSite=!!t.usePartitionedCrossSiteSessionCookie,e.partitioned=!!t.usePartitionedCrossSiteSessionCookie,t.trackSessionAcrossSubdomains&&(e.domain=li()),e}const Bo="_dd_test_";function fr(){try{const t=$(),e=`${Bo}${t}`;localStorage.setItem(e,t);const n=localStorage.getItem(e);return localStorage.removeItem(e),t===n?{type:de.LOCAL_STORAGE}:void 0}catch{return}}function zo(t){return{isLockEnabled:!1,persistSession:vi,retrieveSession:$o,expireSession:e=>Go(e,t)}}function vi(t){localStorage.setItem(me,_i(t))}function $o(){const t=localStorage.getItem(me);return bi(t)}function Go(t,e){vi(vt(t,e))}function qt(t,e,n){if(typeof t!="object"||t===null)return JSON.stringify(t);const r=Ut(Object.prototype),i=Ut(Array.prototype),s=Ut(Object.getPrototypeOf(t)),o=Ut(t);try{return JSON.stringify(t,e,n)}catch{return"<error: unable to serialize object>"}finally{r(),i(),s(),o()}}function Ut(t){const e=t,n=e.toJSON;return n?(delete e.toJSON,()=>{e.toJSON=n}):x}const Ho=220*ce,Wo="$",Ko=3;function L(t,e=Ho){const n=Ut(Object.prototype),r=Ut(Array.prototype),i=[],s=new WeakMap,o=ln(t,Wo,void 0,i,s),a=JSON.stringify(o);let u=a?a.length:0;if(u>e){dn(e,"discarded",t);return}for(;i.length>0&&u<e;){const c=i.shift();let d=0;if(Array.isArray(c.source))for(let l=0;l<c.source.length;l++){const f=ln(c.source[l],c.path,l,i,s);if(f!==void 0?u+=JSON.stringify(f).length:u+=4,u+=d,d=1,u>e){dn(e,"truncated",t);break}c.target[l]=f}else for(const l in c.source)if(Object.prototype.hasOwnProperty.call(c.source,l)){const f=ln(c.source[l],c.path,l,i,s);if(f!==void 0&&(u+=JSON.stringify(f).length+d+l.length+Ko,d=1),u>e){dn(e,"truncated",t);break}c.target[l]=f}}return n(),r(),o}function ln(t,e,n,r,i){const s=Yo(t);if(!s||typeof s!="object")return jo(s);const o=On(s);if(o!=="[Object]"&&o!=="[Array]"&&o!=="[Error]")return o;const a=t;if(i.has(a))return`[Reference seen at ${i.get(a)}]`;const u=n!==void 0?`${e}.${n}`:e,c=Array.isArray(s)?[]:{};return i.set(a,u),r.push({source:s,target:c,path:u}),c}function jo(t){return typeof t=="bigint"?`[BigInt] ${t.toString()}`:typeof t=="function"?`[Function] ${t.name||"unknown"}`:typeof t=="symbol"?`[Symbol] ${t.description||t.toString()}`:t}function On(t){try{if(t instanceof Event)return qo(t);if(t instanceof RegExp)return`[RegExp] ${t.toString()}`;const n=Object.prototype.toString.call(t).match(/\[object (.*)\]/);if(n&&n[1])return`[${n[1]}]`}catch{}return"[Unserializable]"}function qo(t){return{type:t.type,isTrusted:t.isTrusted,currentTarget:t.currentTarget?On(t.currentTarget):null,target:t.target?On(t.target):null}}function Yo(t){const e=t;if(e&&typeof e.toJSON=="function")try{return e.toJSON()}catch{}return t}function dn(t,e,n){w.warn(`The data provided has been ${e} as it is over the limit of ${t} characters:`,n)}const Gt="?";function ge(t){var e,n;const r=[];let i=fn(t,"stack");const s=String(t);if(i&&i.startsWith(s)&&(i=i.slice(s.length)),i&&i.split(`
`).forEach(o=>{const a=Zo(o)||ta(o)||na(o)||sa(o);a&&(!a.func&&a.line&&(a.func=Gt),r.push(a))}),r.length>0&&ua()&&t instanceof Error){const o=[];let a=t;for(;(a=Object.getPrototypeOf(a))&&Si(a);){const u=((e=a.constructor)===null||e===void 0?void 0:e.name)||Gt;o.push(u)}for(let u=o.length-1;u>=0&&((n=r[0])===null||n===void 0?void 0:n.func)===o[u];u--)r.shift()}return{message:fn(t,"message"),name:fn(t,"name"),stack:r}}const Ei="((?:file|https?|blob|chrome-extension|electron|native|eval|webpack|snippet|<anonymous>|\\w+\\.|\\/).*?)",Ht="(?::(\\d+))",Xo=new RegExp(`^\\s*at (.*?) ?\\(${Ei}${Ht}?${Ht}?\\)?\\s*$`,"i"),Jo=new RegExp(`\\((\\S*)${Ht}${Ht}\\)`);function Zo(t){const e=Xo.exec(t);if(!e)return;const n=e[2]&&e[2].indexOf("native")===0,r=e[2]&&e[2].indexOf("eval")===0,i=Jo.exec(e[2]);return r&&i&&(e[2]=i[1],e[3]=i[2],e[4]=i[3]),{args:n?[e[2]]:[],column:e[4]?+e[4]:void 0,func:e[1]||Gt,line:e[3]?+e[3]:void 0,url:n?void 0:e[2]}}const Qo=new RegExp(`^\\s*at ?${Ei}${Ht}?${Ht}??\\s*$`,"i");function ta(t){const e=Qo.exec(t);if(e)return{args:[],column:e[3]?+e[3]:void 0,func:Gt,line:e[2]?+e[2]:void 0,url:e[1]}}const ea=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;function na(t){const e=ea.exec(t);if(e)return{args:[],column:e[4]?+e[4]:void 0,func:e[1]||Gt,line:+e[3],url:e[2]}}const ra=/^\s*(.*?)(?:\((.*?)\))?(?:(?:(?:^|@)((?:file|https?|blob|chrome|webpack|resource|capacitor|\[native).*?|[^@]*bundle|\[wasm code\])(?::(\d+))?(?::(\d+))?)|@)\s*$/i,ia=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;function sa(t){const e=ra.exec(t);if(!e)return;const n=e[3]&&e[3].indexOf(" > eval")>-1,r=ia.exec(e[3]);return n&&r&&(e[3]=r[1],e[4]=r[2],e[5]=void 0),{args:e[2]?e[2].split(","):[],column:e[5]?+e[5]:void 0,func:e[1]||Gt,line:e[4]?+e[4]:void 0,url:e[3]}}function fn(t,e){if(typeof t!="object"||!t||!(e in t))return;const n=t[e];return typeof n=="string"?n:void 0}function oa(t,e,n,r){if(e===void 0)return;const{name:i,message:s}=ca(t);return{name:i,message:s,stack:[{url:e,column:r,line:n}]}}const aa=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?([\s\S]*)$/;function ca(t){let e,n;return{}.toString.call(t)==="[object String]"&&([,e,n]=aa.exec(t)),{name:e,message:n}}function Si(t){return String(t.constructor).startsWith("class ")}let Ae;function ua(){if(Ae!==void 0)return Ae;class t extends Error{constructor(){super(),this.name="Error"}}const[e,n]=[t,Error].map(r=>new r);return Ae=Si(Object.getPrototypeOf(e))&&n.stack!==e.stack,Ae}function Ue(t){const n=new Error(t);n.name="HandlingStack";let r;return Tt(()=>{const i=ge(n);i.stack=i.stack.slice(2),r=_e(i)}),r}function _e(t){let e=wi(t);return t.stack.forEach(n=>{const r=n.func==="?"?"<anonymous>":n.func,i=n.args&&n.args.length>0?`(${n.args.join(", ")})`:"",s=n.line?`:${n.line}`:"",o=n.line&&n.column?`:${n.column}`:"";e+=`
  at ${r}${i} @ ${n.url}${s}${o}`}),e}function wi(t){return`${t.name||"Error"}: ${t.message}`}const Ti="No stack, consider using an instance of Error";function Gn({stackTrace:t,originalError:e,handlingStack:n,componentStack:r,startClocks:i,nonErrorPrefix:s,useFallbackStack:o=!0,source:a,handling:u}){const c=Rt(e);return!t&&c&&(t=ge(e)),{startClocks:i,source:a,handling:u,handlingStack:n,componentStack:r,originalError:e,type:t?t.name:void 0,message:la(t,c,s,e),stack:t?_e(t):o?Ti:void 0,causes:c?ha(e,a):void 0,fingerprint:da(e),context:fa(e)}}function la(t,e,n,r){return t?.message&&t?.name?t.message:e?"Empty message":`${n} ${qt(L(r))}`}function da(t){return Rt(t)&&"dd_fingerprint"in t?String(t.dd_fingerprint):void 0}function fa(t){if(t!==null&&typeof t=="object"&&"dd_context"in t)return t.dd_context}function Rt(t){return t instanceof Error||Object.prototype.toString.call(t)==="[object Error]"}function ha(t,e){let n=t;const r=[];for(;Rt(n?.cause)&&r.length<10;){const i=ge(n.cause);r.push({message:n.cause.message,source:e,type:i?.name,stack:i&&_e(i)}),n=n.cause}return r.length?r:void 0}var It;(function(t){t.TRACK_INTAKE_REQUESTS="track_intake_requests",t.WRITABLE_RESOURCE_GRAPHQL="writable_resource_graphql",t.EARLY_REQUEST_COLLECTION="early_request_collection",t.WATCH_COOKIE_WITHOUT_LOCK="watch_cookie_without_lock",t.USE_TREE_WALKER_FOR_ACTION_NAME="use_tree_walker_for_action_name"})(It||(It={}));const Hn=new Set;function pa(t){Array.isArray(t)&&ma(t.filter(e=>Pe(It,e)))}function ma(t){t.forEach(e=>{Hn.add(e)})}function We(t){return Hn.has(t)}function ga(){return Hn}const Ii="datad0g.com",_a="dd0g-gov.com",wt="datadoghq.com",ba="datadoghq.eu",ya="ddog-gov.com",va="pci.browser-intake-datadoghq.com",Ea=["ddsource","dd-api-key","dd-request-id"];function Ai(t,e){const n=window.__ddBrowserSdkExtensionCallback;n&&n({type:t,payload:e})}function xt(t){return t===null?"null":Array.isArray(t)?"array":typeof t}function Ve(t,e,n=Sa()){if(e===void 0)return t;if(typeof e!="object"||e===null)return e;if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const i=e.flags||[e.global?"g":"",e.ignoreCase?"i":"",e.multiline?"m":"",e.sticky?"y":"",e.unicode?"u":""].join("");return new RegExp(e.source,i)}if(n.hasAlreadyBeenSeen(e))return;if(Array.isArray(e)){const i=Array.isArray(t)?t:[];for(let s=0;s<e.length;++s)i[s]=Ve(i[s],e[s],n);return i}const r=xt(t)==="object"?t:{};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=Ve(r[i],e[i],n));return r}function Wn(t){return Ve(void 0,t)}function ut(...t){let e;for(const n of t)n!=null&&(e=Ve(e,n));return e}function Sa(){if(typeof WeakSet<"u"){const e=new WeakSet;return{hasAlreadyBeenSeen(n){const r=e.has(n);return r||e.add(n),r}}}const t=[];return{hasAlreadyBeenSeen(e){const n=t.indexOf(e)>=0;return n||t.push(e),n}}}function Ci(){var t;const e=window.navigator;return{status:e.onLine?"connected":"not_connected",interfaces:e.connection&&e.connection.type?[e.connection.type]:void 0,effective_type:(t=e.connection)===null||t===void 0?void 0:t.effectiveType}}function wa(t){return t>=500}function Ta(t){try{return t.clone()}catch{return}}const Yt={AGENT:"agent",CONSOLE:"console",CUSTOM:"custom",LOGGER:"logger",NETWORK:"network",SOURCE:"source",REPORT:"report"},Ia=80*ce,Aa=32,Ri=3*ei,Ca=j,xi=z;function ki(t,e,n,r,i,s){e.transportStatus===0&&e.queuedPayloads.size()===0&&e.bandwidthMonitor.canHandle(t)?Ni(t,e,n,s,{onSuccess:()=>Li(0,e,n,r,i,s),onFailure:()=>{e.queuedPayloads.enqueue(t)||s.notify({type:"queue-full",bandwidth:e.bandwidthMonitor.stats(),payload:t}),Oi(e,n,r,i,s)}}):e.queuedPayloads.enqueue(t)||s.notify({type:"queue-full",bandwidth:e.bandwidthMonitor.stats(),payload:t})}function Oi(t,e,n,r,i){t.transportStatus===2&&B(()=>{const s=t.queuedPayloads.first();Ni(s,t,e,i,{onSuccess:()=>{t.queuedPayloads.dequeue(),t.currentBackoffTime=xi,Li(1,t,e,n,r,i)},onFailure:()=>{t.currentBackoffTime=Math.min(Ca,t.currentBackoffTime*2),Oi(t,e,n,r,i)}})},t.currentBackoffTime)}function Ni(t,e,n,r,{onSuccess:i,onFailure:s}){e.bandwidthMonitor.add(t),n(t,o=>{e.bandwidthMonitor.remove(t),Ra(o)?(e.transportStatus=e.bandwidthMonitor.ongoingRequestCount>0?1:2,t.retry={count:t.retry?t.retry.count+1:1,lastFailureStatus:o.status},r.notify({type:"failure",bandwidth:e.bandwidthMonitor.stats(),payload:t}),s()):(e.transportStatus=0,r.notify({type:"success",bandwidth:e.bandwidthMonitor.stats(),payload:t}),i())})}function Li(t,e,n,r,i,s){t===0&&e.queuedPayloads.isFull()&&!e.queueFullReported&&(i({message:`Reached max ${r} events size queued for upload: ${Ri/ei}MiB`,source:Yt.AGENT,startClocks:F()}),e.queueFullReported=!0);const o=e.queuedPayloads;for(e.queuedPayloads=Mi();o.size()>0;)ki(o.dequeue(),e,n,r,i,s)}function Ra(t){return t.type!=="opaque"&&(t.status===0&&!navigator.onLine||t.status===408||t.status===429||wa(t.status))}function xa(){return{transportStatus:0,currentBackoffTime:xi,bandwidthMonitor:ka(),queuedPayloads:Mi(),queueFullReported:!1}}function Mi(){const t=[];return{bytesCount:0,enqueue(e){return this.isFull()?!1:(t.push(e),this.bytesCount+=e.bytesCount,!0)},first(){return t[0]},dequeue(){const e=t.shift();return e&&(this.bytesCount-=e.bytesCount),e},size(){return t.length},isFull(){return this.bytesCount>=Ri}}}function ka(){return{ongoingRequestCount:0,ongoingByteCount:0,canHandle(t){return this.ongoingRequestCount===0||this.ongoingByteCount+t.bytesCount<=Ia&&this.ongoingRequestCount<Aa},add(t){this.ongoingRequestCount+=1,this.ongoingByteCount+=t.bytesCount},remove(t){this.ongoingRequestCount-=1,this.ongoingByteCount-=t.bytesCount},stats(){return{ongoingByteCount:this.ongoingByteCount,ongoingRequestCount:this.ongoingRequestCount}}}}function Pi(t,e,n){const r=new T,i=xa();return{observable:r,send:s=>{for(const o of t)ki(s,i,(a,u)=>La(o,e,a,u),o.trackType,n,r)},sendOnExit:s=>{for(const o of t)Oa(o,e,s)}}}function Oa(t,e,n){if(!!navigator.sendBeacon&&n.bytesCount<e)try{const i=t.build("beacon",n);if(navigator.sendBeacon(i,n.data))return}catch(i){Na(i)}Nn(t,n)}let hr=!1;function Na(t){hr||(hr=!0,$t(t))}function La(t,e,n,r){if(Ma()&&n.bytesCount<e){const s=t.build("fetch-keepalive",n);fetch(s,{method:"POST",body:n.data,keepalive:!0,mode:"cors"}).then(y(o=>r?.({status:o.status,type:o.type}))).catch(y(()=>Nn(t,n,r)))}else Nn(t,n,r)}function Nn(t,e,n){const r=t.build("fetch",e);fetch(r,{method:"POST",body:e.data,mode:"cors"}).then(y(i=>n?.({status:i.status,type:i.type}))).catch(y(()=>n?.({status:0})))}function Ma(){try{return window.Request&&"keepalive"in new Request("http://a")}catch{return!1}}function be(){const t=Pa();if(t)return{getCapabilities(){var e;return JSON.parse(((e=t.getCapabilities)===null||e===void 0?void 0:e.call(t))||"[]")},getPrivacyLevel(){var e;return(e=t.getPrivacyLevel)===null||e===void 0?void 0:e.call(t)},getAllowedWebViewHosts(){return JSON.parse(t.getAllowedWebViewHosts())},send(e,n,r){const i=r?{id:r}:void 0;t.send(JSON.stringify({eventType:e,event:n,view:i}))}}}function Di(t){const e=be();return!!e&&e.getCapabilities().includes(t)}function Wt(t){var e;t===void 0&&(t=(e=et().location)===null||e===void 0?void 0:e.hostname);const n=be();return!!n&&n.getAllowedWebViewHosts().some(r=>t===r||t.endsWith(`.${r}`))}function Pa(){return et().DatadogEventBridge}function O(t,e,n,r,i){return mt(t,e,[n],r,i)}function mt(t,e,n,r,{once:i,capture:s,passive:o}={}){const a=y(f=>{!f.isTrusted&&!f.__ddIsTrusted&&!t.allowUntrustedEvents||(i&&l(),r(f))}),u=o?{capture:s,passive:o}:s,c=window.EventTarget&&e instanceof EventTarget?window.EventTarget.prototype:e,d=pt(c,"addEventListener");n.forEach(f=>d.call(e,f,a,u));function l(){const f=pt(c,"removeEventListener");n.forEach(p=>f.call(e,p,a,u))}return{stop:l}}const Bt={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"};function Da(t){return new T(e=>{const{stop:n}=mt(t,window,["visibilitychange","freeze"],i=>{i.type==="visibilitychange"&&document.visibilityState==="hidden"?e.notify({reason:Bt.HIDDEN}):i.type==="freeze"&&e.notify({reason:Bt.FROZEN})},{capture:!0}),r=O(t,window,"beforeunload",()=>{e.notify({reason:Bt.UNLOADING})}).stop;return()=>{n(),r()}})}function Ua(t){return di(Bt).includes(t)}function Ui({encoder:t,request:e,flushController:n,messageBytesLimit:r}){let i={};const s=n.flushObservable.subscribe(l=>d(l));function o(l,f,p){n.notifyBeforeAddMessage(f),p!==void 0?(i[p]=l,n.notifyAfterAddMessage()):t.write(t.isEmpty?l:`
${l}`,h=>{n.notifyAfterAddMessage(h-f)})}function a(l){return l!==void 0&&i[l]!==void 0}function u(l){const f=i[l];delete i[l];const p=t.estimateEncodedBytesCount(f);n.notifyAfterRemoveMessage(p)}function c(l,f){const p=qt(l),h=t.estimateEncodedBytesCount(p);if(h>=r){w.warn(`Discarded a message whose size was bigger than the maximum allowed size ${r}KB. ${Vn} ${lo}/#technical-limitations`);return}a(f)&&u(f),o(p,h,f)}function d(l){const f=di(i).join(`
`);i={};const p=Ua(l.reason),h=p?e.sendOnExit:e.send;if(p&&t.isAsync){const m=t.finishSync();m.outputBytesCount&&h(pr(m));const b=[m.pendingData,f].filter(Boolean).join(`
`);b&&h({data:b,bytesCount:ni(b)})}else f&&t.write(t.isEmpty?f:`
${f}`),t.finish(m=>{h(pr(m))})}return{flushController:n,add:c,upsert:c,stop:s.unsubscribe}}function pr(t){let e;return typeof t.output=="string"?e=t.output:e=new Blob([t.output],{type:"text/plain"}),{data:e,bytesCount:t.outputBytesCount,encoding:t.encoding}}function Vi({messagesLimit:t,bytesLimit:e,durationLimit:n,pageMayExitObservable:r,sessionExpireObservable:i}){const s=r.subscribe(h=>d(h.reason)),o=i.subscribe(()=>d("session_expire")),a=new T(()=>()=>{s.unsubscribe(),o.unsubscribe()});let u=0,c=0;function d(h){if(c===0)return;const m=c,b=u;c=0,u=0,p(),a.notify({reason:h,messagesCount:m,bytesCount:b})}let l;function f(){l===void 0&&(l=B(()=>{d("duration_limit")},n))}function p(){Q(l),l=void 0}return{flushObservable:a,get messagesCount(){return c},notifyBeforeAddMessage(h){u+h>=e&&d("bytes_limit"),c+=1,u+=h,f()},notifyAfterAddMessage(h=0){u+=h,c>=t?d("messages_limit"):u>=e&&d("bytes_limit")},notifyAfterRemoveMessage(h){u-=h,c-=1,c===0&&p()}}}const gt="DISCARDED",X="SKIPPED";function Va(){const t={};return{register(e,n){return t[e]||(t[e]=[]),t[e].push(n),{unregister:()=>{t[e]=t[e].filter(r=>r!==n)}}},triggerHook(e,n){const r=t[e]||[],i=[];for(const s of r){const o=s(n);if(o===gt)return gt;o!==X&&i.push(o)}return ut(...i)}}}const nt={LOG:"log",CONFIGURATION:"configuration",USAGE:"usage"},Fa=["https://www.datadoghq-browser-agent.com","https://www.datad0g-browser-agent.com","https://d3uc069fcn7uxw.cloudfront.net","https://d20xtzwzcl0ceb.cloudfront.net","http://localhost","<anonymous>"],Ba=[ya];let hn;function Xt(){return hn||(hn=new oi(100)),hn}function za(t,e,n,r,i,s){const o=new T,{stop:a}=Ga(e,r,i,s,o),{enabled:u}=$a(t,e,n,o);return{stop:a,enabled:u}}function $a(t,e,n,r){const i={},s=!Ba.includes(e.site)&&ct(e.telemetrySampleRate),o={[nt.LOG]:s,[nt.CONFIGURATION]:s&&ct(e.telemetryConfigurationSampleRate),[nt.USAGE]:s&&ct(e.telemetryUsageSampleRate)},a=Ha(),u=Xt();return u.subscribe(({rawEvent:d,kind:l})=>{if(!o[d.type])return;let f=i[l];if(f||(f=i[l]=new Set),f.size>=e.maxTelemetryEventsPerPage)return;const p=qt(d);if(f.has(p))return;const h=n.triggerHook(1,{startTime:F().relative});if(h===gt)return;const m=c(h,t,d,a);r.notify(m),Ai("telemetry",m),f.add(p)}),u.unbuffer(),Eo(Kn),{enabled:s};function c(d,l,f,p){const m={type:"telemetry",date:F().timeStamp,service:l,version:"6.18.1",source:"browser",_dd:{format_version:2},telemetry:ut(f,{runtime_env:p,connectivity:Ci(),sdk_setup:"npm"}),experimental_features:Array.from(ga())};return ut(m,d)}}function Ga(t,e,n,r,i){const s=[];if(Wt()){const o=be(),a=i.subscribe(u=>o.send("internal_telemetry",u));s.push(a.unsubscribe)}else{const o=[t.rumEndpointBuilder];t.replica&&Wa(t)&&o.push(t.replica.rumEndpointBuilder);const a=Ui({encoder:r(4),request:Pi(o,t.batchBytesLimit,e),flushController:Vi({messagesLimit:t.batchMessagesLimit,bytesLimit:t.batchBytesLimit,durationLimit:t.flushTimeout,pageMayExitObservable:n,sessionExpireObservable:new T}),messageBytesLimit:t.messageBytesLimit});s.push(a.stop);const u=i.subscribe(a.add);s.push(u.unsubscribe)}return{stop:()=>s.forEach(o=>o())}}function Ha(){return{is_local_file:window.location.protocol==="file:",is_worker:"WorkerGlobalScope"in self}}function Wa(t){return t.site===Ii}function _t(t,e){kn(Fe.debug,t,e),Xt().notify({rawEvent:{type:nt.LOG,message:t,status:"debug",...e},kind:"debug"})}function Kn(t,e){Xt().notify({rawEvent:{type:nt.LOG,status:"error",...ja(t),...e},kind:"error"})}function Ka(t){Xt().notify({rawEvent:{type:nt.CONFIGURATION,configuration:t},kind:nt.CONFIGURATION})}function jn(t,e){Xt().notify({rawEvent:{type:nt.LOG,message:t,status:"debug",...e},kind:t})}function W(t){Xt().notify({rawEvent:{type:nt.USAGE,usage:t},kind:nt.USAGE})}function ja(t){if(Rt(t)){const e=ge(t);return{error:{kind:e.name,stack:_e(qa(e))},message:e.message}}return{error:{stack:Ti},message:`Uncaught ${qt(t)}`}}function qa(t){return t.stack=t.stack.filter(e=>!e.url||Fa.some(n=>e.url.startsWith(n))),t}const Ya=10,Xa=100,Ja=z,Fi="--",Bi=[];let Oe;function Et(t,e,n=0){var r;const{isLockEnabled:i,persistSession:s,expireSession:o}=e,a=f=>s({...f,lock:c}),u=()=>{const{lock:f,...p}=e.retrieveSession();return{session:p,lock:f&&!Qa(f)?f:void 0}};if(Oe||(Oe=t),t!==Oe){Bi.push(t);return}if(i&&n>=Xa){_t("Aborted session operation after max lock retries",{currentStore:u()}),mr(e);return}let c,d=u();if(i){if(d.lock){Ce(t,e,n);return}if(c=Za(),a(d.session),d=u(),d.lock!==c){Ce(t,e,n);return}}let l=t.process(d.session);if(i&&(d=u(),d.lock!==c)){Ce(t,e,n);return}if(l&&(se(l)?o(l):(gi(l),i?a(l):s(l))),i&&!(l&&se(l))){if(d=u(),d.lock!==c){Ce(t,e,n);return}s(d.session),l=d.session}(r=t.after)===null||r===void 0||r.call(t,l||d.session),mr(e)}function Ce(t,e,n){B(()=>{Et(t,e,n+1)},Ya)}function mr(t){Oe=void 0;const e=Bi.shift();e&&Et(e,t)}function Za(){return $()+Fi+V()}function Qa(t){const[,e]=t.split(Fi);return!e||N(Number(e),V())>Ja}const gr=z;function tc(t){switch(t.sessionPersistence){case de.COOKIE:return lr(t);case de.LOCAL_STORAGE:return fr();case void 0:{let e=lr(t);return!e&&t.allowFallbackToLocalStorage&&(e=fr()),e}default:w.error(`Invalid session persistence '${String(t.sessionPersistence)}'`)}}function ec(t,e){return t.type===de.COOKIE?Vo(e,t.cookieOptions):zo(e)}function nc(t,e,n,r,i=ec(t,e)){const s=new T,o=new T,a=new T,u=jt(p,gr);let c;m();const{throttled:d,cancel:l}=Ge(()=>{Et({process:_=>{if(ke(_))return;const D=h(_);return b(D),D},after:_=>{mi(_)&&!R()&&S(_),c=_}},i)},gr);function f(){Et({process:_=>R()?h(_):void 0},i)}function p(){const _=i.retrieveSession();se(_)?Et({process:D=>se(D)?vt(D,e):void 0,after:h},i):h(_)}function h(_){return se(_)&&(_=vt(_,e)),R()&&(P(_)?g():(a.notify({previousState:c,newState:_}),c=_)),_}function m(){Et({process:_=>{if(ke(_))return vt(_,e)},after:_=>{c=_}},i)}function b(_){if(ke(_))return!1;const D=r(_[n]);_[n]=D,delete _.isExpired,D!==hi&&!_.id&&(_.id=$(),_.created=String(tt()))}function R(){return c?.[n]!==void 0}function P(_){return c.id!==_.id||c[n]!==_[n]}function g(){c=vt(c,e),o.notify()}function S(_){c=_,s.notify()}function k(_){Et({process:D=>({...D,..._}),after:h},i)}return{expandOrRenewSession:d,expandSession:f,getSession:()=>c,renewObservable:s,expireObservable:o,sessionStateUpdateObservable:a,restartSession:m,expire:()=>{l(),i.expireSession(c),h(vt(c,e))},stop:()=>{$e(u)},updateSessionState:k}}const Ln={GRANTED:"granted",NOT_GRANTED:"not-granted"};function rc(t){const e=new T;return{tryToInit(n){t||(t=n)},update(n){t=n,e.notify()},isGranted(){return t===Ln.GRANTED},observable:e}}function qn(t){const e=xt(t);return e==="string"||e==="function"||t instanceof RegExp}function Yn(t,e,n=!1){return t.some(r=>{try{if(typeof r=="function")return r(e);if(r instanceof RegExp)return r.test(e);if(typeof r=="string")return n?e.startsWith(r):r===e}catch(i){w.error(i)}return!1})}const zi=["chrome-extension://","moz-extension://"];function _r(t){return zi.some(e=>t.includes(e))}function ic(t,e=""){return!_r(t)&&_r(e)}function sc(t=""){for(const e of zi){const n=t.match(new RegExp(`${e}[^/]+`));if(n)return n[0]}}const br="Running the Browser SDK in a Web extension content script is discouraged and will be forbidden in a future major release unless the `allowedTrackingOrigins` option is provided.",oc="SDK initialized on a non-allowed domain.";function ac(t,e=typeof location<"u"?location.origin:"",n=new Error().stack){const r=t.allowedTrackingOrigins;if(!r){if(ic(e,n)){w.warn(br);const s=sc(n);_t(br,{extensionUrl:s||"unknown"})}return!0}const i=Yn(r,e);return i||w.error(oc),i}function Xn(t){return Jn(t,location.href).href}function cc(t){try{return!!Jn(t)}catch{return!1}}function uc(t){const e=Jn(t).pathname;return e[0]==="/"?e:`/${e}`}function Jn(t,e){const{URL:n}=lc();try{return e!==void 0?new n(t,e):new n(t)}catch(r){throw new Error(`Failed to construct URL: ${String(r)} ${qt({url:t,base:e})}`)}}let pn;function lc(){if(!pn){let t,e;try{t=document.createElement("iframe"),t.style.display="none",document.body.appendChild(t),e=t.contentWindow}catch{e=window}pn={URL:e.URL},t?.remove()}return pn}function St(t,e,n){const r=dc(t,e);return{build(i,s){const o=fc(t,e,i,s,n);return r(o)},trackType:e}}function dc(t,e){const n=`/api/v2/${e}`,r=t.proxy;if(typeof r=="string"){const s=Xn(r);return o=>`${s}?ddforward=${encodeURIComponent(`${n}?${o}`)}`}if(typeof r=="function")return s=>r({path:n,parameters:s});const i=$i(e,t);return s=>`https://${i}${n}?${s}`}function $i(t,e){const{site:n=wt,internalAnalyticsSubdomain:r}=e;if(t==="logs"&&e.usePciIntake&&n===wt)return va;if(r&&n===wt)return`${r}.${wt}`;if(n===_a)return`http-intake.logs.${n}`;const i=n.split("."),s=i.pop();return`browser-intake-${i.join("-")}.${s}`}function fc({clientToken:t,internalAnalyticsSubdomain:e},n,r,{retry:i,encoding:s},o=[]){const a=["ddsource=browser",`dd-api-key=${t}`,`dd-evp-origin-version=${encodeURIComponent("6.18.1")}`,"dd-evp-origin=browser",`dd-request-id=${$()}`].concat(o);return s&&a.push(`dd-evp-encoding=${s}`),n==="rum"&&(a.push(`batch_time=${V()}`,`_dd.api=${r}`),i&&a.push(`_dd.retry_count=${i.count}`,`_dd.retry_after=${i.lastFailureStatus}`)),e&&a.reverse(),a.join("&")}function hc(t){const e=t.site||wt,n=pc(t);return{replica:mc(t),site:e,...n}}function pc(t){return{logsEndpointBuilder:St(t,"logs"),rumEndpointBuilder:St(t,"rum"),profilingEndpointBuilder:St(t,"profile"),sessionReplayEndpointBuilder:St(t,"replay"),exposuresEndpointBuilder:St(t,"exposures")}}function mc(t){if(!t.replica)return;const e={...t,site:wt,clientToken:t.replica.clientToken};return{logsEndpointBuilder:St(e,"logs"),rumEndpointBuilder:St(e,"rum",[`application.id=${t.replica.applicationId}`])}}function gc(t){return Ea.every(e=>t.includes(e))}const oe={ALLOW:"allow",MASK:"mask",MASK_USER_INPUT:"mask-user-input"},Mn={ALL:"all",SAMPLED:"sampled"};function mn(t,e){return t!=null&&typeof t!="string"?(w.error(`${e} must be defined as a string`),!1):!0}function _c(t){return t&&typeof t=="string"&&!/(datadog|ddog|datad0g|dd0g)/.test(t)?(w.error(`Site should be a valid Datadog site. ${Vn} ${Be}/getting_started/site/.`),!1):!0}function Vt(t,e){return t!==void 0&&!fo(t)?(w.error(`${e} Sample Rate should be a number between 0 and 100`),!1):!0}function bc(t){var e,n,r,i,s,o,a,u,c,d;if(!t||!t.clientToken){w.error("Client Token is not configured, we will not send any data.");return}if(t.allowedTrackingOrigins!==void 0&&!Array.isArray(t.allowedTrackingOrigins)){w.error("Allowed Tracking Origins must be an array");return}if(!(!_c(t.site)||!Vt(t.sessionSampleRate,"Session")||!Vt(t.telemetrySampleRate,"Telemetry")||!Vt(t.telemetryConfigurationSampleRate,"Telemetry Configuration")||!Vt(t.telemetryUsageSampleRate,"Telemetry Usage")||!mn(t.version,"Version")||!mn(t.env,"Env")||!mn(t.service,"Service")||!ac(t))){if(t.trackingConsent!==void 0&&!Pe(Ln,t.trackingConsent)){w.error('Tracking Consent should be either "granted" or "not-granted"');return}return{beforeSend:t.beforeSend&&Jr(t.beforeSend,"beforeSend threw an error:"),sessionStoreStrategyType:tc(t),sessionSampleRate:(e=t.sessionSampleRate)!==null&&e!==void 0?e:100,telemetrySampleRate:(n=t.telemetrySampleRate)!==null&&n!==void 0?n:20,telemetryConfigurationSampleRate:(r=t.telemetryConfigurationSampleRate)!==null&&r!==void 0?r:5,telemetryUsageSampleRate:(i=t.telemetryUsageSampleRate)!==null&&i!==void 0?i:5,service:(s=t.service)!==null&&s!==void 0?s:void 0,env:(o=t.env)!==null&&o!==void 0?o:void 0,version:(a=t.version)!==null&&a!==void 0?a:void 0,datacenter:(u=t.datacenter)!==null&&u!==void 0?u:void 0,silentMultipleInit:!!t.silentMultipleInit,allowUntrustedEvents:!!t.allowUntrustedEvents,trackingConsent:(c=t.trackingConsent)!==null&&c!==void 0?c:Ln.GRANTED,trackAnonymousUser:(d=t.trackAnonymousUser)!==null&&d!==void 0?d:!0,storeContextsAcrossPages:!!t.storeContextsAcrossPages,batchBytesLimit:16*ce,eventRateLimiterThreshold:3e3,maxTelemetryEventsPerPage:15,flushTimeout:30*z,batchMessagesLimit:50,messageBytesLimit:256*ce,...hc(t)}}}function yc(t){return{session_sample_rate:t.sessionSampleRate,telemetry_sample_rate:t.telemetrySampleRate,telemetry_configuration_sample_rate:t.telemetryConfigurationSampleRate,telemetry_usage_sample_rate:t.telemetryUsageSampleRate,use_before_send:!!t.beforeSend,use_partitioned_cross_site_session_cookie:t.usePartitionedCrossSiteSessionCookie,use_secure_session_cookie:t.useSecureSessionCookie,use_proxy:!!t.proxy,silent_multiple_init:t.silentMultipleInit,track_session_across_subdomains:t.trackSessionAcrossSubdomains,track_anonymous_user:t.trackAnonymousUser,session_persistence:t.sessionPersistence,allow_fallback_to_local_storage:!!t.allowFallbackToLocalStorage,store_contexts_across_pages:!!t.storeContextsAcrossPages,allow_untrusted_events:!!t.allowUntrustedEvents,tracking_consent:t.trackingConsent,use_allowed_tracking_origins:Array.isArray(t.allowedTrackingOrigins)}}const vc=200;function Ec(t){const{env:e,service:n,version:r,datacenter:i}=t,s=[Qt("sdk_version","6.18.1")];return e&&s.push(Qt("env",e)),n&&s.push(Qt("service",n)),r&&s.push(Qt("version",r)),i&&s.push(Qt("datacenter",i)),s}function Qt(t,e){const n=e?`${t}:${e}`:t;return(n.length>vc||wc(n))&&w.warn(`Tag ${n} doesn't meet tag requirements and will be sanitized. ${Vn} ${Be}/getting_started/tagging/#defining-tags`),Sc(n)}function Sc(t){return t.replace(/,/g,"_")}function wc(t){return Tc()?new RegExp("[^\\p{Ll}\\p{Lo}0-9_:./-]","u").test(t):!1}function Tc(){try{return new RegExp("[\\p{Ll}]","u"),!0}catch{return!1}}function rt(t,e,n,{computeHandlingStack:r}={}){let i=t[e];if(typeof i!="function")if(e in t&&e.startsWith("on"))i=x;else return{stop:x};let s=!1;const o=function(){if(s)return i.apply(this,arguments);const a=Array.from(arguments);let u;Tt(n,null,[{target:this,parameters:a,onPostCall:d=>{u=d},handlingStack:r?Ue("instrumented method"):void 0}]);const c=i.apply(this,a);return u&&Tt(u,null,[c]),c};return t[e]=o,{stop:()=>{s=!0,t[e]===o&&(t[e]=i)}}}function _p(t,e,n){const r=Object.getOwnPropertyDescriptor(t,e);if(!r||!r.set||!r.configurable)return{stop:x};const i=x;let s=(a,u)=>{B(()=>{s!==i&&n(a,u)},0)};const o=function(a){r.set.call(this,a),s(this,a)};return Object.defineProperty(t,e,{set:o}),{stop:()=>{var a;((a=Object.getOwnPropertyDescriptor(t,e))===null||a===void 0?void 0:a.set)===o&&Object.defineProperty(t,e,r),s=i}}}function Ic(){return new T(t=>{const e=(i,s)=>{const o=Gn({stackTrace:s,originalError:i,startClocks:F(),nonErrorPrefix:"Uncaught",source:Yt.SOURCE,handling:"unhandled"});t.notify(o)},{stop:n}=Ac(e),{stop:r}=Cc(e);return()=>{n(),r()}})}function Ac(t){return rt(et(),"onerror",({parameters:[e,n,r,i,s]})=>{let o;Rt(s)||(o=oa(e,n,r,i)),t(s??e,o)})}function Cc(t){return rt(et(),"onunhandledrejection",({parameters:[e]})=>{t(e.reason||"Empty reason")})}function Rc(t){const e={version:"6.18.1",onReady(n){n()},...t};return Object.defineProperty(e,"_setDebug",{get(){return So},enumerable:!1}),e}function xc(t,e,n){const r=t[e];r&&!r.q&&r.version&&w.warn("SDK is loaded more than once. This is unsupported and might have unexpected behavior."),t[e]=n,r&&r.q&&r.q.forEach(i=>Jr(i,"onReady callback threw an error:")())}function Gi(t,e){e.silentMultipleInit||w.error(`${t} is already initialized.`)}const fe={intervention:"intervention",cspViolation:"csp_violation"};function kc(t,e){const n=[];e.includes(fe.cspViolation)&&n.push(Nc(t));const r=e.filter(i=>i!==fe.cspViolation);return r.length&&n.push(Oc(r)),si(...n)}function Oc(t){return new T(e=>{if(!window.ReportingObserver)return;const n=y((i,s)=>i.forEach(o=>e.notify(Lc(o)))),r=new window.ReportingObserver(n,{types:t,buffered:!0});return r.observe(),()=>{r.disconnect()}})}function Nc(t){return new T(e=>{const{stop:n}=O(t,document,"securitypolicyviolation",r=>{e.notify(Mc(r))});return n})}function Lc(t){const{type:e,body:n}=t;return Hi({type:n.id,message:`${e}: ${n.message}`,originalError:t,stack:Wi(n.id,n.message,n.sourceFile,n.lineNumber,n.columnNumber)})}function Mc(t){const e=`'${t.blockedURI}' blocked by '${t.effectiveDirective}' directive`;return Hi({type:t.effectiveDirective,message:`${fe.cspViolation}: ${e}`,originalError:t,csp:{disposition:t.disposition},stack:Wi(t.effectiveDirective,t.originalPolicy?`${e} of the policy "${ai(t.originalPolicy,100,"...")}"`:"no policy",t.sourceFile,t.lineNumber,t.columnNumber)})}function Hi(t){return{startClocks:F(),source:Yt.REPORT,handling:"unhandled",...t}}function Wi(t,e,n,r,i){return n?_e({name:t,message:e,stack:[{func:"?",url:n,line:r??void 0,column:i??void 0}]}):void 0}function Ki(t,e){const n=t.indexOf(e);n>=0&&t.splice(n,1)}const Re=1/0,Pc=j;let te=null;const Ne=new Set;function Dc(){Ne.forEach(t=>t())}function Jt({expireDelay:t,maxEntries:e}){let n=[];te||(te=jt(()=>Dc(),Pc));const r=()=>{const d=Y()-t;for(;n.length>0&&n[n.length-1].endTime<d;)n.pop()};Ne.add(r);function i(d,l){const f={value:d,startTime:l,endTime:Re,remove:()=>{Ki(n,f)},close:p=>{f.endTime=p}};return e&&n.length>=e&&n.pop(),n.unshift(f),f}function s(d=Re,l={returnInactive:!1}){for(const f of n)if(f.startTime<=d){if(l.returnInactive||d<=f.endTime)return f.value;break}}function o(d){const l=n[0];l&&l.endTime===Re&&l.close(d)}function a(d=Re,l=0){const f=Kt(d,l);return n.filter(p=>p.startTime<=f&&d<=p.endTime).map(p=>p.value)}function u(){n=[]}function c(){Ne.delete(r),Ne.size===0&&te&&($e(te),te=null)}return{add:i,find:s,closeActive:o,findAll:a,reset:u,stop:c}}const Uc="datadog-synthetics-public-id",Vc="datadog-synthetics-result-id",Fc="datadog-synthetics-injects-rum";function ji(){return!!(window._DATADOG_SYNTHETICS_INJECTS_RUM||ht(Fc))}function qi(){const t=window._DATADOG_SYNTHETICS_PUBLIC_ID||ht(Uc);return typeof t=="string"?t:void 0}function Yi(){const t=window._DATADOG_SYNTHETICS_RESULT_ID||ht(Vc);return typeof t=="string"?t:void 0}function Xi(){return!!(qi()&&Yi())}const Bc=j,zc=Ct;function $c(t,e,n,r){const i=new T,s=new T,o=nc(t.sessionStoreStrategyType,t,e,n),a=Jt({expireDelay:zc});o.renewObservable.subscribe(()=>{a.add(u(),Y()),i.notify()}),o.expireObservable.subscribe(()=>{s.notify(),a.closeActive(Y())}),o.expandOrRenewSession(),a.add(u(),ti().relative),r.observable.subscribe(()=>{r.isGranted()?o.expandOrRenewSession():o.expire()}),Gc(t,()=>{r.isGranted()&&o.expandOrRenewSession()}),Hc(t,()=>o.expandSession()),Wc(t,()=>o.restartSession());function u(){const c=o.getSession();return c?{id:c.id,trackingType:c[e],isReplayForced:!!c.forcedReplay,anonymousId:c.anonymousId}:(Kc().catch(()=>{}),{id:"invalid",trackingType:hi,isReplayForced:!1,anonymousId:void 0})}return{findSession:(c,d)=>a.find(c,d),renewObservable:i,expireObservable:s,sessionStateUpdateObservable:o.sessionStateUpdateObservable,expire:o.expire,updateSessionState:o.updateSessionState}}function Gc(t,e){const{stop:n}=mt(t,window,["click","touchstart","keydown","scroll"],e,{capture:!0,passive:!0})}function Hc(t,e){const n=()=>{document.visibilityState==="visible"&&e()},{stop:r}=O(t,document,"visibilitychange",n);jt(n,Bc)}function Wc(t,e){const{stop:n}=O(t,window,"resume",e,{capture:!0})}async function Kc(){const t=yi();let e=[];"cookieStore"in window?e=await window.cookieStore.getAll("_dd_s"):e=document.cookie.split(/\s*;\s*/).filter(n=>n.startsWith("_dd_s")),_t("Unexpected session state",{session:t,isSyntheticsTest:Xi(),createdTimestamp:t?.created,expireTimestamp:t?.expire,cookie:{count:e.length,domain:li(),...e},currentDomain:`${window.location.protocol}//${window.location.hostname}`})}function jc(){let t="",e=0;return{isAsync:!1,get isEmpty(){return!t},write(n,r){const i=ni(n);e+=i,t+=n,r&&r(i)},finish(n){n(this.finishSync())},finishSync(){const n={output:t,outputBytesCount:e,rawBytesCount:e,pendingData:""};return t="",e=0,n},estimateEncodedBytesCount(n){return n.length}}}class qc{constructor(){this.callbacks={}}notify(e,n){const r=this.callbacks[e];r&&r.forEach(i=>i(n))}subscribe(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),{unsubscribe:()=>{this.callbacks[e]=this.callbacks[e].filter(r=>n!==r)}}}}function gn(t,e,n){let r=0,i=!1;return{isLimitReached(){if(r===0&&B(()=>{r=0},j),r+=1,r<=e||i)return i=!1,!1;if(r===e+1){i=!0;try{n({message:`Reached max number of ${t}s by minute: ${e}`,source:Yt.AGENT,startClocks:F()})}finally{i=!1}}return!0}}}function Zn(t,e,n){return document.readyState===e||document.readyState==="complete"?(n(),{stop:x}):O(t,window,e==="complete"?"load":"DOMContentLoaded",n,{once:!0})}function Yc(t,e){return new Promise(n=>{Zn(t,e,n)})}let _n;const Qn=new WeakMap;function Xc(t){return _n||(_n=Jc(t)),_n}function Jc(t){return new T(e=>{const{stop:n}=rt(XMLHttpRequest.prototype,"open",Zc),{stop:r}=rt(XMLHttpRequest.prototype,"send",s=>{Qc(s,t,e)},{computeHandlingStack:!0}),{stop:i}=rt(XMLHttpRequest.prototype,"abort",tu);return()=>{n(),r(),i()}})}function Zc({target:t,parameters:[e,n]}){Qn.set(t,{state:"open",method:String(e).toUpperCase(),url:Xn(String(n))})}function Qc({target:t,handlingStack:e},n,r){const i=Qn.get(t);if(!i)return;const s=i;s.state="start",s.startClocks=F(),s.isAborted=!1,s.xhr=t,s.handlingStack=e;let o=!1;const{stop:a}=rt(t,"onreadystatechange",()=>{t.readyState===XMLHttpRequest.DONE&&u()}),u=()=>{if(c(),a(),o)return;o=!0;const d=i;d.state="complete",d.duration=N(s.startClocks.timeStamp,V()),d.status=t.status,r.notify(ue(d))},{stop:c}=O(n,t,"loadend",u);r.notify(s)}function tu({target:t}){const e=Qn.get(t);e&&(e.isAborted=!0)}let bn;function Ji(){return bn||(bn=eu()),bn}function eu(){return new T(t=>{if(!window.fetch)return;const{stop:e}=rt(window,"fetch",n=>nu(n,t),{computeHandlingStack:!0});return e})}function nu({parameters:t,onPostCall:e,handlingStack:n},r){const[i,s]=t;let o=s&&s.method;o===void 0&&i instanceof Request&&(o=i.method);const a=o!==void 0?String(o).toUpperCase():"GET",u=i instanceof Request?i.url:Xn(String(i)),c=F(),d={state:"start",init:s,input:i,method:a,startClocks:c,url:u,handlingStack:n};r.notify(d),t[0]=d.input,t[1]=d.init,e(l=>ru(r,l,d))}function ru(t,e,n){const r=n;function i(s){r.state="resolve",Object.assign(r,s),t.notify(r)}e.then(y(s=>{i({response:s,responseType:s.type,status:s.status,isAborted:!1})}),y(s=>{var o,a;i({status:0,isAborted:((a=(o=r.init)===null||o===void 0?void 0:o.signal)===null||a===void 0?void 0:a.aborted)||s instanceof DOMException&&s.code===DOMException.ABORT_ERR,error:s})}))}function iu(t,e){if(window.requestIdleCallback&&window.cancelIdleCallback){const n=window.requestIdleCallback(y(t),e);return()=>window.cancelIdleCallback(n)}return ou(t)}const su=50;function ou(t){const e=tt(),n=B(()=>{t({didTimeout:!1,timeRemaining:()=>Math.max(0,su-(tt()-e))})},0);return()=>Q(n)}const au=z,cu=30;function uu(){const t=[];function e(r){let i;if(r.didTimeout){const s=performance.now();i=()=>cu-(performance.now()-s)}else i=r.timeRemaining.bind(r);for(;i()>0&&t.length;)t.shift()();t.length&&n()}function n(){iu(e,{timeout:au})}return{push(r){t.push(r)===1&&n()}}}let yn={};function lu(t){const e=t.map(n=>(yn[n]||(yn[n]=du(n)),yn[n]));return si(...e)}function du(t){return new T(e=>{const n=ot[t];return ot[t]=(...r)=>{n.apply(console,r);const i=Ue("console error");Tt(()=>{e.notify(fu(r,t,i))})},()=>{ot[t]=n}})}function fu(t,e,n){const r=t.map(i=>hu(i)).join(" ");if(e===Fe.error){const i=t.find(Rt),s=Gn({originalError:i,handlingStack:n,startClocks:F(),source:Yt.CONSOLE,handling:"handled",nonErrorPrefix:"Provided",useFallbackStack:!1});return s.message=r,{api:e,message:r,handlingStack:n,error:s}}return{api:e,message:r,error:void 0,handlingStack:n}}function hu(t){return typeof t=="string"?L(t):Rt(t)?wi(ge(t)):qt(L(t),void 0,2)}const pu=500;function mu(){const t=[];return{add:i=>{t.push(i)>pu&&t.splice(0,1)},remove:i=>{Ki(t,i)},drain:i=>{t.forEach(s=>s(i)),t.length=0}}}function gu(t){const e=xt(t)==="object";return e||w.error("Unsupported context:",t),e}function vn(t,e,n){const r={...t};for(const[i,{required:s,type:o}]of Object.entries(e))o==="string"&&!yr(r[i])&&(r[i]=String(r[i])),s&&yr(r[i])&&w.warn(`The property ${i} of ${n} is required; context will not be sent to the intake.`);return r}function yr(t){return t==null||t===""}function Ke(t="",{propertiesConfig:e={}}={}){let n={};const r=new T,i={getContext:()=>Wn(n),setContext:s=>{gu(s)?n=L(vn(s,e,t)):i.clearContext(),r.notify()},setContextProperty:(s,o)=>{n=L(vn({...n,[s]:o},e,t)),r.notify()},removeContextProperty:s=>{delete n[s],vn(n,e,t),r.notify()},clearContext:()=>{n={},r.notify()},changeObservable:r};return i}function G(t,e,n,r){return y((...i)=>(r&&W({feature:r}),t()[e][n](...i)))}const _u="_dd_c",bu=[];function tr(t,e,n,r){const i=yu(n,r);bu.push(O(t,window,"storage",({key:c})=>{i===c&&o()})),e.changeObservable.subscribe(a);const s=ut(u(),e.getContext());At(s)||e.setContext(s);function o(){e.setContext(u())}function a(){localStorage.setItem(i,JSON.stringify(e.getContext()))}function u(){const c=localStorage.getItem(i);return c?JSON.parse(c):{}}}function yu(t,e){return`${_u}_${t}_${e}`}function vu(t,e,n){const r=Zi();return e.storeContextsAcrossPages&&tr(e,r,n,4),t.register(0,()=>{const i=r.getContext();return At(i)||!i.id?X:{account:i}}),r}function Zi(){return Ke("account",{propertiesConfig:{id:{type:"string",required:!0},name:{type:"string"}}})}function Eu(t,e,n,r){const i=Qi();return e.storeContextsAcrossPages&&tr(e,i,n,2),t.register(0,()=>({context:i.getContext()})),i}function Qi(){return Ke("global context")}function Su(t,e,n,r){const i=ts();return e.storeContextsAcrossPages&&tr(e,i,r,1),t.register(0,({eventType:s,startTime:o})=>{const a=i.getContext(),u=n.findTrackedSession(o);return u&&u.anonymousId&&!a.anonymous_id&&e.trackAnonymousUser&&(a.anonymous_id=u.anonymousId),At(a)?X:{type:s,usr:a}}),t.register(1,({startTime:s})=>{var o;return{anonymous_id:(o=n.findTrackedSession(s))===null||o===void 0?void 0:o.anonymousId}}),i}function ts(){return Ke("user",{propertiesConfig:{id:{type:"string"},name:{type:"string"},email:{type:"string"}}})}const U={userContext:"userContext",globalContext:"globalContext",accountContext:"accountContext"},H={getContext:"getContext",setContext:"setContext",setContextProperty:"setContextProperty",removeContextProperty:"removeContextProperty",clearContext:"clearContext"};function wu(t,e,n){const r=t.getReader();let i=0;s();function s(){r.read().then(y(a=>{if(a.done){o();return}i+=a.value.length,i>n.bytesLimit?o():s()}),y(a=>e(a)))}function o(){r.cancel().catch(x),e(void 0,void 0,void 0)}}const K={DOCUMENT:"document",XHR:"xhr",BEACON:"beacon",FETCH:"fetch",CSS:"css",JS:"js",IMAGE:"image",FONT:"font",MEDIA:"media",OTHER:"other"},je={FETCH:K.FETCH,XHR:K.XHR},Tu=500;function Iu(t=Ic){const e=new oi(Tu),n=t().subscribe(r=>{e.notify({type:0,error:r})});return{observable:e,stop:()=>{n.unsubscribe()}}}function Au(){try{return new Intl.DateTimeFormat().resolvedOptions().timeZone}catch{return}}const E={ACTION:"action",ERROR:"error",LONG_TASK:"long_task",VIEW:"view",RESOURCE:"resource",VITAL:"vital"},es={LONG_TASK:"long-task",LONG_ANIMATION_FRAME:"long-animation-frame"},at={INITIAL_LOAD:"initial_load",ROUTE_CHANGE:"route_change",BF_CACHE:"bf_cache"},er={CLICK:"click",CUSTOM:"custom"},ee={RAGE_CLICK:"rage_click",ERROR_CLICK:"error_click",DEAD_CLICK:"dead_click"},ns={DURATION:"duration"};function Cu(){return{vitalsByName:new Map,vitalsByReference:new WeakMap}}function Ru(t,e,n){function r(s){return!e.wasInPageStateDuringPeriod("frozen",s.startClocks.relative,s.duration)}function i(s){r(s)&&t.notify(12,ku(s))}return{addDurationVital:i,startDurationVital:(s,o={})=>rs(n,s,o),stopDurationVital:(s,o={})=>{is(i,n,s,o)}}}function rs({vitalsByName:t,vitalsByReference:e},n,r={}){const i={name:n,startClocks:F(),context:r.context,description:r.description},s={__dd_vital_reference:!0};return t.set(n,i),e.set(s,i),s}function is(t,{vitalsByName:e,vitalsByReference:n},r,i={}){const s=typeof r=="string"?e.get(r):n.get(r);s&&(t(xu(s,s.startClocks,i,F())),typeof r=="string"?e.delete(r):n.delete(r))}function xu(t,e,n,r){var i;return{name:t.name,type:ns.DURATION,startClocks:e,duration:N(e.timeStamp,r.timeStamp),context:ut(t.context,n.context),description:(i=n.description)!==null&&i!==void 0?i:t.description}}function ku(t,e){const n={date:t.startClocks.timeStamp,vital:{id:$(),type:t.type,name:t.name,duration:v(t.duration),description:t.description},type:E.VITAL,context:t.context};return n._dd={vital:{computed_value:!0}},{rawRumEvent:n,startTime:t.startClocks.relative,duration:t.duration,domainContext:{}}}function ss(t,e,n){if(t)for(const r of t){const i=r[e];i&&i(n)}}const vr=new Map;function os(t,e){if(e===100)return!0;if(e===0)return!1;const n=vr.get(e);if(n&&t===n.sessionId)return n.decision;let r;return window.BigInt?r=Ou(BigInt(`0x${t.split("-")[4]}`),e):r=ct(e),vr.set(e,{sessionId:t,decision:r}),r}function Ou(t,e){const n=BigInt("1111111111111111111"),r=BigInt("0x10000000000000000"),i=t*n%r;return Number(i)<=e/100*Number(r)}function Nu(){return cs(64)}function as(){return cs(63)}function cs(t){const e=crypto.getRandomValues(new Uint32Array(2));return t===63&&(e[e.length-1]>>>=1),{toString(n=10){let r=e[1],i=e[0],s="";do{const o=r%n*4294967296+i;r=Math.floor(r/n),i=Math.floor(o/n),s=(o%n).toString(n)+s}while(r||i);return s}}}function Nt(t){return t.toString(16).padStart(16,"0")}function Lu(t){const e=t;return xt(e)==="object"&&qn(e.match)&&Array.isArray(e.propagatorTypes)}function Mu(t){t.status===0&&!t.isAborted&&(t.traceId=void 0,t.spanId=void 0,t.traceSampled=void 0)}function Pu(t,e,n,r){return{clearTracingIfNeeded:Mu,traceFetch:i=>Er(t,i,e,n,r,s=>{var o;if(i.input instanceof Request&&!(!((o=i.init)===null||o===void 0)&&o.headers))i.input=new Request(i.input),Object.keys(s).forEach(a=>{i.input.headers.append(a,s[a])});else{i.init=ue(i.init);const a=[];i.init.headers instanceof Headers?i.init.headers.forEach((u,c)=>{a.push([c,u])}):Array.isArray(i.init.headers)?i.init.headers.forEach(u=>{a.push(u)}):i.init.headers&&Object.keys(i.init.headers).forEach(u=>{a.push([u,i.init.headers[u]])}),i.init.headers=a.concat(zn(s))}}),traceXhr:(i,s)=>Er(t,i,e,n,r,o=>{Object.keys(o).forEach(a=>{s.setRequestHeader(a,o[a])})})}}function Er(t,e,n,r,i,s){const o=n.findTrackedSession();if(!o)return;const a=t.allowedTracingUrls.find(d=>Yn([d.match],e.url,!0));if(!a)return;const u=os(o.id,t.traceSampleRate);(u||t.traceContextInjection===Mn.ALL)&&(e.traceSampled=u,e.traceId=Nu(),e.spanId=as(),s(Du(e.traceId,e.spanId,e.traceSampled,o.id,a.propagatorTypes,r,i,t)))}function Du(t,e,n,r,i,s,o,a){const u={};if(i.forEach(c=>{switch(c){case"datadog":{Object.assign(u,{"x-datadog-origin":"rum","x-datadog-parent-id":e.toString(),"x-datadog-sampling-priority":n?"1":"0","x-datadog-trace-id":t.toString()});break}case"tracecontext":{Object.assign(u,{traceparent:`00-0000000000000000${Nt(t)}-${Nt(e)}-0${n?"1":"0"}`,tracestate:`dd=s:${n?"1":"0"};o:rum`});break}case"b3":{Object.assign(u,{b3:`${Nt(t)}-${Nt(e)}-${n?"1":"0"}`});break}case"b3multi":{Object.assign(u,{"X-B3-TraceId":Nt(t),"X-B3-SpanId":Nt(e),"X-B3-Sampled":n?"1":"0"});break}}}),a.propagateTraceBaggage){const c={"session.id":r},d=s.getContext().id;typeof d=="string"&&(c["user.id"]=d);const l=o.getContext().id;typeof l=="string"&&(c["account.id"]=l);const f=Object.entries(c).map(([p,h])=>`${p}=${encodeURIComponent(h)}`).join(",");f&&(u.baggage=f)}return u}const us=["tracecontext","datadog"];function Uu(t){var e,n,r,i,s,o,a;if(t.trackFeatureFlagsForEvents!==void 0&&!Array.isArray(t.trackFeatureFlagsForEvents)&&w.warn("trackFeatureFlagsForEvents should be an array"),!t.applicationId){w.error("Application ID is not configured, no RUM data will be collected.");return}if(!Vt(t.sessionReplaySampleRate,"Session Replay")||!Vt(t.traceSampleRate,"Trace"))return;if(t.excludedActivityUrls!==void 0&&!Array.isArray(t.excludedActivityUrls)){w.error("Excluded Activity Urls should be an array");return}const u=Vu(t);if(!u)return;const c=bc(t);if(!c)return;const d=(e=t.sessionReplaySampleRate)!==null&&e!==void 0?e:0;return{applicationId:t.applicationId,actionNameAttribute:t.actionNameAttribute,sessionReplaySampleRate:d,startSessionReplayRecordingManually:t.startSessionReplayRecordingManually!==void 0?!!t.startSessionReplayRecordingManually:d===0,traceSampleRate:(n=t.traceSampleRate)!==null&&n!==void 0?n:100,rulePsr:he(t.traceSampleRate)?t.traceSampleRate/100:void 0,allowedTracingUrls:u,excludedActivityUrls:(r=t.excludedActivityUrls)!==null&&r!==void 0?r:[],workerUrl:t.workerUrl,compressIntakeRequests:!!t.compressIntakeRequests,trackUserInteractions:!!(!((i=t.trackUserInteractions)!==null&&i!==void 0)||i),trackViewsManually:!!t.trackViewsManually,trackResources:!!(!((s=t.trackResources)!==null&&s!==void 0)||s),trackLongTasks:!!(!((o=t.trackLongTasks)!==null&&o!==void 0)||o),trackBfcacheViews:!!t.trackBfcacheViews,subdomain:t.subdomain,defaultPrivacyLevel:Pe(oe,t.defaultPrivacyLevel)?t.defaultPrivacyLevel:oe.MASK,enablePrivacyForActionName:!!t.enablePrivacyForActionName,customerDataTelemetrySampleRate:1,initialViewMetricsTelemetrySampleRate:1,replayTelemetrySampleRate:1,traceContextInjection:Pe(Mn,t.traceContextInjection)?t.traceContextInjection:Mn.SAMPLED,plugins:t.plugins||[],trackFeatureFlagsForEvents:t.trackFeatureFlagsForEvents||[],profilingSampleRate:(a=t.profilingSampleRate)!==null&&a!==void 0?a:0,propagateTraceBaggage:!!t.propagateTraceBaggage,...c}}function Vu(t){if(t.allowedTracingUrls===void 0)return[];if(!Array.isArray(t.allowedTracingUrls)){w.error("Allowed Tracing URLs should be an array");return}if(t.allowedTracingUrls.length!==0&&t.service===void 0){w.error("Service needs to be configured when tracing is enabled");return}const e=[];return t.allowedTracingUrls.forEach(n=>{qn(n)?e.push({match:n,propagatorTypes:us}):Lu(n)?e.push(n):w.warn("Allowed Tracing Urls parameters should be a string, RegExp, function, or an object. Ignoring parameter",n)}),e}function Fu(t){const e=new Set;return Array.isArray(t.allowedTracingUrls)&&t.allowedTracingUrls.length>0&&t.allowedTracingUrls.forEach(n=>{qn(n)?us.forEach(r=>e.add(r)):xt(n)==="object"&&Array.isArray(n.propagatorTypes)&&n.propagatorTypes.forEach(r=>e.add(r))}),Array.from(e)}function Bu(t){var e;const n=yc(t);return{session_replay_sample_rate:t.sessionReplaySampleRate,start_session_replay_recording_manually:t.startSessionReplayRecordingManually,trace_sample_rate:t.traceSampleRate,trace_context_injection:t.traceContextInjection,action_name_attribute:t.actionNameAttribute,use_allowed_tracing_urls:Array.isArray(t.allowedTracingUrls)&&t.allowedTracingUrls.length>0,selected_tracing_propagators:Fu(t),default_privacy_level:t.defaultPrivacyLevel,enable_privacy_for_action_name:t.enablePrivacyForActionName,use_excluded_activity_urls:Array.isArray(t.excludedActivityUrls)&&t.excludedActivityUrls.length>0,use_worker_url:!!t.workerUrl,compress_intake_requests:t.compressIntakeRequests,track_views_manually:t.trackViewsManually,track_user_interactions:t.trackUserInteractions,track_resources:t.trackResources,track_long_task:t.trackLongTasks,track_bfcache_views:t.trackBfcacheViews,plugins:(e=t.plugins)===null||e===void 0?void 0:e.map(r=>{var i;return{name:r.name,...(i=r.getConfigurationTelemetry)===null||i===void 0?void 0:i.call(r)}}),track_feature_flags_for_events:t.trackFeatureFlagsForEvents,...n}}const zu="v1",$u=["applicationId","service","env","version","sessionSampleRate","sessionReplaySampleRate","defaultPrivacyLevel","enablePrivacyForActionName","traceSampleRate","trackSessionAcrossSubdomains","allowedTracingUrls","allowedTrackingOrigins"];async function Gu(t){const e=await qu(t);if(!e.ok){w.error(e.error);return}return Hu(t,e.value)}function Hu(t,e){const n={...t};return $u.forEach(r=>{r in e&&(n[r]=Pn(e[r]))}),n}function Pn(t){if(Array.isArray(t))return t.map(Pn);if(Wu(t)){if(Ku(t)){const e=t.rcSerializedType;switch(e){case"string":return t.value;case"regex":return ju(t.value);default:w.error(`Unsupported remote configuration: "rcSerializedType": "${e}"`);return}}return ri(t,Pn)}return t}function Wu(t){return typeof t=="object"&&t!==null}function Ku(t){return"rcSerializedType"in t}function ju(t){try{return new RegExp(t)}catch{w.error(`Invalid regex in the remote configuration: '${t}'`)}}async function qu(t){let e;try{e=await fetch(Yu(t))}catch{e=void 0}if(!e||!e.ok)return{ok:!1,error:new Error("Error fetching the remote configuration.")};const n=await e.json();return n.rum?{ok:!0,value:n.rum}:{ok:!1,error:new Error("No remote configuration for RUM.")}}function Yu(t){return t.remoteConfigurationProxy?t.remoteConfigurationProxy:`https://sdk-configuration.${$i("rum",t)}/${zu}/${encodeURIComponent(t.remoteConfigurationId)}.json`}function Xu({ignoreInitIfSyntheticsWillInjectRum:t=!0,startDeflateWorker:e},n,r,i){const s=mu(),o=Qi();En(o,U.globalContext,s);const a=ts();En(a,U.userContext,s);const u=Zi();En(u,U.accountContext,s);let c,d,l,f;const p=n.observable.subscribe(m),h={};function m(){if(!l||!f||!n.isGranted())return;p.unsubscribe();let g;if(f.trackViewsManually){if(!c)return;s.remove(c.callback),g=c.options}const S=i(f,d,g);s.drain(S)}function b(g){const S=Wt();if(S&&(g=Ju(g)),l=g,Ka(Bu(g)),f){Gi("DD_RUM",g);return}const k=Uu(g);if(k){if(!S&&!k.sessionStoreStrategyType){w.warn("No storage available for session. We will not send any data.");return}k.compressIntakeRequests&&!S&&e&&(d=e(k,"Datadog RUM",x),!d)||(f=k,Ji().subscribe(x),n.tryToInit(k.trackingConsent),m())}}const R=g=>{s.add(S=>S.addDurationVital(g))};return{init(g,S){if(!g){w.error("Missing configuration");return}pa(g.enableExperimentalFeatures),l=g,!(t&&ji())&&(ss(g.plugins,"onInit",{initConfiguration:g,publicApi:S}),g.remoteConfigurationId?Gu(g).then(k=>{k&&b(k)}).catch($t):b(g))},get initConfiguration(){return l},getInternalContext:x,stopSession:x,addTiming(g,S=V()){s.add(k=>k.addTiming(g,S))},startView(g,S=F()){const k=_=>{_.startView(g,S)};s.add(k),c||(c={options:g,callback:k},m())},setViewName(g){s.add(S=>S.setViewName(g))},setViewContext(g){s.add(S=>S.setViewContext(g))},setViewContextProperty(g,S){s.add(k=>k.setViewContextProperty(g,S))},getViewContext:()=>h,globalContext:o,userContext:a,accountContext:u,addAction(g){s.add(S=>S.addAction(g))},addError(g){s.add(S=>S.addError(g))},addFeatureFlagEvaluation(g,S){s.add(k=>k.addFeatureFlagEvaluation(g,S))},startDurationVital(g,S){return rs(r,g,S)},stopDurationVital(g,S){is(R,r,g,S)},addDurationVital:R}}function Ju(t){var e,n;return{...t,applicationId:"00000000-aaaa-0000-aaaa-000000000000",clientToken:"empty",sessionSampleRate:100,defaultPrivacyLevel:(e=t.defaultPrivacyLevel)!==null&&e!==void 0?e:(n=be())===null||n===void 0?void 0:n.getPrivacyLevel()}}function En(t,e,n){t.changeObservable.subscribe(()=>{const r=t.getContext();n.add(i=>i[e].setContext(r))})}function Zu(t,e,n,r={}){const i=rc(),s=Cu(),o=Iu().observable;let a=Xu(r,i,s,(l,f,p)=>{const h=t(l,e,n,p,f&&r.createDeflateEncoder?m=>r.createDeflateEncoder(l,f,m):jc,i,s,o,r.sdkName);return e.onRumStart(h.lifeCycle,l,h.session,h.viewHistory,f,h.telemetry),n.onRumStart(h.lifeCycle,h.hooks,l,h.session,h.viewHistory),a=Qu(a,h),ss(l.plugins,"onRumStart",{strategy:a,addEvent:h.addEvent}),h});const u=()=>a,c=y(l=>{const f=typeof l=="object"?l:{name:l};a.startView(f),W({feature:"start-view"})}),d=Rc({init:y(l=>{a.init(l,d)}),setTrackingConsent:y(l=>{i.update(l),W({feature:"set-tracking-consent",tracking_consent:l})}),setViewName:y(l=>{a.setViewName(l),W({feature:"set-view-name"})}),setViewContext:y(l=>{a.setViewContext(l),W({feature:"set-view-context"})}),setViewContextProperty:y((l,f)=>{a.setViewContextProperty(l,f),W({feature:"set-view-context-property"})}),getViewContext:y(()=>(W({feature:"set-view-context-property"}),a.getViewContext())),getInternalContext:y(l=>a.getInternalContext(l)),getInitConfiguration:y(()=>Wn(a.initConfiguration)),addAction:(l,f)=>{const p=Ue("action");Tt(()=>{a.addAction({name:L(l),context:L(f),startClocks:F(),type:er.CUSTOM,handlingStack:p}),W({feature:"add-action"})})},addError:(l,f)=>{const p=Ue("error");Tt(()=>{a.addError({error:l,handlingStack:p,context:L(f),startClocks:F()}),W({feature:"add-error"})})},addTiming:y((l,f)=>{a.addTiming(L(l),f)}),setGlobalContext:G(u,U.globalContext,H.setContext,"set-global-context"),getGlobalContext:G(u,U.globalContext,H.getContext,"get-global-context"),setGlobalContextProperty:G(u,U.globalContext,H.setContextProperty,"set-global-context-property"),removeGlobalContextProperty:G(u,U.globalContext,H.removeContextProperty,"remove-global-context-property"),clearGlobalContext:G(u,U.globalContext,H.clearContext,"clear-global-context"),setUser:G(u,U.userContext,H.setContext,"set-user"),getUser:G(u,U.userContext,H.getContext,"get-user"),setUserProperty:G(u,U.userContext,H.setContextProperty,"set-user-property"),removeUserProperty:G(u,U.userContext,H.removeContextProperty,"remove-user-property"),clearUser:G(u,U.userContext,H.clearContext,"clear-user"),setAccount:G(u,U.accountContext,H.setContext,"set-account"),getAccount:G(u,U.accountContext,H.getContext,"get-account"),setAccountProperty:G(u,U.accountContext,H.setContextProperty,"set-account-property"),removeAccountProperty:G(u,U.accountContext,H.removeContextProperty,"remove-account-property"),clearAccount:G(u,U.accountContext,H.clearContext,"clear-account"),startView:c,stopSession:y(()=>{a.stopSession(),W({feature:"stop-session"})}),addFeatureFlagEvaluation:y((l,f)=>{a.addFeatureFlagEvaluation(L(l),L(f)),W({feature:"add-feature-flag-evaluation"})}),getSessionReplayLink:y(()=>e.getSessionReplayLink()),startSessionReplayRecording:y(l=>{e.start(l),W({feature:"start-session-replay-recording",force:l&&l.force})}),stopSessionReplayRecording:y(()=>e.stop()),addDurationVital:y((l,f)=>{W({feature:"add-duration-vital"}),a.addDurationVital({name:L(l),type:ns.DURATION,startClocks:po(f.startTime),duration:f.duration,context:L(f&&f.context),description:L(f&&f.description)})}),startDurationVital:y((l,f)=>(W({feature:"start-duration-vital"}),a.startDurationVital(L(l),{context:L(f&&f.context),description:L(f&&f.description)}))),stopDurationVital:y((l,f)=>{W({feature:"stop-duration-vital"}),a.stopDurationVital(typeof l=="string"?L(l):l,{context:L(f&&f.context),description:L(f&&f.description)})})});return d}function Qu(t,e){return{init:n=>{Gi("DD_RUM",n)},initConfiguration:t.initConfiguration,...e}}function tl(){const t=el();return new T(e=>{if(!t)return;const n=new t(y(r=>e.notify(r)));return n.observe(document,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),()=>n.disconnect()})}function el(){let t;const e=window;if(e.Zone&&(t=pt(e,"MutationObserver"),e.MutationObserver&&t===e.MutationObserver)){const n=new e.MutationObserver(x),r=pt(n,"originalInstance");t=r&&r.constructor}return t||(t=e.MutationObserver),t}function nl(){const t=new T,{stop:e}=rt(window,"open",()=>t.notify());return{observable:t,stop:e}}function rl(t,e,n,r,i){return{get:s=>{const o=n.findView(s),a=i.findUrl(s),u=e.findTrackedSession(s);if(u&&o&&a){const c=r.findActionId(s);return{application_id:t,session_id:u.id,user_action:c?{id:c}:void 0,view:{id:o.id,name:o.name,referrer:a.referrer,url:a.url}}}}}}const il=qc,sl=Ct;function ol(t){const e=Jt({expireDelay:sl});t.subscribe(1,r=>{e.add(n(r),r.startClocks.relative)}),t.subscribe(6,({endClocks:r})=>{e.closeActive(r.relative)}),t.subscribe(3,r=>{const i=e.find(r.startClocks.relative);i&&(r.name&&(i.name=r.name),r.context&&(i.context=r.context),i.sessionIsActive=r.sessionIsActive)}),t.subscribe(10,()=>{e.reset()});function n(r){return{service:r.service,version:r.version,context:r.context,id:r.id,name:r.name,startClocks:r.startClocks}}return{findView:r=>e.find(r),stop:()=>{e.stop()}}}const ls="initial_document",al=[[K.DOCUMENT,t=>ls===t],[K.XHR,t=>t==="xmlhttprequest"],[K.FETCH,t=>t==="fetch"],[K.BEACON,t=>t==="beacon"],[K.CSS,(t,e)=>/\.css$/i.test(e)],[K.JS,(t,e)=>/\.js$/i.test(e)],[K.IMAGE,(t,e)=>["image","img","icon"].includes(t)||/\.(gif|jpg|jpeg|tiff|png|svg|ico)$/i.exec(e)!==null],[K.FONT,(t,e)=>/\.(woff|eot|woff2|ttf)$/i.exec(e)!==null],[K.MEDIA,(t,e)=>["audio","video"].includes(t)||/\.(mp3|mp4)$/i.exec(e)!==null]];function cl(t){const e=t.name;if(!cc(e))return _t(`Failed to construct URL for "${t.name}"`),K.OTHER;const n=uc(e);for(const[r,i]of al)if(i(t.initiatorType,n))return r;return K.OTHER}function Sr(...t){for(let e=1;e<t.length;e+=1)if(t[e-1]>t[e])return!1;return!0}function ds(t){return t.initiatorType==="xmlhttprequest"||t.initiatorType==="fetch"}function ul(t){const{duration:e,startTime:n,responseEnd:r}=t;return e===0&&n<r?N(n,r):e}function ll(t){if(!hs(t))return;const{startTime:e,fetchStart:n,workerStart:r,redirectStart:i,redirectEnd:s,domainLookupStart:o,domainLookupEnd:a,connectStart:u,secureConnectionStart:c,connectEnd:d,requestStart:l,responseStart:f,responseEnd:p}=t,h={download:yt(e,f,p),first_byte:yt(e,l,f)};return 0<r&&r<n&&(h.worker=yt(e,r,n)),n<d&&(h.connect=yt(e,u,d),u<=c&&c<=d&&(h.ssl=yt(e,c,d))),n<a&&(h.dns=yt(e,o,a)),e<s&&(h.redirect=yt(e,i,s)),h}function fs(t){return t.duration>=0}function hs(t){const e=Sr(t.startTime,t.fetchStart,t.domainLookupStart,t.domainLookupEnd,t.connectStart,t.connectEnd,t.requestStart,t.responseStart,t.responseEnd),n=dl(t)?Sr(t.startTime,t.redirectStart,t.redirectEnd,t.fetchStart):!0;return e&&n}function dl(t){return t.redirectEnd>t.startTime}function yt(t,e,n){if(t<=e&&e<=n)return{duration:v(N(e,n)),start:v(N(t,e))}}function fl(t){return t.nextHopProtocol===""?void 0:t.nextHopProtocol}function hl(t){return t.deliveryType===""?"other":t.deliveryType}function pl(t){if(t.startTime<t.responseStart){const{encodedBodySize:e,decodedBodySize:n,transferSize:r}=t;return{size:n,encoded_body_size:e,decoded_body_size:n,transfer_size:r}}return{size:void 0,encoded_body_size:void 0,decoded_body_size:void 0,transfer_size:void 0}}function nr(t){return t&&(!gc(t)||We(It.TRACK_INTAKE_REQUESTS))}const ml=/data:(.+)?(;base64)?,/g,gl=24e3;function _l(t,e=gl){if(t.length<=e||!t.startsWith("data:"))return t;const n=t.substring(0,100).match(ml);return n?`${n[0]}[...]`:t}let wr=1;function bl(t,e,n,r,i){const s=Pu(e,n,r,i);yl(t,e,s),vl(t,s)}function yl(t,e,n){const r=Xc(e).subscribe(i=>{const s=i;if(nr(s.url))switch(s.state){case"start":n.traceXhr(s,s.xhr),s.requestIndex=ps(),t.notify(7,{requestIndex:s.requestIndex,url:s.url});break;case"complete":n.clearTracingIfNeeded(s),t.notify(8,{duration:s.duration,method:s.method,requestIndex:s.requestIndex,spanId:s.spanId,startClocks:s.startClocks,status:s.status,traceId:s.traceId,traceSampled:s.traceSampled,type:je.XHR,url:s.url,xhr:s.xhr,isAborted:s.isAborted,handlingStack:s.handlingStack});break}});return{stop:()=>r.unsubscribe()}}function vl(t,e){const n=Ji().subscribe(r=>{const i=r;if(nr(i.url))switch(i.state){case"start":e.traceFetch(i),i.requestIndex=ps(),t.notify(7,{requestIndex:i.requestIndex,url:i.url});break;case"resolve":El(i,s=>{e.clearTracingIfNeeded(i),t.notify(8,{duration:s,method:i.method,requestIndex:i.requestIndex,responseType:i.responseType,spanId:i.spanId,startClocks:i.startClocks,status:i.status,traceId:i.traceId,traceSampled:i.traceSampled,type:je.FETCH,url:i.url,response:i.response,init:i.init,input:i.input,isAborted:i.isAborted,handlingStack:i.handlingStack})});break}});return{stop:()=>n.unsubscribe()}}function ps(){const t=wr;return wr+=1,t}function El(t,e){const n=t.response&&Ta(t.response);!n||!n.body?e(N(t.startClocks.timeStamp,V())):wu(n.body,()=>{e(N(t.startClocks.timeStamp,V()))},{bytesLimit:Number.POSITIVE_INFINITY})}function ms(t){return he(t)&&t<0?void 0:t}function gs({lifeCycle:t,isChildEvent:e,onChange:n=x}){const r={errorCount:0,longTaskCount:0,resourceCount:0,actionCount:0,frustrationCount:0},i=t.subscribe(13,s=>{var o;if(!(s.type==="view"||s.type==="vital"||!e(s)))switch(s.type){case E.ERROR:r.errorCount+=1,n();break;case E.ACTION:r.actionCount+=1,s.action.frustration&&(r.frustrationCount+=s.action.frustration.type.length),n();break;case E.LONG_TASK:r.longTaskCount+=1,n();break;case E.RESOURCE:!((o=s._dd)===null||o===void 0)&&o.discarded||(r.resourceCount+=1,n());break}});return{stop:()=>{i.unsubscribe()},eventCounts:r}}function Sl(t,e){const n=tt();let r=!1;const{stop:i}=mt(t,window,["click","mousedown","keydown","touchstart","pointerdown"],a=>{if(!a.cancelable)return;const u={entryType:"first-input",processingStart:Y(),processingEnd:Y(),startTime:a.timeStamp,duration:0,name:"",cancelable:!1,target:null,toJSON:()=>({})};a.type==="pointerdown"?s(t,u):o(u)},{passive:!0,capture:!0});return{stop:i};function s(a,u){mt(a,window,["pointerup","pointercancel"],c=>{c.type==="pointerup"&&o(u)},{once:!0})}function o(a){if(!r){r=!0,i();const u=a.processingStart-a.startTime;u>=0&&u<tt()-n&&e(a)}}}var I;(function(t){t.EVENT="event",t.FIRST_INPUT="first-input",t.LARGEST_CONTENTFUL_PAINT="largest-contentful-paint",t.LAYOUT_SHIFT="layout-shift",t.LONG_TASK="longtask",t.LONG_ANIMATION_FRAME="long-animation-frame",t.NAVIGATION="navigation",t.PAINT="paint",t.RESOURCE="resource",t.VISIBILITY_STATE="visibility-state"})(I||(I={}));function it(t,e){return new T(n=>{if(!window.PerformanceObserver)return;const r=u=>{const c=Il(u);c.length>0&&n.notify(c)};let i,s=!0;const o=new PerformanceObserver(y(u=>{s?i=B(()=>r(u.getEntries())):r(u.getEntries())}));try{o.observe(e)}catch{if([I.RESOURCE,I.NAVIGATION,I.LONG_TASK,I.PAINT].includes(e.type)){e.buffered&&(i=B(()=>r(performance.getEntriesByType(e.type))));try{o.observe({entryTypes:[e.type]})}catch{return}}}s=!1,wl(t);let a;return!kt(I.FIRST_INPUT)&&e.type===I.FIRST_INPUT&&({stop:a}=Sl(t,u=>{r([u])})),()=>{o.disconnect(),a&&a(),Q(i)}})}let ne;function wl(t){return!ne&&Tl()&&"addEventListener"in performance&&(ne=O(t,performance,"resourcetimingbufferfull",()=>{performance.clearResourceTimings()})),()=>{ne?.stop()}}function Tl(){return window.performance!==void 0&&"getEntries"in performance}function kt(t){return window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes!==void 0&&PerformanceObserver.supportedEntryTypes.includes(t)}function Il(t){return t.filter(e=>!Al(e))}function Al(t){return t.entryType===I.RESOURCE&&(!nr(t.name)||!fs(t))}function _s(t){return t.nodeType===Node.TEXT_NODE}function Cl(t){return t.nodeType===Node.COMMENT_NODE}function lt(t){return t.nodeType===Node.ELEMENT_NODE}function bs(t){return lt(t)&&!!t.shadowRoot}function Rl(t){const e=t;return!!e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&lt(e.host)}function bp(t){return t.childNodes.length>0||bs(t)}function yp(t,e){let n=t.firstChild;for(;n;)e(n),n=n.nextSibling;bs(t)&&e(t.shadowRoot)}function xl(t){return Rl(t)?t.host:t.parentNode}const ys=100,kl=100,Tr="data-dd-excluded-activity-mutations";function rr(t,e,n,r,i,s){const o=Nl(t,e,n,r);return Ol(o,i,s)}function Ol(t,e,n){let r,i=!1;const s=B(y(()=>c({hadActivity:!1})),ys),o=n!==void 0?B(y(()=>c({hadActivity:!0,end:V()})),n):void 0,a=t.subscribe(({isBusy:d})=>{Q(s),Q(r);const l=V();d||(r=B(y(()=>c({hadActivity:!0,end:l})),kl))}),u=()=>{i=!0,Q(s),Q(r),Q(o),a.unsubscribe()};function c(d){i||(u(),e(d))}return{stop:u}}function Nl(t,e,n,r){return new T(i=>{const s=[];let o,a=0;return s.push(e.subscribe(c=>{c.every(Ll)||u()}),n.subscribe(u),it(r,{type:I.RESOURCE}).subscribe(c=>{c.some(d=>!Sn(r,d.name))&&u()}),t.subscribe(7,c=>{Sn(r,c.url)||(o===void 0&&(o=c.requestIndex),a+=1,u())}),t.subscribe(8,c=>{Sn(r,c.url)||o===void 0||c.requestIndex<o||(a-=1,u())})),()=>{s.forEach(c=>c.unsubscribe())};function u(){i.notify({isBusy:a>0})}})}function Sn(t,e){return Yn(t.excludedActivityUrls,e)}function Ll(t){const e=t.type==="characterData"?t.target.parentElement:t.target;return!!(e&&lt(e)&&e.matches(`[${Tr}], [${Tr}] *`))}const C={IGNORE:"ignore",HIDDEN:"hidden",ALLOW:oe.ALLOW,MASK:oe.MASK,MASK_USER_INPUT:oe.MASK_USER_INPUT},Ml="data-dd-privacy",vp="hidden",Pl="dd-privacy-",wn="***",Ep="data:image/gif;base64,R0lGODlhAQABAIAAAMLCwgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==",Dl={INPUT:!0,OUTPUT:!0,TEXTAREA:!0,SELECT:!0,OPTION:!0,DATALIST:!0,OPTGROUP:!0},Ul="x";function vs(t,e,n){if(n&&n.has(t))return n.get(t);const r=xl(t),i=r?vs(r,e,n):e,s=Es(t),o=Vl(s,i);return n&&n.set(t,o),o}function Vl(t,e){switch(e){case C.HIDDEN:case C.IGNORE:return e}switch(t){case C.ALLOW:case C.MASK:case C.MASK_USER_INPUT:case C.HIDDEN:case C.IGNORE:return t;default:return e}}function Es(t){if(lt(t)){if(t.tagName==="BASE")return C.ALLOW;if(t.tagName==="INPUT"){const e=t;if(e.type==="password"||e.type==="email"||e.type==="tel"||e.type==="hidden")return C.MASK;const n=e.getAttribute("autocomplete");if(n&&(n.startsWith("cc-")||n.endsWith("-password")))return C.MASK}if(t.matches(Ft(C.HIDDEN)))return C.HIDDEN;if(t.matches(Ft(C.MASK)))return C.MASK;if(t.matches(Ft(C.MASK_USER_INPUT)))return C.MASK_USER_INPUT;if(t.matches(Ft(C.ALLOW)))return C.ALLOW;if(Bl(t))return C.IGNORE}}function Ss(t,e){switch(e){case C.MASK:case C.HIDDEN:case C.IGNORE:return!0;case C.MASK_USER_INPUT:return _s(t)?Ir(t.parentNode):Ir(t);default:return!1}}function Ir(t){if(!t||t.nodeType!==t.ELEMENT_NODE)return!1;const e=t;if(e.tagName==="INPUT")switch(e.type){case"button":case"color":case"reset":case"submit":return!1}return!!Dl[e.tagName]}const Fl=t=>t.replace(/\S/g,Ul);function Sp(t,e,n){var r;const i=(r=t.parentElement)===null||r===void 0?void 0:r.tagName;let s=t.textContent||"";if(e&&!s.trim())return;const o=n;if(i==="SCRIPT")s=wn;else if(o===C.HIDDEN)s=wn;else if(Ss(t,o))if(i==="DATALIST"||i==="SELECT"||i==="OPTGROUP"){if(!s.trim())return}else i==="OPTION"?s=wn:s=Fl(s);return s}function Bl(t){if(t.nodeName==="SCRIPT")return!0;if(t.nodeName==="LINK"){const n=e("rel");return/preload|prefetch/i.test(n)&&e("as")==="script"||n==="shortcut icon"||n==="icon"}if(t.nodeName==="META"){const n=e("name"),r=e("rel"),i=e("property");return/^msapplication-tile(image|color)$/.test(n)||n==="application-name"||r==="icon"||r==="apple-touch-icon"||r==="shortcut icon"||n==="keywords"||n==="description"||/^(og|twitter|fb):/.test(i)||/^(og|twitter):/.test(n)||n==="pinterest"||n==="robots"||n==="googlebot"||n==="bingbot"||t.hasAttribute("http-equiv")||n==="author"||n==="generator"||n==="framework"||n==="publisher"||n==="progid"||/^article:/.test(i)||/^product:/.test(i)||n==="google-site-verification"||n==="yandex-verification"||n==="csrf-token"||n==="p:domain_verify"||n==="verify-v1"||n==="verification"||n==="shopify-checkout-api-token"}function e(n){return(t.getAttribute(n)||"").toLowerCase()}return!1}function Ft(t){return`[${Ml}="${t}"], .${Pl}${t}`}const qe="data-dd-action-name",zl="Masked Element";function $l(t,{enablePrivacyForActionName:e,actionNameAttribute:n},r=C.ALLOW){const i=Ar(t,qe)||n&&Ar(t,n);return i?{name:i,nameSource:"custom_attribute"}:r===C.MASK?{name:zl,nameSource:"mask_placeholder"}:Cr(t,n,Gl,e)||Cr(t,n,Hl,e)||{name:"",nameSource:"blank"}}function Ar(t,e){const n=t.closest(`[${e}]`);if(!n)return;const r=n.getAttribute(e);return Ts(ws(r.trim()))}const Gl=[(t,e,n)=>{if("labels"in t&&t.labels&&t.labels.length>0)return Le(t.labels[0],e,n)},t=>{if(t.nodeName==="INPUT"){const e=t,n=e.getAttribute("type");if(n==="button"||n==="submit"||n==="reset")return{name:e.value,nameSource:"text_content"}}},(t,e,n)=>{if(t.nodeName==="BUTTON"||t.nodeName==="LABEL"||t.getAttribute("role")==="button")return Le(t,e,n)},t=>re(t,"aria-label"),(t,e,n)=>{const r=t.getAttribute("aria-labelledby");if(r)return{name:r.split(/\s+/).map(i=>Kl(t,i)).filter(i=>!!i).map(i=>Is(i,e,n)).join(" "),nameSource:"text_content"}},t=>re(t,"alt"),t=>re(t,"name"),t=>re(t,"title"),t=>re(t,"placeholder"),(t,e,n)=>{if("options"in t&&t.options.length>0)return Le(t.options[0],e,n)}],Hl=[(t,e,n)=>Le(t,e,n)],Wl=10;function Cr(t,e,n,r){let i=t,s=0;for(;s<=Wl&&i&&i.nodeName!=="BODY"&&i.nodeName!=="HTML"&&i.nodeName!=="HEAD";){for(const o of n){const a=o(i,e,r);if(a){const{name:u,nameSource:c}=a,d=u&&u.trim();if(d)return{name:Ts(ws(d)),nameSource:c}}}if(i.nodeName==="FORM")break;i=i.parentElement,s+=1}}function ws(t){return t.replace(/\s+/g," ")}function Ts(t){return t.length>100?`${ai(t,100)} [...]`:t}function Kl(t,e){return t.ownerDocument?t.ownerDocument.getElementById(e):null}function re(t,e){return{name:t.getAttribute(e)||"",nameSource:"standard_attribute"}}function Le(t,e,n){return{name:Is(t,e,n)||"",nameSource:"text_content"}}function Is(t,e,n){if(!t.isContentEditable){if(We(It.USE_TREE_WALKER_FOR_ACTION_NAME))return jl(t,e,n);if("innerText"in t){let r=t.innerText;const i=s=>{const o=t.querySelectorAll(s);for(let a=0;a<o.length;a+=1){const u=o[a];if("innerText"in u){const c=u.innerText;c&&c.trim().length>0&&(r=r.replace(c,""))}}};return i(`[${qe}]`),e&&i(`[${e}]`),n&&i(`${Ft(C.HIDDEN)}, ${Ft(C.MASK)}`),r}return t.textContent}}function jl(t,e,n){const r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,s);let i="";for(;r.nextNode();){const o=r.currentNode;if(lt(o)){(o.nodeName==="BR"||o.nodeName==="P"||["block","flex","grid","list-item","table","table-caption"].includes(getComputedStyle(o).display))&&(i+=" ");continue}i+=o.textContent||""}return i.replace(/\s+/g," ").trim();function s(o){if(lt(o)){const a=Es(o);if(o.hasAttribute(qe)||e&&o.hasAttribute(e)||n&&a&&Ss(o,a))return NodeFilter.FILTER_REJECT;const u=getComputedStyle(o);if(u.visibility!=="visible"||u.display==="none"||u.contentVisibility&&u.contentVisibility!=="visible")return NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT}}const ql=[qe,"data-testid","data-test","data-qa","data-cy","data-test-id","data-qa-id","data-testing","data-component","data-element","data-source-file"],Yl=[Cs,Jl],Xl=[Cs,Zl,Ql];function ye(t,e){if(!t.isConnected)return;let n,r=t;for(;r&&r.nodeName!=="HTML";){const i=Rr(r,Yl,ed,e,n);if(i)return i;n=Rr(r,Xl,nd,e,n)||Ye(td(r),n),r=r.parentElement}return n}function As(t){return/[0-9]/.test(t)}function Jl(t){if(t.id&&!As(t.id))return`#${CSS.escape(t.id)}`}function Zl(t){if(t.tagName==="BODY")return;const e=t.classList;for(let n=0;n<e.length;n+=1){const r=e[n];if(!As(r))return`${CSS.escape(t.tagName)}.${CSS.escape(r)}`}}function Ql(t){return CSS.escape(t.tagName)}function Cs(t,e){if(e){const r=n(e);if(r)return r}for(const r of ql){const i=n(r);if(i)return i}function n(r){if(t.hasAttribute(r))return`${CSS.escape(t.tagName)}[${r}="${CSS.escape(t.getAttribute(r))}"]`}}function td(t){let e=t.parentElement.firstElementChild,n=1;for(;e&&e!==t;)e.tagName===t.tagName&&(n+=1),e=e.nextElementSibling;return`${CSS.escape(t.tagName)}:nth-of-type(${n})`}function Rr(t,e,n,r,i){for(const s of e){const o=s(t,r);if(o&&n(t,o,i))return Ye(o,i)}}function ed(t,e,n){return t.ownerDocument.querySelectorAll(Ye(e,n)).length===1}function nd(t,e,n){let r;if(n===void 0)r=o=>o.matches(e);else{const o=Ye(`${e}:scope`,n);r=a=>a.querySelector(o)!==null}let s=t.parentElement.firstElementChild;for(;s;){if(s!==t&&r(s))return!1;s=s.nextElementSibling}return!0}function Ye(t,e){return e?`${t}>${e}`:t}const Rs=z,rd=100;function id(t,e){const n=[];let r=0,i;s(t);function s(u){u.stopObservable.subscribe(o),n.push(u),Q(i),i=B(a,Rs)}function o(){r===1&&n.every(u=>u.isStopped())&&(r=2,e(n))}function a(){Q(i),r===0&&(r=1,o())}return{tryAppend:u=>r!==0?!1:n.length>0&&!sd(n[n.length-1].event,u.event)?(a(),!1):(s(u),!0),stop:()=>{a()}}}function sd(t,e){return t.target===e.target&&od(t,e)<=rd&&t.timeStamp-e.timeStamp<=Rs}function od(t,e){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))}function ad(t,{onPointerDown:e,onPointerUp:n}){let r,i={selection:!1,input:!1,scroll:!1},s;const o=[O(t,window,"pointerdown",a=>{kr(a)&&(r=xr(),i={selection:!1,input:!1,scroll:!1},s=e(a))},{capture:!0}),O(t,window,"selectionchange",()=>{(!r||!xr())&&(i.selection=!0)},{capture:!0}),O(t,window,"scroll",()=>{i.scroll=!0},{capture:!0,passive:!0}),O(t,window,"pointerup",a=>{if(kr(a)&&s){const u=i;n(s,a,()=>u),s=void 0}},{capture:!0}),O(t,window,"input",()=>{i.input=!0},{capture:!0})];return{stop:()=>{o.forEach(a=>a.stop())}}}function xr(){const t=window.getSelection();return!t||t.isCollapsed}function kr(t){return t.target instanceof Element&&t.isPrimary!==!1}const Or=3;function cd(t,e){if(ud(t))return e.addFrustration(ee.RAGE_CLICK),t.some(Nr)&&e.addFrustration(ee.DEAD_CLICK),e.hasError&&e.addFrustration(ee.ERROR_CLICK),{isRage:!0};const n=t.some(r=>r.getUserActivity().selection);return t.forEach(r=>{r.hasError&&r.addFrustration(ee.ERROR_CLICK),Nr(r)&&!n&&r.addFrustration(ee.DEAD_CLICK)}),{isRage:!1}}function ud(t){if(t.some(e=>e.getUserActivity().selection||e.getUserActivity().scroll))return!1;for(let e=0;e<t.length-(Or-1);e+=1)if(t[e+Or-1].event.timeStamp-t[e].event.timeStamp<=z)return!0;return!1}const ld='input:not([type="checkbox"]):not([type="radio"]):not([type="button"]):not([type="submit"]):not([type="reset"]):not([type="range"]),textarea,select,[contenteditable],[contenteditable] *,canvas,a[href],a[href] *';function Nr(t){if(t.hasPageActivity||t.getUserActivity().input||t.getUserActivity().scroll)return!1;let e=t.event.target;return e.tagName==="LABEL"&&e.hasAttribute("for")&&(e=document.getElementById(e.getAttribute("for"))),!e||!e.matches(ld)}const xs=10*z,ae=new Map;function dd(t){const e=ae.get(t);return ae.delete(t),e}function ks(t,e){ae.set(t,e),ae.forEach((n,r)=>{N(r,Y())>xs&&ae.delete(r)})}const fd=5*j;function hd(t,e,n,r){const i=Jt({expireDelay:fd}),s=new T;let o;t.subscribe(10,()=>{i.reset()}),t.subscribe(5,d),t.subscribe(11,l=>{l.reason===Bt.UNLOADING&&d()});const{stop:a}=ad(r,{onPointerDown:l=>pd(r,t,e,l,n),onPointerUp:({clickActionBase:l,hadActivityOnPointerDown:f},p,h)=>{md(r,t,e,n,i,s,c,l,p,h,f)}});return{stop:()=>{d(),s.notify(),a()},actionContexts:{findActionId:l=>i.findAll(l)}};function c(l){if(!o||!o.tryAppend(l)){const f=l.clone();o=id(l,p=>{_d(p,f)})}}function d(){o&&o.stop()}}function pd(t,e,n,r,i){const s=t.enablePrivacyForActionName?vs(r.target,t.defaultPrivacyLevel):C.ALLOW;if(s===C.HIDDEN)return;const o=gd(r,s,t);let a=!1;return rr(e,n,i,t,u=>{a=u.hadActivity},ys),{clickActionBase:o,hadActivityOnPointerDown:()=>a}}function md(t,e,n,r,i,s,o,a,u,c,d){var l;const f=Os(e,i,c,a,u);o(f);const p=(l=a?.target)===null||l===void 0?void 0:l.selector;p&&ks(u.timeStamp,p);const{stop:h}=rr(e,n,r,t,R=>{R.hadActivity&&R.end<f.startClocks.timeStamp?f.discard():R.hadActivity?f.stop(R.end):d()?f.stop(f.startClocks.timeStamp):f.stop()},xs),m=e.subscribe(5,({endClocks:R})=>{f.stop(R.timeStamp)}),b=s.subscribe(()=>{f.stop()});f.stopObservable.subscribe(()=>{m.unsubscribe(),h(),b.unsubscribe()})}function gd(t,e,n){const r=t.target.getBoundingClientRect(),i=ye(t.target,n.actionNameAttribute);i&&ks(t.timeStamp,i);const s=$l(t.target,n,e);return{type:er.CLICK,target:{width:Math.round(r.width),height:Math.round(r.height),selector:i},position:{x:Math.round(t.clientX-r.left),y:Math.round(t.clientY-r.top)},name:s.name,nameSource:s.nameSource}}function Os(t,e,n,r,i){const s=$(),o=F(),a=e.add(s,o.relative),u=gs({lifeCycle:t,isChildEvent:h=>h.action!==void 0&&(Array.isArray(h.action.id)?h.action.id.includes(s):h.action.id===s)});let c=0,d;const l=[],f=new T;function p(h){c===0&&(d=h,c=1,d?a.close(Fn(d)):a.remove(),u.stop(),f.notify())}return{event:i,stop:p,stopObservable:f,get hasError(){return u.eventCounts.errorCount>0},get hasPageActivity(){return d!==void 0},getUserActivity:n,addFrustration:h=>{l.push(h)},startClocks:o,isStopped:()=>c===1||c===2,clone:()=>Os(t,e,n,r,i),validate:h=>{if(p(),c!==1)return;const{resourceCount:m,errorCount:b,longTaskCount:R}=u.eventCounts,P={duration:d&&N(o.timeStamp,d),startClocks:o,id:s,frustrationTypes:l,counts:{resourceCount:m,errorCount:b,longTaskCount:R},events:h??[i],event:i,...r};t.notify(0,P),c=2},discard:()=>{p(),c=2}}}function _d(t,e){const{isRage:n}=cd(t,e);n?(t.forEach(r=>r.discard()),e.stop(V()),e.validate(t.map(r=>r.event))):(e.discard(),t.forEach(r=>r.validate()))}function bd(t,e,n,r,i){t.subscribe(0,a=>t.notify(12,Lr(a))),e.register(0,({startTime:a,eventType:u})=>{if(u!==E.ERROR&&u!==E.RESOURCE&&u!==E.LONG_TASK)return X;const c=s.findActionId(a);return c?{type:u,action:{id:c}}:X}),e.register(1,({startTime:a})=>({action:{id:s.findActionId(a)}}));let s={findActionId:x},o=x;return i.trackUserInteractions&&({actionContexts:s,stop:o}=hd(t,n,r,i)),{addAction:a=>{t.notify(12,Lr(a))},actionContexts:s,stop:o}}function Lr(t){const e=Tn(t)?{action:{id:t.id,loading_time:ms(v(t.duration)),frustration:{type:t.frustrationTypes},error:{count:t.counts.errorCount},long_task:{count:t.counts.longTaskCount},resource:{count:t.counts.resourceCount}},_dd:{action:{target:t.target,position:t.position,name_source:t.nameSource}}}:{context:t.context},n=ut({action:{id:$(),target:{name:t.name},type:t.type},date:t.startClocks.timeStamp,type:E.ACTION},e),r=Tn(t)?t.duration:void 0,i=Tn(t)?{events:t.events}:{handlingStack:t.handlingStack};return{rawRumEvent:n,duration:r,startTime:t.startClocks.relative,domainContext:i}}function Tn(t){return t.type!==er.CUSTOM}function yd(t){const e=lu([Fe.error]).subscribe(n=>t.notify(n.error));return{stop:()=>{e.unsubscribe()}}}function vd(t,e){const n=kc(t,[fe.cspViolation,fe.intervention]).subscribe(r=>e.notify(r));return{stop:()=>{n.unsubscribe()}}}function Ed(t,e,n){const r=new T;return n.subscribe(i=>{i.type===0&&r.notify(i.error)}),yd(r),vd(e,r),r.subscribe(i=>t.notify(14,{error:i})),Sd(t)}function Sd(t){return t.subscribe(14,({error:e})=>{t.notify(12,wd(e))}),{addError:({error:e,handlingStack:n,componentStack:r,startClocks:i,context:s})=>{const o=Gn({originalError:e,handlingStack:n,componentStack:r,startClocks:i,nonErrorPrefix:"Provided",source:Yt.CUSTOM,handling:"handled"});o.context=ut(o.context,s),t.notify(14,{error:o})}}}function wd(t){const e={date:t.startClocks.timeStamp,error:{id:$(),message:t.message,source:t.source,stack:t.stack,handling_stack:t.handlingStack,component_stack:t.componentStack,type:t.type,handling:t.handling,causes:t.causes,source_type:"browser",fingerprint:t.fingerprint,csp:t.csp},type:E.ERROR,context:t.context},n={error:t.originalError,handlingStack:t.handlingStack};return{rawRumEvent:e,startTime:t.startClocks.relative,domainContext:n}}const Mr=new WeakSet;function Td(t){if(!performance||!("getEntriesByName"in performance))return;const e=performance.getEntriesByName(t.url,"resource");if(!e.length||!("toJSON"in e[0]))return;const n=e.filter(r=>!Mr.has(r)).filter(r=>fs(r)&&hs(r)).filter(r=>Id(r,t.startClocks.relative,Ns({startTime:t.startClocks.relative,duration:t.duration})));if(n.length===1)return Mr.add(n[0]),n[0].toJSON()}function Ns(t){return Kt(t.startTime,t.duration)}function Id(t,e,n){return t.startTime>=e-1&&Ns(t)<=Kt(n,1)}const Ad=2*j;function Cd(t){const e=Rd(t)||xd(t);if(!(!e||e.traceTime<=tt()-Ad))return e.traceId}function Rd(t){const e=t.querySelector("meta[name=dd-trace-id]"),n=t.querySelector("meta[name=dd-trace-time]");return Ls(e&&e.content,n&&n.content)}function xd(t){const e=kd(t);if(e)return Ls(le(e,"trace-id"),le(e,"trace-time"))}function Ls(t,e){const n=e&&Number(e);if(!(!t||!n))return{traceId:t,traceTime:n}}function kd(t){for(let e=0;e<t.childNodes.length;e+=1){const n=Pr(t.childNodes[e]);if(n)return n}if(t.body)for(let e=t.body.childNodes.length-1;e>=0;e-=1){const n=t.body.childNodes[e],r=Pr(n);if(r)return r;if(!_s(n))break}}function Pr(t){if(t&&Cl(t)){const e=/^\s*DATADOG;(.*?)\s*$/.exec(t.data);if(e)return e[1]}}function Ms(){if(kt(I.NAVIGATION)){const n=performance.getEntriesByType(I.NAVIGATION)[0];if(n)return n}const t=Od(),e={entryType:I.NAVIGATION,initiatorType:"navigation",name:window.location.href,startTime:0,duration:t.loadEventEnd,decodedBodySize:0,encodedBodySize:0,transferSize:0,workerStart:0,toJSON:()=>({...e,toJSON:void 0}),...t};return e}function Od(){const t={},e=performance.timing;for(const n in e)if(he(e[n])){const r=n,i=e[r];t[r]=i===0?0:Fn(i)}return t}function Nd(t,e,n=Ms){Zn(t,"interactive",()=>{const r=n(),i=Object.assign(r.toJSON(),{entryType:I.RESOURCE,initiatorType:ls,duration:r.responseEnd,traceId:Cd(document),toJSON:()=>({...i,toJSON:void 0})});e(i)})}const Ld=1e3;function Md(t){const e=new Set,n=t.subscribe(8,r=>{e.add(r),e.size>Ld&&(_t("Too many requests"),e.delete(e.values().next().value))});return{getMatchingRequest(r){let i=1/0,s;for(const o of e){const a=r.startTime-o.startClocks.relative;0<=a&&a<i&&o.url===r.name&&(i=Math.abs(a),s=o)}return s&&e.delete(s),s},stop(){n.unsubscribe()}}}function Pd(t,e,n,r=uu(),i=Nd){let s;const o=We(It.EARLY_REQUEST_COLLECTION);o?s=Md(t):t.subscribe(8,c=>{u(()=>Dd(c,e,n))});const a=it(e,{type:I.RESOURCE,buffered:!0}).subscribe(c=>{for(const d of c)(o||!ds(d))&&u(()=>Dr(d,e,n,s))});i(e,c=>{u(()=>Dr(c,e,n,s))});function u(c){r.push(()=>{const d=c();d&&t.notify(12,d)})}return{stop:()=>{a.unsubscribe()}}}function Dd(t,e,n){const r=Td(t);return Ps(r,t,n,e)}function Dr(t,e,n,r){const i=ds(t)&&r?r.getMatchingRequest(t):void 0;return Ps(t,i,n,e)}function Ps(t,e,n,r){if(!t&&!e)return;const i=e?Fd(e,r):Bd(t,r);if(!r.trackResources&&!i)return;const s=t?ze(t.startTime):e.startClocks,o=t?ul(t):zd(n,s,e.duration),a=ut({date:s.timeStamp,resource:{id:$(),duration:v(o),type:e?e.type===je.XHR?K.XHR:K.FETCH:cl(t),method:e?e.method:void 0,status_code:e?e.status:$d(t.responseStatus),url:e?_l(e.url):t.name,protocol:t&&fl(t),delivery_type:t&&hl(t)},type:E.RESOURCE,_dd:{discarded:!r.trackResources}},i,t&&Vd(t));return{startTime:s.relative,duration:o,rawRumEvent:a,domainContext:Ud(t,e)}}function Ud(t,e){if(e){const n={performanceEntry:t,isAborted:e.isAborted,handlingStack:e.handlingStack};return e.type===je.XHR?{xhr:e.xhr,...n}:{requestInput:e.input,requestInit:e.init,response:e.response,error:e.error,...n}}return{performanceEntry:t}}function Vd(t){const{renderBlockingStatus:e}=t;return{resource:{render_blocking_status:e,...pl(t),...ll(t)}}}function Fd(t,e){if(t.traceSampled&&t.traceId&&t.spanId)return{_dd:{span_id:t.spanId.toString(),trace_id:t.traceId.toString(),rule_psr:e.rulePsr}}}function Bd(t,e){if(t.traceId)return{_dd:{trace_id:t.traceId,span_id:as().toString(),rule_psr:e.rulePsr}}}function zd(t,e,n){return t.wasInPageStateDuringPeriod("frozen",e.relative,n)?void 0:n}function $d(t){return t===0?void 0:t}function Gd(t,e,n){const{stop:r,eventCounts:i}=gs({lifeCycle:t,isChildEvent:s=>s.view.id===e,onChange:n});return{stop:r,eventCounts:i}}const Hd=10*j;function Wd(t,e,n){return{stop:it(t,{type:I.PAINT,buffered:!0}).subscribe(i=>{const s=i.find(o=>o.name==="first-contentful-paint"&&o.startTime<e.timeStamp&&o.startTime<Hd);s&&n(s.startTime)}).unsubscribe}}function Kd(t,e){requestAnimationFrame(()=>{requestAnimationFrame(()=>{e(N(t,Y()))})})}function jd(t,e,n){const r=it(t,{type:I.FIRST_INPUT,buffered:!0}).subscribe(i=>{const s=i.find(o=>o.startTime<e.timeStamp);if(s){const o=N(s.startTime,s.processingStart);let a;s.target&&lt(s.target)&&(a=ye(s.target,t.actionNameAttribute)),n({delay:o>=0?o:0,time:s.startTime,targetSelector:a})}});return{stop:()=>{r.unsubscribe()}}}function qd(t,e,n=Ms){return Jd(t,()=>{const r=n();Xd(r)||e(Yd(r))})}function Yd(t){return{domComplete:t.domComplete,domContentLoaded:t.domContentLoadedEventEnd,domInteractive:t.domInteractive,loadEvent:t.loadEventEnd,firstByte:t.responseStart>=0&&t.responseStart<=Y()?t.responseStart:void 0}}function Xd(t){return t.loadEventEnd<=0}function Jd(t,e){let n;const{stop:r}=Zn(t,"complete",()=>{n=B(()=>e())});return{stop:()=>{r(),Q(n)}}}const Zd=10*j;function Qd(t,e,n,r){let i=1/0;const{stop:s}=mt(t,n,["pointerdown","keydown"],u=>{i=u.timeStamp},{capture:!0,once:!0});let o=0;const a=it(t,{type:I.LARGEST_CONTENTFUL_PAINT,buffered:!0}).subscribe(u=>{const c=Co(u,d=>d.entryType===I.LARGEST_CONTENTFUL_PAINT&&d.startTime<i&&d.startTime<e.timeStamp&&d.startTime<Zd&&d.size>o);if(c){let d;c.element&&(d=ye(c.element,t.actionNameAttribute)),r({value:c.startTime,targetSelector:d,resourceUrl:tf(c)}),o=c.size}});return{stop:()=>{s(),a.unsubscribe()}}}function tf(t){return t.url===""?void 0:t.url}function Ds(t,e,n=window){if(document.visibilityState==="hidden")return{timeStamp:0,stop:x};if(kt(I.VISIBILITY_STATE)){const s=performance.getEntriesByType(I.VISIBILITY_STATE).filter(o=>o.name==="hidden").find(o=>o.startTime>=e.relative);if(s)return{timeStamp:s.startTime,stop:x}}let r=1/0;const{stop:i}=mt(t,n,["pagehide","visibilitychange"],s=>{(s.type==="pagehide"||document.visibilityState==="hidden")&&(r=s.timeStamp,i())},{capture:!0});return{get timeStamp(){return r},stop:i}}function ef(t,e,n,r){const i={},{stop:s}=qd(t,l=>{n(l.loadEvent),i.navigationTimings=l,r()}),o=Ds(t,e),{stop:a}=Wd(t,o,l=>{i.firstContentfulPaint=l,r()}),{stop:u}=Qd(t,o,window,l=>{i.largestContentfulPaint=l,r()}),{stop:c}=jd(t,o,l=>{i.firstInput=l,r()});function d(){s(),a(),u(),c(),o.stop()}return{stop:d,initialViewMetrics:i}}const Dn=(t,e)=>t*e,nf=(t,e)=>{const n=Math.max(t.left,e.left),r=Math.max(t.top,e.top),i=Math.min(t.right,e.right),s=Math.min(t.bottom,e.bottom);return n>=i||r>=s?0:Dn(i-n,s-r)},Ur=t=>{const e=Dn(t.previousRect.width,t.previousRect.height),n=Dn(t.currentRect.width,t.currentRect.height),r=nf(t.previousRect,t.currentRect);return e+n-r};function rf(t,e,n){if(!uf())return{stop:x};let r=0,i;n({value:0});const s=cf(),o=it(t,{type:I.LAYOUT_SHIFT,buffered:!0}).subscribe(a=>{var u;for(const c of a){if(c.hadRecentInput||c.startTime<e)continue;const{cumulatedValue:d,isMaxValue:l}=s.update(c);if(l){const f=sf(c.sources);i={target:f?.node?new WeakRef(f.node):void 0,time:N(e,c.startTime),previousRect:f?.previousRect,currentRect:f?.currentRect,devicePixelRatio:window.devicePixelRatio}}if(d>r){r=d;const f=(u=i?.target)===null||u===void 0?void 0:u.deref();n({value:ie(r,4),targetSelector:f&&ye(f,t.actionNameAttribute),time:i?.time,previousRect:i?.previousRect?Vr(i.previousRect):void 0,currentRect:i?.currentRect?Vr(i.currentRect):void 0,devicePixelRatio:i?.devicePixelRatio})}}});return{stop:()=>{o.unsubscribe()}}}function sf(t){let e;for(const n of t)if(n.node&&lt(n.node)){const r=Ur(n);(!e||Ur(e)<r)&&(e=n)}return e}function Vr({x:t,y:e,width:n,height:r}){return{x:t,y:e,width:n,height:r}}const of=5*z,af=z;function cf(){let t=0,e,n,r=0;return{update:i=>{const s=e===void 0||i.startTime-n>=af||i.startTime-e>=of;let o;return s?(e=n=i.startTime,r=t=i.value,o=!0):(t+=i.value,n=i.startTime,o=i.value>r,o&&(r=i.value)),{cumulatedValue:t,isMaxValue:o}}}}function uf(){return kt(I.LAYOUT_SHIFT)&&"WeakRef"in window}let Me,Us=0,In=1/0,An=0;function lf(){"interactionCount"in performance||Me||(Me=new window.PerformanceObserver(y(t=>{t.getEntries().forEach(e=>{const n=e;n.interactionId&&(In=Math.min(In,n.interactionId),An=Math.max(An,n.interactionId),Us=(An-In)/7+1)})})),Me.observe({type:"event",buffered:!0,durationThreshold:0}))}const Fr=()=>Me?Us:window.performance.interactionCount||0,Br=10,df=1*j;function ff(t,e,n){if(!mf())return{getInteractionToNextPaint:()=>{},setViewEnd:x,stop:x};const{getViewInteractionCount:r,stopViewInteractionCount:i}=pf(n);let s=1/0;const o=hf(r);let a=-1,u,c;function d(p){for(const m of p)m.interactionId&&m.startTime>=e&&m.startTime<=s&&o.process(m);const h=o.estimateP98Interaction();h&&h.duration!==a&&(a=h.duration,c=N(e,h.startTime),u=dd(h.startTime),!u&&h.target&&lt(h.target)&&(u=ye(h.target,t.actionNameAttribute)))}const l=it(t,{type:I.FIRST_INPUT,buffered:!0}).subscribe(d),f=it(t,{type:I.EVENT,durationThreshold:40,buffered:!0}).subscribe(d);return{getInteractionToNextPaint:()=>{if(a>=0)return{value:Math.min(a,df),targetSelector:u,time:c};if(r())return{value:0}},setViewEnd:p=>{s=p,i()},stop:()=>{f.unsubscribe(),l.unsubscribe()}}}function hf(t){const e=[];function n(){e.sort((r,i)=>i.duration-r.duration).splice(Br)}return{process(r){const i=e.findIndex(o=>r.interactionId===o.interactionId),s=e[e.length-1];i!==-1?r.duration>e[i].duration&&(e[i]=r,n()):(e.length<Br||r.duration>s.duration)&&(e.push(r),n())},estimateP98Interaction(){const r=Math.min(e.length-1,Math.floor(t()/50));return e[r]}}}function pf(t){lf();const e=t===at.INITIAL_LOAD?0:Fr();let n={stopped:!1};function r(){return Fr()-e}return{getViewInteractionCount:()=>n.stopped?n.interactionCount:r(),stopViewInteractionCount:()=>{n={stopped:!0,interactionCount:r()}}}}function mf(){return kt(I.EVENT)&&window.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype}function gf(t,e,n,r,i,s,o){let a=i===at.INITIAL_LOAD,u=!0;const c=[],d=Ds(r,s);function l(){if(!u&&!a&&c.length>0){const p=Math.max(...c);p<d.timeStamp-s.relative&&o(p)}}const{stop:f}=rr(t,e,n,r,p=>{u&&(u=!1,p.hadActivity&&c.push(N(s.timeStamp,p.end)),l())});return{stop:()=>{f(),d.stop()},setLoadEvent:p=>{a&&(a=!1,c.push(p),l())}}}function wp(){let t;const e=window.visualViewport;return e?t=e.pageLeft-e.offsetLeft:window.scrollX!==void 0?t=window.scrollX:t=window.pageXOffset||0,Math.round(t)}function _f(){let t;const e=window.visualViewport;return e?t=e.pageTop-e.offsetTop:window.scrollY!==void 0?t=window.scrollY:t=window.pageYOffset||0,Math.round(t)}let Cn;function bf(t){return Cn||(Cn=yf(t)),Cn}function yf(t){return new T(e=>{const{throttled:n}=Ge(()=>{e.notify(ir())},200);return O(t,window,"resize",n,{capture:!0,passive:!0}).stop})}function ir(){const t=window.visualViewport;return t?{width:Number(t.width*t.scale),height:Number(t.height*t.scale)}:{width:Number(window.innerWidth||0),height:Number(window.innerHeight||0)}}const vf=z;function Ef(t,e,n,r=wf(t)){let i=0,s=0,o=0;const a=r.subscribe(({scrollDepth:u,scrollTop:c,scrollHeight:d})=>{let l=!1;if(u>i&&(i=u,l=!0),d>s){s=d;const f=Y();o=N(e.relative,f),l=!0}l&&n({maxDepth:Math.min(i,s),maxDepthScrollTop:c,maxScrollHeight:s,maxScrollHeightTime:o})});return{stop:()=>a.unsubscribe()}}function Sf(){const t=_f(),{height:e}=ir(),n=Math.round((document.scrollingElement||document.documentElement).scrollHeight),r=Math.round(e+t);return{scrollHeight:n,scrollDepth:r,scrollTop:t}}function wf(t,e=vf){return new T(n=>{function r(){n.notify(Sf())}if(window.ResizeObserver){const i=Ge(r,e,{leading:!1,trailing:!0}),s=document.scrollingElement||document.documentElement,o=new ResizeObserver(y(i.throttled));s&&o.observe(s);const a=O(t,window,"scroll",i.throttled,{passive:!0});return()=>{i.cancel(),o.disconnect(),a.stop()}}})}function Tf(t,e,n,r,i,s,o){const a={},{stop:u,setLoadEvent:c}=gf(t,e,n,r,s,o,m=>{a.loadingTime=m,i()}),{stop:d}=Ef(r,o,m=>{a.scroll=m}),{stop:l}=rf(r,o.relative,m=>{a.cumulativeLayoutShift=m,i()}),{stop:f,getInteractionToNextPaint:p,setViewEnd:h}=ff(r,o.relative,s);return{stop:()=>{u(),l(),d()},stopINPTracking:f,setLoadEvent:c,setViewEnd:h,getCommonViewMetrics:()=>(a.interactionToNextPaint=p(),a)}}function If(t,e){const{stop:n}=O(t,window,"pageshow",r=>{r.persisted&&e(r)},{capture:!0});return n}function Af(t,e,n){Kd(t.relative,r=>{e.firstContentfulPaint=r,e.largestContentfulPaint={value:r},n()})}const Cf=3e3,Rf=5*j,xf=5*j;function kf(t,e,n,r,i,s,o,a){const u=new Set;let c=f(at.INITIAL_LOAD,ti(),a),d;p();let l;o&&(l=h(s),i.trackBfcacheViews&&(d=If(i,m=>{c.end();const b=ze(m.timeStamp);c=f(at.BF_CACHE,b,void 0)})));function f(m,b,R){const P=Of(e,n,r,i,t,m,b,R);return u.add(P),P.stopObservable.subscribe(()=>{u.delete(P)}),P}function p(){e.subscribe(10,()=>{c=f(at.ROUTE_CHANGE,void 0,{name:c.name,service:c.service,version:c.version,context:c.contextManager.getContext()})}),e.subscribe(9,()=>{c.end({sessionIsActive:!1})})}function h(m){return m.subscribe(({oldLocation:b,newLocation:R})=>{Lf(b,R)&&(c.end(),c=f(at.ROUTE_CHANGE))})}return{addTiming:(m,b=V())=>{c.addTiming(m,b)},startView:(m,b)=>{c.end({endClocks:b}),c=f(at.ROUTE_CHANGE,b,m)},setViewContext:m=>{c.contextManager.setContext(m)},setViewContextProperty:(m,b)=>{c.contextManager.setContextProperty(m,b)},setViewName:m=>{c.setViewName(m)},getViewContext:()=>c.contextManager.getContext(),stop:()=>{l&&l.unsubscribe(),d&&d(),c.end(),u.forEach(m=>m.stop())}}}function Of(t,e,n,r,i,s,o=F(),a){const u=$(),c=new T,d={};let l=0,f;const p=ue(i),h=Ke();let m=!0,b=a?.name;const R=a?.service||r.service,P=a?.version||r.version,g=a?.context;g&&h.setContext(g);const S={id:u,name:b,startClocks:o,service:R,version:P,context:g};t.notify(1,S),t.notify(2,S);const{throttled:k,cancel:_}=Ge(ft,Cf,{leading:!1}),{setLoadEvent:D,setViewEnd:Je,stop:Ze,stopINPTracking:Ee,getCommonViewMetrics:Se}=Tf(t,e,n,r,dt,s,o),{stop:Qe,initialViewMetrics:we}=s===at.INITIAL_LOAD?ef(r,o,D,dt):{stop:x,initialViewMetrics:{}};s===at.BF_CACHE&&Af(o,we,dt);const{stop:tn,eventCounts:en}=Gd(t,u,dt),nn=jt(ft,Rf),rn=t.subscribe(11,J=>{J.reason===Bt.UNLOADING&&ft()});ft(),h.changeObservable.subscribe(dt);function Te(){t.notify(3,{id:u,name:b,context:h.getContext(),startClocks:o,sessionIsActive:m})}function dt(){Te(),k()}function ft(){_(),Te(),l+=1;const J=f===void 0?V():f.timeStamp;t.notify(4,{customTimings:d,documentVersion:l,id:u,name:b,service:R,version:P,context:h.getContext(),loadingType:s,location:p,startClocks:o,commonViewMetrics:Se(),initialViewMetrics:we,duration:N(o.timeStamp,J),isActive:f===void 0,sessionIsActive:m,eventCounts:en})}return{get name(){return b},service:R,version:P,contextManager:h,stopObservable:c,end(J={}){var st,bt;f||(f=(st=J.endClocks)!==null&&st!==void 0?st:F(),m=(bt=J.sessionIsActive)!==null&&bt!==void 0?bt:!0,t.notify(5,{endClocks:f}),t.notify(6,{endClocks:f}),$e(nn),Je(f.relative),Ze(),rn.unsubscribe(),ft(),B(()=>{this.stop()},xf))},stop(){Qe(),tn(),Ee(),c.notify()},addTiming(J,st){if(f)return;const bt=bo(st)?st:N(o.timeStamp,st);d[Nf(J)]=bt,dt()},setViewName(J){b=J,ft()}}}function Nf(t){const e=t.replace(/[^a-zA-Z0-9-_.@$]/g,"_");return e!==t&&w.warn(`Invalid timing name: ${t}, sanitized to: ${e}`),e}function Lf(t,e){return t.pathname!==e.pathname||!Mf(e.hash)&&zr(e.hash)!==zr(t.hash)}function Mf(t){const e=t.substring(1);return e!==""&&!!document.getElementById(e)}function zr(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}function Pf(t,e,n,r,i,s,o,a,u,c){return t.subscribe(4,d=>t.notify(12,Df(d,n,a))),e.register(0,({startTime:d,eventType:l})=>{const f=u.findView(d);return f?{type:l,service:f.service,version:f.version,context:f.context,view:{id:f.id,name:f.name}}:gt}),e.register(1,({startTime:d})=>{var l;return{view:{id:(l=u.findView(d))===null||l===void 0?void 0:l.id}}}),kf(r,t,i,s,n,o,!n.trackViewsManually,c)}function Df(t,e,n){var r,i,s,o,a,u,c,d,l,f,p,h,m,b,R,P,g,S;const k=n.getReplayStats(t.id),_=(i=(r=t.commonViewMetrics)===null||r===void 0?void 0:r.cumulativeLayoutShift)===null||i===void 0?void 0:i.devicePixelRatio,D={_dd:{document_version:t.documentVersion,replay_stats:k,cls:_?{device_pixel_ratio:_}:void 0,configuration:{start_session_replay_recording_manually:e.startSessionReplayRecordingManually}},date:t.startClocks.timeStamp,type:E.VIEW,view:{action:{count:t.eventCounts.actionCount},frustration:{count:t.eventCounts.frustrationCount},cumulative_layout_shift:(s=t.commonViewMetrics.cumulativeLayoutShift)===null||s===void 0?void 0:s.value,cumulative_layout_shift_time:v((o=t.commonViewMetrics.cumulativeLayoutShift)===null||o===void 0?void 0:o.time),cumulative_layout_shift_target_selector:(a=t.commonViewMetrics.cumulativeLayoutShift)===null||a===void 0?void 0:a.targetSelector,first_byte:v((u=t.initialViewMetrics.navigationTimings)===null||u===void 0?void 0:u.firstByte),dom_complete:v((c=t.initialViewMetrics.navigationTimings)===null||c===void 0?void 0:c.domComplete),dom_content_loaded:v((d=t.initialViewMetrics.navigationTimings)===null||d===void 0?void 0:d.domContentLoaded),dom_interactive:v((l=t.initialViewMetrics.navigationTimings)===null||l===void 0?void 0:l.domInteractive),error:{count:t.eventCounts.errorCount},first_contentful_paint:v(t.initialViewMetrics.firstContentfulPaint),first_input_delay:v((f=t.initialViewMetrics.firstInput)===null||f===void 0?void 0:f.delay),first_input_time:v((p=t.initialViewMetrics.firstInput)===null||p===void 0?void 0:p.time),first_input_target_selector:(h=t.initialViewMetrics.firstInput)===null||h===void 0?void 0:h.targetSelector,interaction_to_next_paint:v((m=t.commonViewMetrics.interactionToNextPaint)===null||m===void 0?void 0:m.value),interaction_to_next_paint_time:v((b=t.commonViewMetrics.interactionToNextPaint)===null||b===void 0?void 0:b.time),interaction_to_next_paint_target_selector:(R=t.commonViewMetrics.interactionToNextPaint)===null||R===void 0?void 0:R.targetSelector,is_active:t.isActive,name:t.name,largest_contentful_paint:v((P=t.initialViewMetrics.largestContentfulPaint)===null||P===void 0?void 0:P.value),largest_contentful_paint_target_selector:(g=t.initialViewMetrics.largestContentfulPaint)===null||g===void 0?void 0:g.targetSelector,load_event:v((S=t.initialViewMetrics.navigationTimings)===null||S===void 0?void 0:S.loadEvent),loading_time:ms(v(t.commonViewMetrics.loadingTime)),loading_type:t.loadingType,long_task:{count:t.eventCounts.longTaskCount},performance:Uf(t.commonViewMetrics,t.initialViewMetrics),resource:{count:t.eventCounts.resourceCount},time_spent:v(t.duration)},display:t.commonViewMetrics.scroll?{scroll:{max_depth:t.commonViewMetrics.scroll.maxDepth,max_depth_scroll_top:t.commonViewMetrics.scroll.maxDepthScrollTop,max_scroll_height:t.commonViewMetrics.scroll.maxScrollHeight,max_scroll_height_time:v(t.commonViewMetrics.scroll.maxScrollHeightTime)}}:void 0,privacy:{replay_level:e.defaultPrivacyLevel},device:{locale:navigator.language,locales:navigator.languages,time_zone:Au()}};return At(t.customTimings)||(D.view.custom_timings=ri(t.customTimings,v)),{rawRumEvent:D,startTime:t.startClocks.relative,duration:t.duration,domainContext:{location:t.location}}}function Uf({cumulativeLayoutShift:t,interactionToNextPaint:e},{firstContentfulPaint:n,firstInput:r,largestContentfulPaint:i}){return{cls:t&&{score:t.value,timestamp:v(t.time),target_selector:t.targetSelector,previous_rect:t.previousRect,current_rect:t.currentRect},fcp:n&&{timestamp:v(n)},fid:r&&{duration:v(r.delay),timestamp:v(r.time),target_selector:r.targetSelector},inp:e&&{duration:v(e.value),timestamp:v(e.time),target_selector:e.targetSelector},lcp:i&&{timestamp:v(i.value),target_selector:i.targetSelector,resource_url:i.resourceUrl}}}const Vf="rum";function Ff(t,e,n){const r=$c(t,Vf,i=>zf(t,i),n);return r.expireObservable.subscribe(()=>{e.notify(9)}),r.renewObservable.subscribe(()=>{e.notify(10)}),r.sessionStateUpdateObservable.subscribe(({previousState:i,newState:s})=>{if(!i.forcedReplay&&s.forcedReplay){const o=r.findSession();o&&(o.isReplayForced=!0)}}),{findTrackedSession:i=>{const s=r.findSession(i);if(!(!s||s.trackingType==="0"))return{id:s.id,sessionReplay:s.trackingType==="1"?1:s.isReplayForced?2:0,anonymousId:s.anonymousId}},expire:r.expire,expireObservable:r.expireObservable,setForcedReplay:()=>r.updateSessionState({forcedReplay:"1"})}}function Bf(){const t={id:"00000000-aaaa-0000-aaaa-000000000000",sessionReplay:Di("records")?1:0};return{findTrackedSession:()=>t,expire:x,expireObservable:new T,setForcedReplay:x}}function zf(t,e){return $f(e)?e:ct(t.sessionSampleRate)?ct(t.sessionReplaySampleRate)?"1":"2":"0"}function $f(t){return t==="0"||t==="1"||t==="2"}function Gf(t,e,n,r,i,s){const o=[t.rumEndpointBuilder];t.replica&&o.push(t.replica.rumEndpointBuilder);const a=Ui({encoder:s(2),request:Pi(o,t.batchBytesLimit,n),flushController:Vi({messagesLimit:t.batchMessagesLimit,bytesLimit:t.batchBytesLimit,durationLimit:t.flushTimeout,pageMayExitObservable:r,sessionExpireObservable:i}),messageBytesLimit:t.messageBytesLimit});return e.subscribe(13,u=>{u.type===E.VIEW?a.upsert(u,u.view.id):a.add(u)}),a}function Hf(t){const e=be();t.subscribe(13,n=>{e.send("rum",n)})}const Wf=Ct;function Kf(t,e,n,r){const i=Jt({expireDelay:Wf});let s;t.subscribe(1,({startClocks:u})=>{const c=r.href;i.add(a({url:c,referrer:s||document.referrer}),u.relative),s=c}),t.subscribe(6,({endClocks:u})=>{i.closeActive(u.relative)});const o=n.subscribe(({newLocation:u})=>{const c=i.find();if(c){const d=Y();i.closeActive(d),i.add(a({url:u.href,referrer:c.referrer}),d)}});function a({url:u,referrer:c}){return{url:u,referrer:c}}return e.register(0,({startTime:u,eventType:c})=>{const d=i.find(u);return d?{type:c,view:{url:d.url,referrer:d.referrer}}:gt}),{findUrl:u=>i.find(u),stop:()=>{o.unsubscribe(),i.stop()}}}function jf(t,e){let n=ue(e);return new T(r=>{const{stop:i}=qf(t,o),{stop:s}=Yf(t,o);function o(){if(n.href===e.href)return;const a=ue(e);r.notify({newLocation:a,oldLocation:n}),n=a}return()=>{i(),s()}})}function qf(t,e){const{stop:n}=rt($r("pushState"),"pushState",({onPostCall:s})=>{s(e)}),{stop:r}=rt($r("replaceState"),"replaceState",({onPostCall:s})=>{s(e)}),{stop:i}=O(t,window,"popstate",e);return{stop:()=>{n(),r(),i()}}}function Yf(t,e){return O(t,window,"hashchange",e)}function $r(t){return Object.prototype.hasOwnProperty.call(history,t)?history:History.prototype}const Xf=Ct;function Jf(t,e,n){const r=Jt({expireDelay:Xf});return t.subscribe(1,({startClocks:i})=>{r.add({},i.relative)}),t.subscribe(6,({endClocks:i})=>{r.closeActive(i.relative)}),e.register(0,({startTime:i,eventType:s})=>{if(!n.trackFeatureFlagsForEvents.concat([E.VIEW,E.ERROR]).includes(s))return X;const a=r.find(i);return!a||At(a)?X:{type:s,feature_flags:a}}),{addFeatureFlagEvaluation:(i,s)=>{const o=r.find();o&&(o[i]=s)}}}const Zf=10*z;let zt,xe;function Qf(t,e,n,r){e.enabled&&ct(t.customerDataTelemetrySampleRate)&&(Vs(),xe=!1,n.subscribe(13,()=>{xe=!0}),r.subscribe(({bytesCount:s,messagesCount:o})=>{xe&&(xe=!1,zt.batchCount+=1,Hr(zt.batchBytesCount,s),Hr(zt.batchMessagesCount,o))}),jt(th,Zf))}function th(){zt.batchCount!==0&&(jn("Customer data measures",zt),Vs())}function Gr(){return{min:1/0,max:0,sum:0}}function Hr(t,e){t.sum+=e,t.min=Math.min(t.min,e),t.max=Math.max(t.max,e)}function Vs(){zt={batchCount:0,batchBytesCount:Gr(),batchMessagesCount:Gr()}}const eh=4e3,nh=500,rh=Ct;function ih(t,e,n=nh){const r=Jt({expireDelay:rh,maxEntries:eh});let i;kt(I.VISIBILITY_STATE)&&performance.getEntriesByType(I.VISIBILITY_STATE).forEach(c=>{const d=c.name==="hidden"?"hidden":"active";o(d,c.startTime)}),o(Fs(),Y());const{stop:s}=mt(e,window,["pageshow","focus","blur","visibilitychange","resume","freeze","pagehide"],u=>{o(oh(u),u.timeStamp)},{capture:!0});function o(u,c=Y()){u!==i&&(i=u,r.closeActive(c),r.add({state:i,startTime:c},c))}function a(u,c,d){return r.findAll(c,d).some(l=>l.state===u)}return t.register(0,({startTime:u,duration:c=0,eventType:d})=>{if(d===E.VIEW){const l=r.findAll(u,c);return{type:d,_dd:{page_states:sh(l,u,n)}}}return d===E.ACTION||d===E.ERROR?{type:d,view:{in_foreground:a("active",u,0)}}:X}),{wasInPageStateDuringPeriod:a,addPageState:o,stop:()=>{s(),r.stop()}}}function sh(t,e,n){if(t.length!==0)return t.slice(-n).reverse().map(({state:r,startTime:i})=>({state:r,start:v(N(e,i))}))}function oh(t){return t.type==="freeze"?"frozen":t.type==="pagehide"?t.persisted?"frozen":"terminated":Fs()}function Fs(){return document.visibilityState==="hidden"?"hidden":document.hasFocus()?"active":"passive"}function ah(t,e){let n;const r=requestAnimationFrame(y(()=>{n=ir()})),i=bf(e).subscribe(s=>{n=s}).unsubscribe;return t.register(0,({eventType:s})=>({type:s,display:n?{viewport:n}:void 0})),{stop:()=>{i(),r&&cancelAnimationFrame(r)}}}function ch(t,e){const n=window.cookieStore?uh(t):dh;return new T(r=>n(e,i=>r.notify(i)))}function uh(t){return(e,n)=>O(t,window.cookieStore,"change",i=>{const s=i.changed.find(o=>o.name===e)||i.deleted.find(o=>o.name===e);s&&n(s.value)}).stop}const lh=z;function dh(t,e){const n=le(document.cookie,t),r=jt(()=>{const i=le(document.cookie,t);i!==n&&e(i)},lh);return()=>{$e(r)}}const Wr="datadog-ci-visibility-test-execution-id";function fh(t,e,n=ch(t,Wr)){var r;let i=ht(Wr)||((r=window.Cypress)===null||r===void 0?void 0:r.env("traceId"));const s=n.subscribe(o=>{i=o});return e.register(0,({eventType:o})=>typeof i!="string"?X:{type:o,session:{type:"ci_test"},ci_test:{test_execution_id:i}}),{stop:()=>{s.unsubscribe()}}}function hh(t,e){const n=it(e,{type:I.LONG_ANIMATION_FRAME,buffered:!0}).subscribe(r=>{for(const i of r){const s=ze(i.startTime),o={date:s.timeStamp,long_task:{id:$(),entry_type:es.LONG_ANIMATION_FRAME,duration:v(i.duration),blocking_duration:v(i.blockingDuration),first_ui_event_timestamp:v(i.firstUIEventTimestamp),render_start:v(i.renderStart),style_and_layout_start:v(i.styleAndLayoutStart),start_time:v(i.startTime),scripts:i.scripts.map(a=>({duration:v(a.duration),pause_duration:v(a.pauseDuration),forced_style_and_layout_duration:v(a.forcedStyleAndLayoutDuration),start_time:v(a.startTime),execution_start:v(a.executionStart),source_url:a.sourceURL,source_function_name:a.sourceFunctionName,source_char_position:a.sourceCharPosition,invoker:a.invoker,invoker_type:a.invokerType,window_attribution:a.windowAttribution}))},type:E.LONG_TASK,_dd:{discarded:!1}};t.notify(12,{rawRumEvent:o,startTime:s.relative,duration:i.duration,domainContext:{performanceEntry:i}})}});return{stop:()=>n.unsubscribe()}}function ph(t,e){const n=it(e,{type:I.LONG_TASK,buffered:!0}).subscribe(r=>{for(const i of r){if(i.entryType!==I.LONG_TASK||!e.trackLongTasks)break;const s=ze(i.startTime),o={date:s.timeStamp,long_task:{id:$(),entry_type:es.LONG_TASK,duration:v(i.duration)},type:E.LONG_TASK,_dd:{discarded:!1}};t.notify(12,{rawRumEvent:o,startTime:s.relative,duration:i.duration,domainContext:{performanceEntry:i}})}});return{stop(){n.unsubscribe()}}}function mh(t){t.register(0,({eventType:e})=>{if(!Xi())return X;const n=qi(),r=Yi();return{type:e,session:{type:"synthetics"},synthetics:{test_id:n,result_id:r,injected:ji()}}})}function gh(t,e,n){const r=Wn(t),i=n(r);return zn(e).forEach(([s,o])=>Un(t,r,s.split(/\.|(?=\[\])/),o)),i}function Un(t,e,n,r){const[i,...s]=n;if(i==="[]"){Array.isArray(t)&&Array.isArray(e)&&t.forEach((o,a)=>Un(o,e[a],s,r));return}if(!(!Kr(t)||!Kr(e))){if(s.length>0)return Un(t[i],e[i],s,r);_h(t,i,e[i],r)}}function _h(t,e,n,r){const i=xt(n);i===r?t[e]=L(n):r==="object"&&(i==="undefined"||i==="null")&&(t[e]={})}function Kr(t){return xt(t)==="object"}const Lt={"view.name":"string","view.url":"string","view.referrer":"string"},Mt={context:"object"},Pt={service:"string",version:"string"};let Bs;function bh(t,e,n,r){Bs={[E.VIEW]:{"view.performance.lcp.resource_url":"string",...Mt,...Lt,...Pt},[E.ERROR]:{"error.message":"string","error.stack":"string","error.resource.url":"string","error.fingerprint":"string",...Mt,...Lt,...Pt},[E.RESOURCE]:{"resource.url":"string",...We(It.WRITABLE_RESOURCE_GRAPHQL)?{"resource.graphql":"object"}:{},...Mt,...Lt,...Pt},[E.ACTION]:{"action.target.name":"string",...Mt,...Lt,...Pt},[E.LONG_TASK]:{"long_task.scripts[].source_url":"string","long_task.scripts[].invoker":"string",...Mt,...Lt,...Pt},[E.VITAL]:{...Mt,...Lt,...Pt}};const i={[E.ERROR]:gn(E.ERROR,t.eventRateLimiterThreshold,r),[E.ACTION]:gn(E.ACTION,t.eventRateLimiterThreshold,r),[E.VITAL]:gn(E.VITAL,t.eventRateLimiterThreshold,r)};e.subscribe(12,({startTime:s,duration:o,rawRumEvent:a,domainContext:u})=>{const c=n.triggerHook(0,{eventType:a.type,startTime:s,duration:o});if(c===gt)return;const d=ut(c,a,{ddtags:Ec(t).join(",")});yh(d,t.beforeSend,u,i)&&(At(d.context)&&delete d.context,e.notify(13,d))})}function yh(t,e,n,r){var i;if(e){const o=gh(t,Bs[t.type],a=>e(a,n));if(o===!1&&t.type!==E.VIEW)return!1;o===!1&&w.warn("Can't dismiss view events using beforeSend!")}return!((i=r[t.type])===null||i===void 0?void 0:i.isLimitReached())}function vh(t,e,n,r){t.register(0,({eventType:i,startTime:s})=>{const o=e.findTrackedSession(s),a=r.findView(s);if(!o||!a)return gt;let u,c,d;return i===E.VIEW?(u=n.getReplayStats(a.id)?!0:void 0,c=o.sessionReplay===1,d=a.sessionIsActive?void 0:!1):u=n.isRecording()?!0:void 0,{type:i,session:{id:o.id,type:"user",has_replay:u,sampled_for_replay:c,is_active:d}}}),t.register(1,({startTime:i})=>{const s=e.findTrackedSession(i);return s?{session:{id:s.id}}:X})}function Eh(t){t.register(0,({eventType:e})=>({type:e,connectivity:Ci()}))}function Sh(t,e,n){t.register(0,({eventType:r})=>({type:r,_dd:{format_version:2,drift:go(),configuration:{session_sample_rate:ie(e.sessionSampleRate,3),session_replay_sample_rate:ie(e.sessionReplaySampleRate,3),profiling_sample_rate:ie(e.profilingSampleRate,3)},browser_sdk_version:Wt()?"6.18.1":void 0,sdk_name:n},application:{id:e.applicationId},date:V(),source:"browser"})),t.register(1,()=>({application:{id:e.applicationId}}))}function wh(t,e){t.register(1,()=>e.isGranted()?X:gt)}const Th=Va,Ih=[E.ACTION,E.ERROR,E.LONG_TASK,E.RESOURCE,E.VITAL];function Ah(t){return{addEvent:(e,n,r,i)=>{Ih.includes(n.type)&&t.notify(12,{startTime:e,rawRumEvent:n,domainContext:r,duration:i})}}}const Ch="Initial view metrics";function Rh(t,e,n){if(!(n.enabled&&ct(t.initialViewMetricsTelemetrySampleRate)))return{stop:x};const{unsubscribe:i}=e.subscribe(4,({initialViewMetrics:s})=>{!s.largestContentfulPaint||!s.navigationTimings||(jn(Ch,{metrics:xh(s.largestContentfulPaint,s.navigationTimings)}),i())});return{stop:i}}function xh(t,e){return{lcp:{value:t.value},navigation:{domComplete:e.domComplete,domContentLoaded:e.domContentLoaded,domInteractive:e.domInteractive,firstByte:e.firstByte,loadEvent:e.loadEvent}}}function kh(t,e,n,r,i,s,o,a,u){const c=[],d=new il,l=Th();d.subscribe(13,q=>Ai("rum",q));const f=q=>{d.notify(14,{error:q}),_t("Error reported to customer",{"error.message":q.message})},p=Da(t),h=p.subscribe(q=>{d.notify(11,q)});c.push(()=>h.unsubscribe());const m=za("browser-rum-sdk",t,l,f,p,i);c.push(m.stop);const b=Wt()?Bf():Ff(t,d,s);if(Wt())Hf(d);else{const q=Gf(t,d,f,p,b.expireObservable,i);c.push(()=>q.stop()),Qf(t,m,d,q.flushController.flushObservable)}const R=tl(),P=jf(t,location),{observable:g,stop:S}=nl();c.push(S),Sh(l,t,u);const k=ih(l,t),_=ol(d);c.push(()=>_.stop());const D=Kf(d,l,P,location);c.push(()=>D.stop());const Je=Jf(d,l,t);vh(l,b,e,_),Eh(l),wh(l,s);const Ze=Eu(l,t,"rum"),Ee=Su(l,t,b,"rum"),Se=vu(l,t,"rum"),{actionContexts:Qe,addAction:we,addEvent:tn,stop:en}=Oh(d,l,t,k,R,g,f);c.push(en);const{addTiming:nn,startView:rn,setViewName:Te,setViewContext:dt,setViewContextProperty:ft,getViewContext:J,stop:st}=Pf(d,l,t,location,R,g,P,e,_,r);c.push(st);const{stop:bt}=Rh(t,d,m);c.push(bt);const{stop:Ks}=Pd(d,t,k);if(c.push(Ks),t.trackLongTasks)if(kt(I.LONG_ANIMATION_FRAME)){const{stop:q}=hh(d,t);c.push(q)}else ph(d,t);const{addError:js}=Ed(d,t,a);a.unbuffer(),bl(d,t,b,Ee,Se);const sn=Ru(d,k,o),qs=rl(t.applicationId,b,_,Qe,D);return c.push(()=>n.stop()),{addAction:we,addEvent:tn,addError:js,addTiming:nn,addFeatureFlagEvaluation:Je.addFeatureFlagEvaluation,startView:rn,setViewContext:dt,setViewContextProperty:ft,getViewContext:J,setViewName:Te,lifeCycle:d,viewHistory:_,session:b,stopSession:()=>b.expire(),getInternalContext:qs.get,startDurationVital:sn.startDurationVital,stopDurationVital:sn.stopDurationVital,addDurationVital:sn.addDurationVital,globalContext:Ze,userContext:Ee,accountContext:Se,telemetry:m,stop:()=>{c.forEach(q=>q())},hooks:l}}function Oh(t,e,n,r,i,s,o){const a=bd(t,e,i,s,n),u=Ah(t),c=ah(e,n),d=fh(n,e);return mh(e),bh(n,t,e,o),{pageStateHistory:r,addAction:a.addAction,addEvent:u.addEvent,actionContexts:a.actionContexts,stop:()=>{a.stop(),d.stop(),c.stop(),r.stop()}}}function Nh(t,{session:e,viewContext:n,errorType:r}){const i=e?e.id:"no-session-id",s=[];r!==void 0&&s.push(`error-type=${r}`),n&&(s.push(`seed=${n.id}`),s.push(`from=${n.startClocks.timeStamp}`));const o=Lh(t),a=`/rum/replay/sessions/${i}`;return`${o}${a}?${s.join("&")}`}function Lh(t){const e=t.site,n=t.subdomain||Mh(t);return`https://${n?`${n}.`:""}${e}`}function Mh(t){switch(t.site){case wt:case ba:return"app";case Ii:return"dd";default:return}}const Ph=1e3;let Z;function Tp(t){return Xe(t).segments_count}function Ip(t){Xe(t).segments_count+=1}function Ap(t){Xe(t).records_count+=1}function Cp(t,e){Xe(t).segments_total_raw_size+=e}function Dh(t){return Z?.get(t)}function Xe(t){Z||(Z=new Map);let e;return Z.has(t)?e=Z.get(t):(e={records_count:0,segments_count:0,segments_total_raw_size:0},Z.set(t,e),Z.size>Ph&&Uh()),e}function Uh(){if(!Z)return;const t=Z.keys().next().value;t&&Z.delete(t)}function zs(t,e,n){let r=0,i=[],s,o=0;const a=[],{stop:u}=O(t,e,"message",({data:l})=>{if(l.type!=="wrote"||l.streamId!==n)return;r+=l.additionalBytesCount,i.push(l.result),s=l.trailer;const f=a.shift();f&&f.id===l.id?f.writeCallback?f.writeCallback(l.result.byteLength):f.finishCallback&&f.finishCallback():(u(),_t("Worker responses received out of order."))});function c(){const l=i.length===0?new Uint8Array(0):vo(i.concat(s)),f={rawBytesCount:r,output:l,outputBytesCount:l.byteLength,encoding:"deflate"};return r=0,i=[],f}function d(){o>0&&(e.postMessage({action:"reset",streamId:n}),o=0)}return{isAsync:!0,get isEmpty(){return o===0},write(l,f){e.postMessage({action:"write",id:o,data:l,streamId:n}),a.push({id:o,writeCallback:f,data:l}),o+=1},finish(l){d(),a.length?(a.forEach(f=>{delete f.writeCallback}),a[a.length-1].finishCallback=()=>l(c())):l(c())},finishSync(){d();const l=a.map(f=>(delete f.writeCallback,delete f.finishCallback,f.data)).join("");return{...c(),pendingData:l}},estimateEncodedBytesCount(l){return l.length/8},stop(){u()}}}function sr({configuredUrl:t,error:e,source:n,scriptType:r}){if(w.error(`${n} failed to start: an error occurred while initializing the ${r}:`,e),e instanceof Event||e instanceof Error&&Vh(e.message)){let i;t?i=`Please make sure the ${r} URL ${t} is correct and CSP is correctly configured.`:i="Please make sure CSP is correctly configured.",w.error(`${i} See documentation at ${Be}/integrations/content_security_policy_logs/#use-csp-with-real-user-monitoring-and-session-replay`)}else r==="worker"&&Kn(e)}function Vh(t){return t.includes("Content Security Policy")||t.includes("requires 'TrustedScriptURL'")}const Fh=30*z;function $s(t){return new Worker(t.workerUrl||URL.createObjectURL(new Blob(['(()=>{function t(t){const e=t.reduce((t,e)=>t+e.length,0),a=new Uint8Array(e);let n=0;for(const e of t)a.set(e,n),n+=e.length;return a}function e(t){for(var e=t.length;--e>=0;)t[e]=0}var a=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),r=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=Array(576);e(s);var h=Array(60);e(h);var l=Array(512);e(l);var _=Array(256);e(_);var o=Array(29);e(o);var d,u,f,c=Array(30);function p(t,e,a,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=a,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function g(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}e(c);var v=function(t){return t<256?l[t]:l[256+(t>>>7)]},w=function(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},m=function(t,e,a){t.bi_valid>16-a?(t.bi_buf|=e<<t.bi_valid&65535,w(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=a-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=a)},b=function(t,e,a){m(t,a[2*e],a[2*e+1])},y=function(t,e){var a=0;do{a|=1&t,t>>>=1,a<<=1}while(--e>0);return a>>>1},z=function(t,e,a){var n,r,i=Array(16),s=0;for(n=1;n<=15;n++)i[n]=s=s+a[n-1]<<1;for(r=0;r<=e;r++){var h=t[2*r+1];0!==h&&(t[2*r]=y(i[h]++,h))}},k=function(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},x=function(t){t.bi_valid>8?w(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},A=function(t,e,a,n){var r=2*e,i=2*a;return t[r]<t[i]||t[r]===t[i]&&n[e]<=n[a]},U=function(t,e,a){for(var n=t.heap[a],r=a<<1;r<=t.heap_len&&(r<t.heap_len&&A(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!A(e,n,t.heap[r],t.depth));)t.heap[a]=t.heap[r],a=r,r<<=1;t.heap[a]=n},B=function(t,e,r){var i,s,h,l,d=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*d]<<8|t.pending_buf[t.d_buf+2*d+1],s=t.pending_buf[t.l_buf+d],d++,0===i?b(t,s,e):(h=_[s],b(t,h+256+1,e),0!==(l=a[h])&&(s-=o[h],m(t,s,l)),i--,h=v(i),b(t,h,r),0!==(l=n[h])&&(i-=c[h],m(t,i,l)))}while(d<t.last_lit);b(t,256,e)},I=function(t,e){var a,n,r,i=e.dyn_tree,s=e.stat_desc.static_tree,h=e.stat_desc.has_stree,l=e.stat_desc.elems,_=-1;for(t.heap_len=0,t.heap_max=573,a=0;a<l;a++)0!==i[2*a]?(t.heap[++t.heap_len]=_=a,t.depth[a]=0):i[2*a+1]=0;for(;t.heap_len<2;)i[2*(r=t.heap[++t.heap_len]=_<2?++_:0)]=1,t.depth[r]=0,t.opt_len--,h&&(t.static_len-=s[2*r+1]);for(e.max_code=_,a=t.heap_len>>1;a>=1;a--)U(t,i,a);r=l;do{a=t.heap[1],t.heap[1]=t.heap[t.heap_len--],U(t,i,1),n=t.heap[1],t.heap[--t.heap_max]=a,t.heap[--t.heap_max]=n,i[2*r]=i[2*a]+i[2*n],t.depth[r]=(t.depth[a]>=t.depth[n]?t.depth[a]:t.depth[n])+1,i[2*a+1]=i[2*n+1]=r,t.heap[1]=r++,U(t,i,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var a,n,r,i,s,h,l=e.dyn_tree,_=e.max_code,o=e.stat_desc.static_tree,d=e.stat_desc.has_stree,u=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,c=e.stat_desc.max_length,p=0;for(i=0;i<=15;i++)t.bl_count[i]=0;for(l[2*t.heap[t.heap_max]+1]=0,a=t.heap_max+1;a<573;a++)(i=l[2*l[2*(n=t.heap[a])+1]+1]+1)>c&&(i=c,p++),l[2*n+1]=i,n>_||(t.bl_count[i]++,s=0,n>=f&&(s=u[n-f]),h=l[2*n],t.opt_len+=h*(i+s),d&&(t.static_len+=h*(o[2*n+1]+s)));if(0!==p){do{for(i=c-1;0===t.bl_count[i];)i--;t.bl_count[i]--,t.bl_count[i+1]+=2,t.bl_count[c]--,p-=2}while(p>0);for(i=c;0!==i;i--)for(n=t.bl_count[i];0!==n;)(r=t.heap[--a])>_||(l[2*r+1]!==i&&(t.opt_len+=(i-l[2*r+1])*l[2*r],l[2*r+1]=i),n--)}}(t,e),z(i,_,t.bl_count)},E=function(t,e,a){var n,r,i=-1,s=e[1],h=0,l=7,_=4;for(0===s&&(l=138,_=3),e[2*(a+1)+1]=65535,n=0;n<=a;n++)r=s,s=e[2*(n+1)+1],++h<l&&r===s||(h<_?t.bl_tree[2*r]+=h:0!==r?(r!==i&&t.bl_tree[2*r]++,t.bl_tree[32]++):h<=10?t.bl_tree[34]++:t.bl_tree[36]++,h=0,i=r,0===s?(l=138,_=3):r===s?(l=6,_=3):(l=7,_=4))},C=function(t,e,a){var n,r,i=-1,s=e[1],h=0,l=7,_=4;for(0===s&&(l=138,_=3),n=0;n<=a;n++)if(r=s,s=e[2*(n+1)+1],!(++h<l&&r===s)){if(h<_)do{b(t,r,t.bl_tree)}while(0!==--h);else 0!==r?(r!==i&&(b(t,r,t.bl_tree),h--),b(t,16,t.bl_tree),m(t,h-3,2)):h<=10?(b(t,17,t.bl_tree),m(t,h-3,3)):(b(t,18,t.bl_tree),m(t,h-11,7));h=0,i=r,0===s?(l=138,_=3):r===s?(l=6,_=3):(l=7,_=4)}},D=!1,M=function(t,e,a,n){m(t,0+(n?1:0),3),function(t,e,a){x(t),w(t,a),w(t,~a),t.pending_buf.set(t.window.subarray(e,e+a),t.pending),t.pending+=a}(t,e,a)},j=M,L=function(t,e,a,n){for(var r=65535&t,i=t>>>16&65535,s=0;0!==a;){a-=s=a>2e3?2e3:a;do{i=i+(r=r+e[n++]|0)|0}while(--s);r%=65521,i%=65521}return r|i<<16},S=new Uint32Array(function(){for(var t,e=[],a=0;a<256;a++){t=a;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[a]=t}return e}()),T=function(t,e,a,n){var r=S,i=n+a;t^=-1;for(var s=n;s<i;s++)t=t>>>8^r[255&(t^e[s])];return-1^t},O={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},q=j,F=function(t,e,a){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&a,t.last_lit++,0===e?t.dyn_ltree[2*a]++:(t.matches++,e--,t.dyn_ltree[2*(_[a]+256+1)]++,t.dyn_dtree[2*v(e)]++),t.last_lit===t.lit_bufsize-1},G=-2,H=258,J=262,K=103,N=113,P=666,Q=function(t,e){return t.msg=O[e],e},R=function(t){return(t<<1)-(t>4?9:0)},V=function(t){for(var e=t.length;--e>=0;)t[e]=0},W=function(t,e,a){return(e<<t.hash_shift^a)&t.hash_mask},X=function(t){var e=t.state,a=e.pending;a>t.avail_out&&(a=t.avail_out),0!==a&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+a),t.next_out),t.next_out+=a,e.pending_out+=a,t.total_out+=a,t.avail_out-=a,e.pending-=a,0===e.pending&&(e.pending_out=0))},Y=function(t,e){(function(t,e,a,n){var r,l,_=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,a=4093624447;for(e=0;e<=31;e++,a>>>=1)if(1&a&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),I(t,t.l_desc),I(t,t.d_desc),_=function(t){var e;for(E(t,t.dyn_ltree,t.l_desc.max_code),E(t,t.dyn_dtree,t.d_desc.max_code),I(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*i[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(l=t.static_len+3+7>>>3)<=r&&(r=l)):r=l=a+5,a+4<=r&&-1!==e?M(t,e,a,n):4===t.strategy||l===r?(m(t,2+(n?1:0),3),B(t,s,h)):(m(t,4+(n?1:0),3),function(t,e,a,n){var r;for(m(t,e-257,5),m(t,a-1,5),m(t,n-4,4),r=0;r<n;r++)m(t,t.bl_tree[2*i[r]+1],3);C(t,t.dyn_ltree,e-1),C(t,t.dyn_dtree,a-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,_+1),B(t,t.dyn_ltree,t.dyn_dtree)),k(t),n&&x(t)})(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,X(t.strm)},Z=function(t,e){t.pending_buf[t.pending++]=e},$=function(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},tt=function(t,e,a,n){var r=t.avail_in;return r>n&&(r=n),0===r?0:(t.avail_in-=r,e.set(t.input.subarray(t.next_in,t.next_in+r),a),1===t.state.wrap?t.adler=L(t.adler,e,r,a):2===t.state.wrap&&(t.adler=T(t.adler,e,r,a)),t.next_in+=r,t.total_in+=r,r)},et=function(t,e){var a,n,r=t.max_chain_length,i=t.strstart,s=t.prev_length,h=t.nice_match,l=t.strstart>t.w_size-J?t.strstart-(t.w_size-J):0,_=t.window,o=t.w_mask,d=t.prev,u=t.strstart+H,f=_[i+s-1],c=_[i+s];t.prev_length>=t.good_match&&(r>>=2),h>t.lookahead&&(h=t.lookahead);do{if(_[(a=e)+s]===c&&_[a+s-1]===f&&_[a]===_[i]&&_[++a]===_[i+1]){i+=2,a++;do{}while(_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&_[++i]===_[++a]&&i<u);if(n=H-(u-i),i=u-H,n>s){if(t.match_start=e,s=n,n>=h)break;f=_[i+s-1],c=_[i+s]}}}while((e=d[e&o])>l&&0!==--r);return s<=t.lookahead?s:t.lookahead},at=function(t){var e,a,n,r,i,s=t.w_size;do{if(r=t.window_size-t.lookahead-t.strstart,t.strstart>=s+(s-J)){t.window.set(t.window.subarray(s,s+s),0),t.match_start-=s,t.strstart-=s,t.block_start-=s,e=a=t.hash_size;do{n=t.head[--e],t.head[e]=n>=s?n-s:0}while(--a);e=a=s;do{n=t.prev[--e],t.prev[e]=n>=s?n-s:0}while(--a);r+=s}if(0===t.strm.avail_in)break;if(a=tt(t.strm,t.window,t.strstart+t.lookahead,r),t.lookahead+=a,t.lookahead+t.insert>=3)for(i=t.strstart-t.insert,t.ins_h=t.window[i],t.ins_h=W(t,t.ins_h,t.window[i+1]);t.insert&&(t.ins_h=W(t,t.ins_h,t.window[i+3-1]),t.prev[i&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=i,i++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<J&&0!==t.strm.avail_in)},nt=function(t,e){for(var a,n;;){if(t.lookahead<J){if(at(t),t.lookahead<J&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==a&&t.strstart-a<=t.w_size-J&&(t.match_length=et(t,a)),t.match_length>=3)if(n=F(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=W(t,t.ins_h,t.window[t.strstart+1]);else n=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2},rt=function(t,e){for(var a,n,r;;){if(t.lookahead<J){if(at(t),t.lookahead<J&&0===e)return 1;if(0===t.lookahead)break}if(a=0,t.lookahead>=3&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==a&&t.prev_length<t.max_lazy_match&&t.strstart-a<=t.w_size-J&&(t.match_length=et(t,a),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,n=F(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=W(t,t.ins_h,t.window[t.strstart+3-1]),a=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(Y(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=F(t,0,t.window[t.strstart-1]))&&Y(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=F(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2};function it(t,e,a,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=a,this.max_chain=n,this.func=r}var st=[new it(0,0,0,0,function(t,e){var a=65535;for(a>t.pending_buf_size-5&&(a=t.pending_buf_size-5);;){if(t.lookahead<=1){if(at(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+a;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Y(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-J&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(Y(t,!1),t.strm.avail_out),1)}),new it(4,4,8,4,nt),new it(4,5,16,8,nt),new it(4,6,32,32,nt),new it(4,4,16,16,rt),new it(8,16,32,32,rt),new it(8,16,128,128,rt),new it(8,32,128,256,rt),new it(32,128,258,1024,rt),new it(32,258,258,4096,rt)];function ht(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}for(var lt=function(t){var e,i=function(t){if(!t||!t.state)return Q(t,G);t.total_in=t.total_out=0,t.data_type=2;var e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:N,t.adler=2===e.wrap?0:1,e.last_flush=0,function(t){D||(function(){var t,e,i,g,v,w=Array(16);for(i=0,g=0;g<28;g++)for(o[g]=i,t=0;t<1<<a[g];t++)_[i++]=g;for(_[i-1]=g,v=0,g=0;g<16;g++)for(c[g]=v,t=0;t<1<<n[g];t++)l[v++]=g;for(v>>=7;g<30;g++)for(c[g]=v<<7,t=0;t<1<<n[g]-7;t++)l[256+v++]=g;for(e=0;e<=15;e++)w[e]=0;for(t=0;t<=143;)s[2*t+1]=8,t++,w[8]++;for(;t<=255;)s[2*t+1]=9,t++,w[9]++;for(;t<=279;)s[2*t+1]=7,t++,w[7]++;for(;t<=287;)s[2*t+1]=8,t++,w[8]++;for(z(s,287,w),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=y(t,5);d=new p(s,a,257,286,15),u=new p(h,n,0,30,15),f=new p([],r,0,19,7)}(),D=!0),t.l_desc=new g(t.dyn_ltree,d),t.d_desc=new g(t.dyn_dtree,u),t.bl_desc=new g(t.bl_tree,f),t.bi_buf=0,t.bi_valid=0,k(t)}(e),0}(t);return 0===i&&((e=t.state).window_size=2*e.w_size,V(e.head),e.max_lazy_match=st[e.level].max_lazy,e.good_match=st[e.level].good_length,e.nice_match=st[e.level].nice_length,e.max_chain_length=st[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),i},_t=function(t,e){var a,n;if(!t||!t.state||e>5||e<0)return t?Q(t,G):G;var r=t.state;if(!t.output||!t.input&&0!==t.avail_in||r.status===P&&4!==e)return Q(t,0===t.avail_out?-5:G);r.strm=t;var i=r.last_flush;if(r.last_flush=e,42===r.status)if(2===r.wrap)t.adler=0,Z(r,31),Z(r,139),Z(r,8),r.gzhead?(Z(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Z(r,255&r.gzhead.time),Z(r,r.gzhead.time>>8&255),Z(r,r.gzhead.time>>16&255),Z(r,r.gzhead.time>>24&255),Z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Z(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Z(r,255&r.gzhead.extra.length),Z(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=T(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,0),Z(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Z(r,3),r.status=N);else{var h=8+(r.w_bits-8<<4)<<8;h|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(h|=32),h+=31-h%31,r.status=N,$(r,h),0!==r.strstart&&($(r,t.adler>>>16),$(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending!==r.pending_buf_size));)Z(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Z(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),X(t),a=r.pending,r.pending===r.pending_buf_size)){n=1;break}n=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Z(r,n)}while(0!==n);r.gzhead.hcrc&&r.pending>a&&(t.adler=T(t.adler,r.pending_buf,r.pending-a,a)),0===n&&(r.status=K)}else r.status=K;if(r.status===K&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&X(t),r.pending+2<=r.pending_buf_size&&(Z(r,255&t.adler),Z(r,t.adler>>8&255),t.adler=0,r.status=N)):r.status=N),0!==r.pending){if(X(t),0===t.avail_out)return r.last_flush=-1,0}else if(0===t.avail_in&&R(e)<=R(i)&&4!==e)return Q(t,-5);if(r.status===P&&0!==t.avail_in)return Q(t,-5);if(0!==t.avail_in||0!==r.lookahead||0!==e&&r.status!==P){var l=2===r.strategy?function(t,e){for(var a;;){if(0===t.lookahead&&(at(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,a=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,a&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var a,n,r,i,s=t.window;;){if(t.lookahead<=H){if(at(t),t.lookahead<=H&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[r=t.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){i=t.strstart+H;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<i);t.match_length=H-(i-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(a=F(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(a=F(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),a&&(Y(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(Y(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(Y(t,!1),0===t.strm.avail_out)?1:2}(r,e):st[r.level].func(r,e);if(3!==l&&4!==l||(r.status=P),1===l||3===l)return 0===t.avail_out&&(r.last_flush=-1),0;if(2===l&&(1===e?function(t){m(t,2,3),b(t,256,s),function(t){16===t.bi_valid?(w(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}(r):5!==e&&(q(r,0,0,!1),3===e&&(V(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),X(t),0===t.avail_out))return r.last_flush=-1,0}return 4!==e?0:r.wrap<=0?1:(2===r.wrap?(Z(r,255&t.adler),Z(r,t.adler>>8&255),Z(r,t.adler>>16&255),Z(r,t.adler>>24&255),Z(r,255&t.total_in),Z(r,t.total_in>>8&255),Z(r,t.total_in>>16&255),Z(r,t.total_in>>24&255)):($(r,t.adler>>>16),$(r,65535&t.adler)),X(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)},ot=function(t){if(!t||!t.state)return G;var e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&e!==K&&e!==N&&e!==P?Q(t,G):(t.state=null,e===N?Q(t,-3):0)},dt=new Uint8Array(256),ut=0;ut<256;ut++)dt[ut]=ut>=252?6:ut>=248?5:ut>=240?4:ut>=224?3:ut>=192?2:1;dt[254]=dt[254]=1;var ft=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},ct=Object.prototype.toString;function pt(){this.options={level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0};var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ft,this.strm.avail_out=0;var e,a,n=function(t,e,a,n,r,i){if(!t)return G;var s=1;if(-1===e&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),r<1||r>9||8!==a||n<8||n>15||e<0||e>9||i<0||i>4)return Q(t,G);8===n&&(n=9);var h=new ht;return t.state=h,h.strm=t,h.wrap=s,h.gzhead=null,h.w_bits=n,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=r+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+3-1)/3),h.window=new Uint8Array(2*h.w_size),h.head=new Uint16Array(h.hash_size),h.prev=new Uint16Array(h.w_size),h.lit_bufsize=1<<r+6,h.pending_buf_size=4*h.lit_bufsize,h.pending_buf=new Uint8Array(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=e,h.strategy=i,h.method=a,lt(t)}(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw Error(O[n]);if(t.header&&(e=this.strm,a=t.header,e&&e.state&&(2!==e.state.wrap||(e.state.gzhead=a))),t.dictionary){var r;if(r="[object ArrayBuffer]"===ct.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=function(t,e){var a=e.length;if(!t||!t.state)return G;var n=t.state,r=n.wrap;if(2===r||1===r&&42!==n.status||n.lookahead)return G;if(1===r&&(t.adler=L(t.adler,e,a,0)),n.wrap=0,a>=n.w_size){0===r&&(V(n.head),n.strstart=0,n.block_start=0,n.insert=0);var i=new Uint8Array(n.w_size);i.set(e.subarray(a-n.w_size,a),0),e=i,a=n.w_size}var s=t.avail_in,h=t.next_in,l=t.input;for(t.avail_in=a,t.next_in=0,t.input=e,at(n);n.lookahead>=3;){var _=n.strstart,o=n.lookahead-2;do{n.ins_h=W(n,n.ins_h,n.window[_+3-1]),n.prev[_&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=_,_++}while(--o);n.strstart=_,n.lookahead=2,at(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=h,t.input=l,t.avail_in=s,n.wrap=r,0}(this.strm,r)))throw Error(O[n]);this._dict_set=!0}}function gt(t,e,a){try{t.postMessage({type:"errored",error:e,streamId:a})}catch(n){t.postMessage({type:"errored",error:e+"",streamId:a})}}function vt(t){const e=t.strm.adler;return new Uint8Array([3,0,e>>>24&255,e>>>16&255,e>>>8&255,255&e])}pt.prototype.push=function(t,e){var a,n,r=this.strm,i=this.options.chunkSize;if(this.ended)return!1;for(n=e===~~e?e:!0===e?4:0,"[object ArrayBuffer]"===ct.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(2===n||3===n)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(1===(a=_t(r,n)))return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=ot(this.strm),this.onEnd(a),this.ended=!0,0===a;if(0!==r.avail_out){if(n>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},pt.prototype.onData=function(t){this.chunks.push(t)},pt.prototype.onEnd=function(t){0===t&&(this.result=function(t){for(var e=0,a=0,n=t.length;a<n;a++)e+=t[a].length;for(var r=new Uint8Array(e),i=0,s=0,h=t.length;i<h;i++){var l=t[i];r.set(l,s),s+=l.length}return r}(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},function(e=self){try{const a=new Map;e.addEventListener("message",n=>{try{const r=function(e,a){switch(a.action){case"init":return{type:"initialized",version:"6.18.1"};case"write":{let n=e.get(a.streamId);n||(n=new pt,e.set(a.streamId,n));const r=n.chunks.length,i=function(t){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,a,n,r,i,s=t.length,h=0;for(r=0;r<s;r++)a=t.charCodeAt(r),55296==(64512&a)&&r+1<s&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),h+=a<128?1:a<2048?2:a<65536?3:4;for(e=new Uint8Array(h),i=0,r=0;i<h;r++)a=t.charCodeAt(r),55296==(64512&a)&&r+1<s&&(n=t.charCodeAt(r+1),56320==(64512&n)&&(a=65536+(a-55296<<10)+(n-56320),r++)),a<128?e[i++]=a:a<2048?(e[i++]=192|a>>>6,e[i++]=128|63&a):a<65536?(e[i++]=224|a>>>12,e[i++]=128|a>>>6&63,e[i++]=128|63&a):(e[i++]=240|a>>>18,e[i++]=128|a>>>12&63,e[i++]=128|a>>>6&63,e[i++]=128|63&a);return e}(a.data);return n.push(i,2),{type:"wrote",id:a.id,streamId:a.streamId,result:t(n.chunks.slice(r)),trailer:vt(n),additionalBytesCount:i.length}}case"reset":e.delete(a.streamId)}}(a,n.data);r&&e.postMessage(r)}catch(t){gt(e,t,n.data&&"streamId"in n.data?n.data.streamId:void 0)}})}catch(t){gt(e,t)}}()})();'])))}let M={status:0};function Gs(t,e,n,r=$s){switch(M.status===0&&Bh(t,e,r),M.status){case 1:return M.initializationFailureCallbacks.push(n),M.worker;case 3:return M.worker}}function jr(){return M.status}function Bh(t,e,n=$s){try{const r=n(t),{stop:i}=O(t,r,"error",a=>{Rn(t,e,a)}),{stop:s}=O(t,r,"message",({data:a})=>{a.type==="errored"?Rn(t,e,a.error,a.streamId):a.type==="initialized"&&$h(a.version)});r.postMessage({action:"init"}),B(()=>zh(e),Fh),M={status:1,worker:r,stop:()=>{i(),s()},initializationFailureCallbacks:[]}}catch(r){Rn(t,e,r)}}function zh(t){M.status===1&&(w.error(`${t} failed to start: a timeout occurred while initializing the Worker`),M.initializationFailureCallbacks.forEach(e=>e()),M={status:2})}function $h(t){M.status===1&&(M={status:3,worker:M.worker,stop:M.stop,version:t})}function Rn(t,e,n,r){M.status===1||M.status===0?(sr({configuredUrl:t.workerUrl,error:n,source:e,scriptType:"worker"}),M.status===1&&M.initializationFailureCallbacks.forEach(i=>i()),M={status:2}):Kn(n,{worker_version:M.status===3&&M.version,stream_id:r})}function Hs(){return typeof Array.from=="function"&&typeof CSSSupportsRule=="function"&&typeof URL.createObjectURL=="function"&&"forEach"in NodeList.prototype}function Gh(t,e,n,r){const i=e.findTrackedSession(),s=Hh(i,r),o=n.findView();return Nh(t,{viewContext:o,errorType:s,session:i})}function Hh(t,e){if(!Hs())return"browser-not-supported";if(!t)return"rum-not-tracked";if(t.sessionReplay===0)return"incorrect-session-plan";if(!e)return"replay-not-started"}const Wh="Recorder init metrics";function Kh(t,e,n){if(!(e.enabled&&ct(t.replayTelemetrySampleRate)))return{stop:x};let i,s,o;const{unsubscribe:a}=n.subscribe(u=>{switch(u.type){case"start":i={forced:u.forced,timestamp:V()},s=void 0,o=void 0;break;case"document-ready":i&&(s=N(i.timestamp,V()));break;case"recorder-settled":i&&(o=N(i.timestamp,V()));break;case"aborted":case"deflate-encoder-load-failed":case"recorder-load-failed":case"succeeded":a(),i&&jn(Wh,{metrics:jh(i.forced,o,N(i.timestamp,V()),u.type,s)});break}});return{stop:a}}function jh(t,e,n,r,i){return{forced:t,loadRecorderModuleDuration:e,recorderInitDuration:n,result:r,waitForDocReadyDuration:i}}function qh(t,e,n,r,i,s,o){let a=0,u;e.subscribe(9,()=>{(a===2||a===3)&&(f(),a=1)}),e.subscribe(10,()=>{a===1&&l()});const c=new T;Kh(t,o,c);const d=async p=>{c.notify({type:"start",forced:p});const[h]=await Promise.all([qr(c,{type:"recorder-settled"},i()),qr(c,{type:"document-ready"},Yc(t,"interactive"))]);if(a!==2){c.notify({type:"aborted"});return}if(!h){a=0,c.notify({type:"recorder-load-failed"});return}const m=s();if(!m){a=0,c.notify({type:"deflate-encoder-load-failed"});return}({stop:u}=h(e,t,n,r,m,o)),a=3,c.notify({type:"succeeded"})};function l(p){const h=n.findTrackedSession();if(Yh(h,p)){a=1;return}if(Xh(a))return;a=2;const m=Jh(h,p)||!1;d(m).catch($t),m&&n.setForcedReplay()}function f(){a===3&&u?.(),a=0}return{start:l,stop:f,getSessionReplayLink(){return Gh(t,n,r,a!==0)},isRecording:()=>a===3}}function Yh(t,e){return!t||t.sessionReplay===0&&(!e||!e.force)}function Xh(t){return t===2||t===3}function Jh(t,e){return e&&e.force&&t.sessionReplay===0}async function qr(t,e,n){try{return await n}finally{t.notify(e)}}function Zh(){let t=0;return{strategy:{start(){t=1},stop(){t=2},isRecording:()=>!1,getSessionReplayLink:x},shouldStartImmediately(e){return t===1||t===0&&!e.startSessionReplayRecordingManually}}}function Qh(t,e){if(Wt()&&!Di("records")||!Hs())return{start:x,stop:x,getReplayStats:()=>{},onRumStart:x,isRecording:()=>!1,getSessionReplayLink:()=>{}};let{strategy:n,shouldStartImmediately:r}=Zh();return{start:s=>n.start(s),stop:()=>n.stop(),getSessionReplayLink:()=>n.getSessionReplayLink(),onRumStart:i,isRecording:()=>jr()===3&&n.isRecording(),getReplayStats:s=>jr()===3?Dh(s):void 0};function i(s,o,a,u,c,d){let l;function f(){return l||(c??(c=Gs(o,"Datadog Session Replay",()=>{n.stop()},e)),c&&(l=zs(o,c,1))),l}n=qh(o,s,a,u,t,f,d),r(o)&&n.start()}}const tp="modulepreload",ep=function(t){return"/practice/"+t},Yr={},Ws=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){let u=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(l=>({status:"fulfilled",value:l}),l=>({status:"rejected",reason:l}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");i=u(n.map(c=>{if(c=ep(c),c in Yr)return;Yr[c]=!0;const d=c.endsWith(".css"),l=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${l}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":tp,d||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};async function np(t=rp){try{return await t()}catch(e){sr({error:e,source:"Recorder",scriptType:"module"})}}async function rp(){return(await Ws(()=>import("./startRecording-B0wKR7UB.js"),[])).startRecording}function ip(){return et().Profiler!==void 0}const sp=t=>{let e={status:"starting"};return t.register(0,({eventType:n})=>n!==E.VIEW&&n!==E.LONG_TASK?X:{type:n,_dd:{profiling:e}}),{get:()=>e,set:n=>{e=n}}};async function op(t=ap){try{return await t()}catch(e){sr({error:e,source:"Profiler",scriptType:"module"})}}async function ap(){return(await Ws(()=>import("./profiler-DyF5yPAp.js"),[])).createRumProfiler}function cp(){let t;function e(n,r,i,s,o){const a=s.findTrackedSession();if(!a||!os(a.id,i.profilingSampleRate))return;const u=sp(r);if(!ip()){u.set({status:"error",error_reason:"not-supported-by-browser"});return}op().then(c=>{if(!c){_t("[DD_RUM] Failed to lazy load the RUM Profiler"),u.set({status:"error",error_reason:"failed-to-lazy-load"});return}t=c(i,n,s,u),t.start(o.findView())}).catch($t)}return{onRumStart:e,stop:()=>{t?.stop().catch($t)}}}const up=Qh(np),lp=cp(),ve=Zu(kh,up,lp,{startDeflateWorker:Gs,createDeflateEncoder:zs,sdkName:"rum"});xc(et(),"DD_RUM",ve);function dp(){console.log("practice-recorder v1.16.0"),ve.init({applicationId:"cf5b1a0f-eb93-4fa2-a37f-6a5f3b2f9a76",clientToken:"pub43c914b5be206019b947216e1f4b9d3c",site:"datadoghq.com",service:"practice-recorder",env:"prod",version:"v1.16.0",sessionSampleRate:100,sessionReplaySampleRate:20,defaultPrivacyLevel:"mask-user-input"})}let or="";function fp(t,e,n){or=e,ve.setUser({id:e.replace("@","_at_"),name:t,email:e,googleId:n})}function hp(t){t.user=or,ve.addAction("Recording",t)}function pp(t){t.user=or,ve.addAction("Playback",t)}window.location.hostname==="purple4reina.github.io"&&dp();class mp{constructor(){this.audioContext=new AudioContext,this.recorder=new oo(this.audioContext),this.player=new eo(this.audioContext),this.recordingMetronome=new ar("rec",this.audioContext),this.playbackMetronome=new ar("play",this.audioContext),this.playbackSpeed=uo("playback",{initNum:1,initDen:4,arrowKeys:!0}),this.playRecordControls=new to;const e=document.getElementById("waveform-canvas");if(!e)throw new Error("Waveform canvas not found");this.waveformVisualizer=new ao(e,{backgroundColor:"#f8f9fa",waveformColor:"#a55dfc",showGrid:!0,maxTime:3e4}),this.playRecordControls.initializeEventListeners({record:this.record.bind(this),stopRecording:this.stopRecording.bind(this),play:this.play.bind(this),stopPlaying:this.stopPlaying.bind(this)}),this.recorder.initialize().catch(n=>{console.error("Failed to initialize recorder:",n)})}async record(){try{if(this.audioContext.state==="suspended"&&await this.audioContext.resume(),await this.recorder.reset(),this.stopMetronomes(),this.waveformVisualizer.clear(),await new Promise(e=>setTimeout(e,100)),this.recordingMetronome.enabled()){const e=this.audioContext.currentTime;this.recordingMetronome.start(e,1,!0)}setTimeout(()=>this.recorder.start(),this.recordingMetronome.countOffMs()),this.playRecordControls.markRecording()}catch(e){console.error("Error starting recording:",e)}}stopRecording(){this.stopMetronomes(),this.recorder.stop();const e=this.recorder.getAudioBuffer();if(e){const n=Ys.calculateLoudnessFromBuffer(e);if(this.waveformVisualizer.setLoudnessData(n),this.playbackMetronome.enabled()){const r={bpm:this.playbackMetronome.bpm(),subdivisions:this.playbackMetronome.subdivisions()};this.waveformVisualizer.setMetronomeSettings(r)}else this.waveformVisualizer.setMetronomeSettings(null);hp({duration:e.duration,metronome:this.recordingMetronome.enabled()?{enabled:this.recordingMetronome.enabled(),bpm:this.recordingMetronome.bpm(),subdivisions:this.recordingMetronome.subdivisions(),countOff:this.recordingMetronome.countOff(),latency:this.recordingMetronome.latency(),volume:this.recordingMetronome.volume()}:void 0})}this.playRecordControls.markStopped()}play(){const e=this.recorder.getAudioBuffer();if(!e){console.error("No audio buffer available for playback");return}this.stopMetronomes();const n=this.player.play(e,this.playbackSpeed(),()=>{this.stopPlaying()});if(this.playbackMetronome.enabled()){const r=this.playbackMetronome.getPlaybackStartTime(n,this.playbackSpeed());this.playbackMetronome.start(r,this.playbackSpeed(),!1)}this.waveformVisualizer.startPlayback(this.playbackSpeed()),pp({duration:e.duration,playbackSpeed:this.playbackSpeed(),metronome:this.playbackMetronome.enabled()?{enabled:this.playbackMetronome.enabled(),bpm:this.playbackMetronome.bpm(),subdivisions:this.playbackMetronome.subdivisions(),countOff:this.playbackMetronome.countOff(),latency:this.playbackMetronome.latency(),volume:this.playbackMetronome.volume()}:void 0}),this.playRecordControls.markPlaying()}stopPlaying(){this.player.stop(),this.stopMetronomes(),this.waveformVisualizer.stopPlayback(),this.playRecordControls.markStopped()}stopMetronomes(){this.recordingMetronome.stop(),this.playbackMetronome.stop()}}window.addEventListener("load",()=>{new mp});window.loginCallback=function(t){const n=function(r){let s=r.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(s).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}(t.credential);fp(n.name,n.email,n.sub),document.getElementById("user").innerText=`Welcome ${n.given_name}`};export{kt as $,er as A,_p as B,wn as C,iu as D,el as E,y as F,ir as G,Ai as H,Ap as I,Tp as J,Ip as K,Cp as L,Ua as M,C as N,Q as O,Ml as P,B as Q,E as R,ql as S,z as T,ct as U,jn as V,be as W,Pi as X,Wt as Y,Ec as Z,go as _,Ep as a,I as a0,F as a1,et as a2,$t as a3,w as a4,ti as a5,ze as a6,Jn as b,_l as c,gp as d,Sp as e,Es as f,xl as g,vp as h,Rl as i,bp as j,yp as k,N as l,bs as m,Ge as n,mt as o,_t as p,vs as q,Vl as r,Ss as s,V as t,_f as u,wp as v,O as w,bf as x,x as y,rt as z};
